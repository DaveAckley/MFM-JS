!function(t){var e={};function o(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(r,s,function(e){return t[e]}.bind(null,s));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);class r{constructor(t,e){this.tile=t,this.makeWindow(t,e)}makeWindow(t,e){this.window=new Map,this.origin=this.tile.getSiteByCoord(e),this.window.set(this.origin.id,this.origin),r.WINDOW_ORDER_OFFSETS.map(t=>this.OffsetFromOrigin(e,t.row,t.col)).forEach(e=>{let o=t.getSiteByCoord(e);o&&this.window.set(o.id,o)})}OffsetFromOrigin(t,e,o){return{row:t.row+e,col:t.col+o}}getRandom(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!0,t)}getNearest(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!1,t)}getEast(){return this.getDirection(r.EW_EAST)}getWest(){return this.getDirection(r.EW_WEST)}getNorth(){return this.getDirection(r.EW_NORTH)}getSouth(){return this.getDirection(r.EW_SOUTH)}getNorthWest(){return this.getDirection(r.EW_NORTHWEST)}getSouthWest(){return this.getDirection(r.EW_SOUTHWEST)}getNorthEast(){return this.getDirection(r.EW_NORTHEAST)}getSouthEast(){return this.getDirection(r.EW_SOUTHEAST)}getAdjacent4Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast()],t,e)}getAdjacent8Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast(),this.getNorthWest(),this.getSouthWest(),this.getNorthEast(),this.getSouthEast()],t,e)}getSiteFromCandidates(t,e=!0,o){if(!((t=t.filter(t=>!!t&&(o?!(!o||t.atom.type!==o)&&t:t))).length<1))return e?t[Math.floor(Math.random()*t.length)]:t[0]}getDirection(t){let e=this.tile.sites.get(s.CtoID(this.OffsetFromOrigin(this.origin.tilePos,t.row,t.col)));if(e)return e}}r.WINDOW_ORDER_OFFSETS=[{col:0,row:0},{col:-1,row:0},{col:0,row:-1},{col:0,row:1},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1},{col:-2,row:0},{col:0,row:-1},{col:0,row:2},{col:2,row:0},{col:-2,row:-1},{col:-2,row:1},{col:-1,row:-2},{col:-1,row:2},{col:1,row:-2},{col:1,row:2},{col:2,row:-1},{col:2,row:1},{col:-3,row:0},{col:0,row:-3},{col:0,row:3},{col:3,row:0},{col:-2,row:-2},{col:-2,row:2},{col:2,row:-2},{col:2,row:2},{col:-3,row:-1},{col:-3,row:1},{col:-1,row:-3},{col:-1,row:3},{col:1,row:-3},{col:1,row:3},{col:3,row:-1},{col:3,row:1},{col:-4,row:0},{col:0,row:-4},{col:0,row:4},{col:4,row:0}],r.EW_WEST={col:-1,row:0},r.EW_EAST={col:1,row:0},r.EW_NORTH={col:0,row:-1},r.EW_SOUTH={col:0,row:1},r.EW_NORTHWEST={col:-1,row:-1},r.EW_SOUTHWEST={col:-1,row:1},r.EW_NORTHEAST={col:1,row:-1},r.EW_SOUTHEAST={col:1,row:1};class s{static CtoID(t){return`${t.row}:${t.col}`}static IDtoC(t){let e=t.split(":");return{row:parseInt(e[0]),col:parseInt(e[1])}}static GenerateEventWindow(t,e,o){let s=Math.floor(Math.random()*e),i=Math.floor(Math.random()*o);return new r(t,{row:i,col:s})}}class i{constructor(t,e,o=!0,r=!0,s=0){this.name=t,this.type=e,this.data=s,this.moveable=o,this.killable=r}set data(t){this._data=t}get data(){return this._data}set name(t){this._name=t}get name(){return this._name}set type(t){this._type=t}get type(){return this._type}set moveable(t){this._moveable=t}get moveable(){return this._moveable}set killable(t){this._killable=t}get killable(){return this._killable}exec(t){}}class n extends i{constructor(){super(a.DREG.name,a.DREG.type),this.pTOTAL_CHANCE=100,this.pDREG_CREATE=.1,this.pRES_CREATE=.5,this.pDREG_DESTROY=10,this.pANY_DESTROY=1}exec(t){const e=t.getAdjacent4Way();if(e.atom.type===a.EMPTY){const o=Math.random()*this.pTOTAL_CHANCE<this.pDREG_CREATE,r=Math.random()*this.pTOTAL_CHANCE<this.pRES_CREATE;o?(e.atom=new l(a.DREG),console.log("DREG CREATED")):r&&(e.atom=new l(a.RES),console.log("RES CREATED")),t.origin.swapAtoms(e)}else if(e.atom.type===a.DREG){Math.random()*this.pTOTAL_CHANCE<this.pDREG_DESTROY&&(e.atom=new l(a.EMPTY),console.log("DREG DESTROYED"),t.origin.swapAtoms(e))}else{Math.random()*this.pTOTAL_CHANCE<this.pANY_DESTROY&&(console.log(e.atom.type.name+" DESTROYED"),e.atom=new l(a.EMPTY),t.origin.swapAtoms(e))}super.exec(t)}}class a{static registerType(t,e,o){this.TYPES_ARRAY.push({name:t,type:e,class:o})}}a.EMPTY={name:"EMPTY",type:"E",class:class extends i{constructor(){super(a.EMPTY.name,a.EMPTY.type)}exec(t){super.exec(t)}}},a.DREG={name:"DREG",type:"D",class:n},a.RES={name:"RES",type:"R",class:class extends i{constructor(){super(a.RES.name,a.RES.type)}exec(t){t.origin.swapAtoms(t.getRandom(a.EMPTY)),super.exec(t)}}},a.TYPES_ARRAY=[a.EMPTY,a.DREG,a.RES];class l{constructor(t=a.EMPTY){this.type=t,this.elem=new this.type.class}exec(t){this.elem.exec(t)}}class c{constructor(t){this.tilePos=t,this.id=s.CtoID(this.tilePos),this.create()}swapAtoms(t){t&&([this.atom,t.atom]=[t.atom,this.atom])}create(){this.atom=new l}}let h=new class{constructor(t=1,e=1){this.width=t,this.height=e,this.create()}getSiteByCoord(t){return this.sites.get(s.CtoID(t))}getRandomSite(){let t=Math.floor(Math.random()*this.height),e=Math.floor(Math.random()*this.width);return this.sites.get(`${t}:${e}`)}create(){this.sites=new Map;for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)this.sites.set(`${e}:${t}`,new c({row:e,col:t}))}}(30,30);console.log(h),console.log(h.getRandomSite()),h.getRandomSite().atom.elem=new n,h.getRandomSite().atom.elem=new n,h.getRandomSite().atom.elem=new n,h.getRandomSite().atom.elem=new n;new p5(t=>{t.preload=(()=>{}),t.setup=(()=>{t.createCanvas(600,600)});t.draw=(()=>{t.background(100),((t,e)=>{t.push(),t.translate(50,50),e.sites.forEach(e=>{switch(e.atom.elem.type){case a.EMPTY.type:t.fill(32);break;case a.DREG.type:t.fill(255,32,32);break;case a.RES.type:t.fill(32,255,64)}t.stroke(0),t.ellipse(12*e.tilePos.col,12*e.tilePos.row,12,12)}),t.pop()})(t,h),(()=>{for(var t=0;t<2500;t++){let t=s.GenerateEventWindow(h,h.width,h.height);t.origin.atom.exec(t)}})()})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0V2ZW50d2luZG93LnRzIiwid2VicGFjazovLy8uL3NyYy9tZm0vdXRpbHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW0udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL2VsZW1lbnRzL0RSZWdFbGVtZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9tZm0vY2xhc3Nlcy9FbGVtZW50VHlwZXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL2VsZW1lbnRzL0VtcHR5RWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvUmVzRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvQXRvbS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvU2l0ZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL1RpbGUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJFdmVudHdpbmRvd19FdmVudFdpbmRvdyIsIltvYmplY3QgT2JqZWN0XSIsIl90aWxlIiwiX29yaWdpbiIsInRoaXMiLCJ0aWxlIiwibWFrZVdpbmRvdyIsIm9yaWdpbiIsIndpbmRvdyIsIk1hcCIsImdldFNpdGVCeUNvb3JkIiwic2V0IiwiaWQiLCJXSU5ET1dfT1JERVJfT0ZGU0VUUyIsIm1hcCIsIm9mZnNldCIsIk9mZnNldEZyb21PcmlnaW4iLCJyb3ciLCJjb2wiLCJmb3JFYWNoIiwidGlsZUNvb3JkIiwic2l0ZSIsInJvd09mZnNldCIsImNvbE9mZnNldCIsInNwZWNpZmljVHlwZSIsImdldFNpdGVGcm9tQ2FuZGlkYXRlcyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImdldERpcmVjdGlvbiIsIkVXX0VBU1QiLCJFV19XRVNUIiwiRVdfTk9SVEgiLCJFV19TT1VUSCIsIkVXX05PUlRIV0VTVCIsIkVXX1NPVVRIV0VTVCIsIkVXX05PUlRIRUFTVCIsIkVXX1NPVVRIRUFTVCIsInJhbmRvbWl6ZSIsImdldFdlc3QiLCJnZXROb3J0aCIsImdldFNvdXRoIiwiZ2V0RWFzdCIsImdldE5vcnRoV2VzdCIsImdldFNvdXRoV2VzdCIsImdldE5vcnRoRWFzdCIsImdldFNvdXRoRWFzdCIsImNhbmRpZGF0ZVNpdGVzIiwiZmlsdGVyIiwiYXRvbSIsInR5cGUiLCJsZW5ndGgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJkaXJlY3Rpb24iLCJzaXRlcyIsInV0aWxzX01GTVV0aWxzIiwiQ3RvSUQiLCJ0aWxlUG9zIiwicmNhIiwic3BsaXQiLCJwYXJzZUludCIsInciLCJoIiwicmMiLCJyciIsIkVsZW0iLCJfbmFtZSIsIl90eXBlIiwiX21vdmVhYmxlIiwiX2tpbGxhYmxlIiwiX2RhdGEiLCJkYXRhIiwibW92ZWFibGUiLCJraWxsYWJsZSIsImsiLCJldyIsIkRSZWdFbGVtZW50X0RSZWdFbGVtZW50Iiwic3VwZXIiLCJFbGVtZW50VHlwZXMiLCJEUkVHIiwicFRPVEFMX0NIQU5DRSIsInBEUkVHX0NSRUFURSIsInBSRVNfQ1JFQVRFIiwicERSRUdfREVTVFJPWSIsInBBTllfREVTVFJPWSIsImF2YWlsYWJsZVNpdGUiLCJnZXRBZGphY2VudDRXYXkiLCJFTVBUWSIsImNyZWF0ZURSZWciLCJjcmVhdGVSZXMiLCJBdG9tX0F0b20iLCJjb25zb2xlIiwibG9nIiwiUkVTIiwic3dhcEF0b21zIiwiZXhlYyIsIlRZUEVTX0FSUkFZIiwicHVzaCIsImNsYXNzIiwiZ2V0UmFuZG9tIiwiZWxlbSIsIlNpdGVfU2l0ZSIsIl9wb3MiLCJ0YXJnZXRTaXRlIiwiZyIsIl93aWR0aCIsIl9oZWlnaHQiLCJ3aWR0aCIsImhlaWdodCIsImoiLCJnZXRSYW5kb21TaXRlIiwicDUiLCJwcmVsb2FkIiwic2V0dXAiLCJjcmVhdGVDYW52YXMiLCJkcmF3IiwiYmFja2dyb3VuZCIsInRyYW5zbGF0ZSIsImZpbGwiLCJzdHJva2UiLCJlbGxpcHNlIiwicG9wIiwiZHJhd0dyaWQiLCJHZW5lcmF0ZUV2ZW50V2luZG93IiwicnVuIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLGFBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FB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cEIsS0FNQWlEIiwiZmlsZSI6Im1mbS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG4vL0V2ZW50IHdpbmRvdyBhcyBkZXNjcmliYmVkIGhlcmU6IGh0dHA6Ly9yb2J1c3QuY3MudW5tLmVkdS9saWIvZXhlL2ZldGNoLnBocD93PTMwMCZ0b2s9NGM4ZjQ5Jm1lZGlhPWRldjpldmVudC13aW5kb3ctMTAucG5nXG4vL0NvbGxlY3Rpb24gb2Ygc2l0ZXMgd2hpY2ggY29udGFpbiBhdG9tcywgYnVpbHQgZnJvbSBhbiBvcmlnaW4gKGNlbnRlcikgc2l0ZVxuZXhwb3J0IGNsYXNzIEV2ZW50V2luZG93IHtcbiAgICBjb25zdHJ1Y3RvcihfdGlsZSwgX29yaWdpbikge1xuICAgICAgICB0aGlzLnRpbGUgPSBfdGlsZTtcbiAgICAgICAgdGhpcy5tYWtlV2luZG93KF90aWxlLCBfb3JpZ2luKTtcbiAgICB9XG4gICAgbWFrZVdpbmRvdyh0aWxlLCBvcmlnaW4pIHtcbiAgICAgICAgdGhpcy53aW5kb3cgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMub3JpZ2luID0gdGhpcy50aWxlLmdldFNpdGVCeUNvb3JkKG9yaWdpbik7XG4gICAgICAgIHRoaXMud2luZG93LnNldCh0aGlzLm9yaWdpbi5pZCwgdGhpcy5vcmlnaW4pO1xuICAgICAgICBsZXQgd2luZG93QXJyYXkgPSBFdmVudFdpbmRvdy5XSU5ET1dfT1JERVJfT0ZGU0VUUy5tYXAoKG9mZnNldCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuT2Zmc2V0RnJvbU9yaWdpbihvcmlnaW4sIG9mZnNldC5yb3csIG9mZnNldC5jb2wpO1xuICAgICAgICB9KTtcbiAgICAgICAgd2luZG93QXJyYXkuZm9yRWFjaCgodGlsZUNvb3JkKSA9PiB7XG4gICAgICAgICAgICBsZXQgc2l0ZSA9IHRpbGUuZ2V0U2l0ZUJ5Q29vcmQodGlsZUNvb3JkKTtcbiAgICAgICAgICAgIGlmIChzaXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53aW5kb3cuc2V0KHNpdGUuaWQsIHNpdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgT2Zmc2V0RnJvbU9yaWdpbihvcmlnaW4sIHJvd09mZnNldCwgY29sT2Zmc2V0KSB7XG4gICAgICAgIHJldHVybiB7IHJvdzogb3JpZ2luLnJvdyArIHJvd09mZnNldCwgY29sOiBvcmlnaW4uY29sICsgY29sT2Zmc2V0IH07XG4gICAgfVxuICAgIGdldFJhbmRvbShzcGVjaWZpY1R5cGUgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2l0ZUZyb21DYW5kaWRhdGVzKEFycmF5LmZyb20odGhpcy53aW5kb3cudmFsdWVzKCkpLCB0cnVlLCBzcGVjaWZpY1R5cGUpO1xuICAgIH1cbiAgICBnZXROZWFyZXN0KHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTaXRlRnJvbUNhbmRpZGF0ZXMoQXJyYXkuZnJvbSh0aGlzLndpbmRvdy52YWx1ZXMoKSksIGZhbHNlLCBzcGVjaWZpY1R5cGUpO1xuICAgIH1cbiAgICBnZXRFYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfRUFTVCk7XG4gICAgfVxuICAgIGdldFdlc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19XRVNUKTtcbiAgICB9XG4gICAgZ2V0Tm9ydGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19OT1JUSCk7XG4gICAgfVxuICAgIGdldFNvdXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfU09VVEgpO1xuICAgIH1cbiAgICBnZXROb3J0aFdlc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19OT1JUSFdFU1QpO1xuICAgIH1cbiAgICBnZXRTb3V0aFdlc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19TT1VUSFdFU1QpO1xuICAgIH1cbiAgICBnZXROb3J0aEVhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19OT1JUSEVBU1QpO1xuICAgIH1cbiAgICBnZXRTb3V0aEVhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19TT1VUSEVBU1QpO1xuICAgIH1cbiAgICBnZXRBZGphY2VudDRXYXkocmFuZG9taXplID0gdHJ1ZSwgc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNpdGVGcm9tQ2FuZGlkYXRlcyhbdGhpcy5nZXRXZXN0KCksIHRoaXMuZ2V0Tm9ydGgoKSwgdGhpcy5nZXRTb3V0aCgpLCB0aGlzLmdldEVhc3QoKV0sIHJhbmRvbWl6ZSwgc3BlY2lmaWNUeXBlKTtcbiAgICB9XG4gICAgZ2V0QWRqYWNlbnQ4V2F5KHJhbmRvbWl6ZSA9IHRydWUsIHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTaXRlRnJvbUNhbmRpZGF0ZXMoW1xuICAgICAgICAgICAgdGhpcy5nZXRXZXN0KCksXG4gICAgICAgICAgICB0aGlzLmdldE5vcnRoKCksXG4gICAgICAgICAgICB0aGlzLmdldFNvdXRoKCksXG4gICAgICAgICAgICB0aGlzLmdldEVhc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0Tm9ydGhXZXN0KCksXG4gICAgICAgICAgICB0aGlzLmdldFNvdXRoV2VzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXROb3J0aEVhc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0U291dGhFYXN0KClcbiAgICAgICAgXSwgcmFuZG9taXplLCBzcGVjaWZpY1R5cGUpO1xuICAgIH1cbiAgICAvL0dpdmVuIGFuIGFycmF5IG9mIGNhbmRpZGF0ZSBzaXRlcyAoc3ltbWV0cmllcyBpbiB0aGUgZnV0dXJlIEkgaG9wZSksIGdpdmUgbWUgYmFjayBvbmUsIHJhbmRvbSBieSBkZWZhdWx0LCBub3QgZmlsdGVyZWQgYnkgdHlwZSBieSBkZWZhdWx0XG4gICAgZ2V0U2l0ZUZyb21DYW5kaWRhdGVzKGNhbmRpZGF0ZVNpdGVzLCByYW5kb21pemUgPSB0cnVlLCBzcGVjaWZpY1R5cGUgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgY2FuZGlkYXRlU2l0ZXMgPSBjYW5kaWRhdGVTaXRlcy5maWx0ZXIoc2l0ZSA9PiB7XG4gICAgICAgICAgICBpZiAoIXNpdGUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzcGVjaWZpY1R5cGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2l0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNwZWNpZmljVHlwZSAmJiBzaXRlLmF0b20udHlwZSA9PT0gc3BlY2lmaWNUeXBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNpdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICAvL25vIHNpdGVzISB5aWtlcyEgcG9zc2libGUhPyEgcHJvYmFibHkgb25seSB3aGVuIHVzaW5nIHNwZWNpZmljVHlwZSBhbmQgbG9va2luZyBmb3IgYSByYXJlIGVsZW1lbnRcbiAgICAgICAgaWYgKGNhbmRpZGF0ZVNpdGVzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgLy9yZXR1cm4gcmFuZG9tXG4gICAgICAgIGlmIChyYW5kb21pemUpIHtcbiAgICAgICAgICAgIHJldHVybiBjYW5kaWRhdGVTaXRlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjYW5kaWRhdGVTaXRlcy5sZW5ndGgpXTtcbiAgICAgICAgfVxuICAgICAgICAvL3JldHVybiBmaXJzdCBtYXRjaGluZ1xuICAgICAgICByZXR1cm4gY2FuZGlkYXRlU2l0ZXNbMF07XG4gICAgfVxuICAgIGdldERpcmVjdGlvbihkaXJlY3Rpb24pIHtcbiAgICAgICAgbGV0IHNpdGUgPSB0aGlzLnRpbGUuc2l0ZXMuZ2V0KE1GTVV0aWxzLkN0b0lEKHRoaXMuT2Zmc2V0RnJvbU9yaWdpbih0aGlzLm9yaWdpbi50aWxlUG9zLCBkaXJlY3Rpb24ucm93LCBkaXJlY3Rpb24uY29sKSkpO1xuICAgICAgICBpZiAoc2l0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHNpdGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG59XG5FdmVudFdpbmRvdy5XSU5ET1dfT1JERVJfT0ZGU0VUUyA9IFtcbiAgICB7IGNvbDogMCwgcm93OiAwIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IDAgfSxcbiAgICB7IGNvbDogMCwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAwLCByb3c6IDEgfSxcbiAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IDEgfSxcbiAgICB7IGNvbDogMSwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAxLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogMiB9LFxuICAgIHsgY29sOiAyLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAtMiB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAyIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogLTIgfSxcbiAgICB7IGNvbDogMSwgcm93OiAyIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMiwgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0zLCByb3c6IDAgfSxcbiAgICB7IGNvbDogMCwgcm93OiAtMyB9LFxuICAgIHsgY29sOiAwLCByb3c6IDMgfSxcbiAgICB7IGNvbDogMywgcm93OiAwIH0sXG4gICAgeyBjb2w6IC0yLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IC0yLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMiwgcm93OiAtMiB9LFxuICAgIHsgY29sOiAyLCByb3c6IDIgfSxcbiAgICB7IGNvbDogLTMsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogLTMsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAtMyB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAzIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogLTMgfSxcbiAgICB7IGNvbDogMSwgcm93OiAzIH0sXG4gICAgeyBjb2w6IDMsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMywgcm93OiAxIH0sXG4gICAgeyBjb2w6IC00LCByb3c6IDAgfSxcbiAgICB7IGNvbDogMCwgcm93OiAtNCB9LFxuICAgIHsgY29sOiAwLCByb3c6IDQgfSxcbiAgICB7IGNvbDogNCwgcm93OiAwIH1cbl07XG4vL2JlY2F1c2UsIGxhenlcbkV2ZW50V2luZG93LkVXX1dFU1QgPSB7IGNvbDogLTEsIHJvdzogMCB9O1xuRXZlbnRXaW5kb3cuRVdfRUFTVCA9IHsgY29sOiAxLCByb3c6IDAgfTtcbkV2ZW50V2luZG93LkVXX05PUlRIID0geyBjb2w6IDAsIHJvdzogLTEgfTtcbkV2ZW50V2luZG93LkVXX1NPVVRIID0geyBjb2w6IDAsIHJvdzogMSB9O1xuRXZlbnRXaW5kb3cuRVdfTk9SVEhXRVNUID0geyBjb2w6IC0xLCByb3c6IC0xIH07XG5FdmVudFdpbmRvdy5FV19TT1VUSFdFU1QgPSB7IGNvbDogLTEsIHJvdzogMSB9O1xuRXZlbnRXaW5kb3cuRVdfTk9SVEhFQVNUID0geyBjb2w6IDEsIHJvdzogLTEgfTtcbkV2ZW50V2luZG93LkVXX1NPVVRIRUFTVCA9IHsgY29sOiAxLCByb3c6IDEgfTtcbiIsImltcG9ydCB7IEV2ZW50V2luZG93IH0gZnJvbSBcIi4uL2NsYXNzZXMvRXZlbnR3aW5kb3dcIjtcbmV4cG9ydCBjbGFzcyBNRk1VdGlscyB7XG4gICAgc3RhdGljIEN0b0lEKGMpIHtcbiAgICAgICAgcmV0dXJuIGAke2Mucm93fToke2MuY29sfWA7XG4gICAgfVxuICAgIHN0YXRpYyBJRHRvQyhpZCkge1xuICAgICAgICBsZXQgcmNhID0gaWQuc3BsaXQoXCI6XCIpO1xuICAgICAgICByZXR1cm4geyByb3c6IHBhcnNlSW50KHJjYVswXSksIGNvbDogcGFyc2VJbnQocmNhWzFdKSB9O1xuICAgIH1cbiAgICBzdGF0aWMgR2VuZXJhdGVFdmVudFdpbmRvdyh0aWxlLCB3LCBoKSB7XG4gICAgICAgIGxldCByYyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHcpO1xuICAgICAgICBsZXQgcnIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBoKTtcbiAgICAgICAgcmV0dXJuIG5ldyBFdmVudFdpbmRvdyh0aWxlLCB7IHJvdzogcnIsIGNvbDogcmMgfSk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKF9uYW1lLCBfdHlwZSwgX21vdmVhYmxlID0gdHJ1ZSwgX2tpbGxhYmxlID0gdHJ1ZSwgX2RhdGEgPSAwKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IF9uYW1lO1xuICAgICAgICB0aGlzLnR5cGUgPSBfdHlwZTtcbiAgICAgICAgdGhpcy5kYXRhID0gX2RhdGE7XG4gICAgICAgIHRoaXMubW92ZWFibGUgPSBfbW92ZWFibGU7XG4gICAgICAgIHRoaXMua2lsbGFibGUgPSBfa2lsbGFibGU7XG4gICAgfVxuICAgIHNldCBkYXRhKGQpIHtcbiAgICAgICAgdGhpcy5fZGF0YSA9IGQ7XG4gICAgfVxuICAgIGdldCBkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICB9XG4gICAgc2V0IG5hbWUobikge1xuICAgICAgICB0aGlzLl9uYW1lID0gbjtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgIH1cbiAgICBzZXQgdHlwZSh0KSB7XG4gICAgICAgIHRoaXMuX3R5cGUgPSB0O1xuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgfVxuICAgIHNldCBtb3ZlYWJsZShtKSB7XG4gICAgICAgIHRoaXMuX21vdmVhYmxlID0gbTtcbiAgICB9XG4gICAgZ2V0IG1vdmVhYmxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbW92ZWFibGU7XG4gICAgfVxuICAgIHNldCBraWxsYWJsZShrKSB7XG4gICAgICAgIHRoaXMuX2tpbGxhYmxlID0gaztcbiAgICB9XG4gICAgZ2V0IGtpbGxhYmxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2lsbGFibGU7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHsgfVxufVxuIiwiaW1wb3J0IHsgRWxlbSB9IGZyb20gXCIuLi9FbGVtXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi4vRWxlbWVudFR5cGVzXCI7XG5pbXBvcnQgeyBBdG9tIH0gZnJvbSBcIi4uL0F0b21cIjtcbmV4cG9ydCBjbGFzcyBEUmVnRWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuRFJFRy5uYW1lLCBFbGVtZW50VHlwZXMuRFJFRy50eXBlKTtcbiAgICAgICAgdGhpcy5wVE9UQUxfQ0hBTkNFID0gMTAwO1xuICAgICAgICB0aGlzLnBEUkVHX0NSRUFURSA9IDAuMTtcbiAgICAgICAgdGhpcy5wUkVTX0NSRUFURSA9IDAuNTtcbiAgICAgICAgdGhpcy5wRFJFR19ERVNUUk9ZID0gMTA7XG4gICAgICAgIHRoaXMucEFOWV9ERVNUUk9ZID0gMTtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICAvL2dldCBhIHJhbmRvbSBORVNXIHNpdGVcbiAgICAgICAgY29uc3QgYXZhaWxhYmxlU2l0ZSA9IGV3LmdldEFkamFjZW50NFdheSgpO1xuICAgICAgICAvL0NSRUFUSU9OXG4gICAgICAgIGlmIChhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLkVNUFRZKSB7XG4gICAgICAgICAgICBjb25zdCBjcmVhdGVEUmVnID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucERSRUdfQ1JFQVRFO1xuICAgICAgICAgICAgY29uc3QgY3JlYXRlUmVzID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucFJFU19DUkVBVEU7XG4gICAgICAgICAgICBpZiAoY3JlYXRlRFJlZykge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbSA9IG5ldyBBdG9tKEVsZW1lbnRUeXBlcy5EUkVHKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRSRUcgQ1JFQVRFRFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNyZWF0ZVJlcykge1xuICAgICAgICAgICAgICAgIC8vbWFrZSByZXNcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVTaXRlLmF0b20gPSBuZXcgQXRvbShFbGVtZW50VHlwZXMuUkVTKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJFUyBDUkVBVEVEXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLkRSRUcpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc3Ryb3lEUmVnID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucERSRUdfREVTVFJPWTtcbiAgICAgICAgICAgIGlmIChkZXN0cm95RFJlZykge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbSA9IG5ldyBBdG9tKEVsZW1lbnRUeXBlcy5FTVBUWSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEUkVHIERFU1RST1lFRFwiKTtcbiAgICAgICAgICAgICAgICBldy5vcmlnaW4uc3dhcEF0b21zKGF2YWlsYWJsZVNpdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9pdCdzIHNvbWV0aGluZyBlbHNlXG4gICAgICAgICAgICBjb25zdCBkZXN0cm95QW55ID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucEFOWV9ERVNUUk9ZO1xuICAgICAgICAgICAgaWYgKGRlc3Ryb3lBbnkpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhdmFpbGFibGVTaXRlLmF0b20udHlwZS5uYW1lICsgXCIgREVTVFJPWUVEXCIpO1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbSA9IG5ldyBBdG9tKEVsZW1lbnRUeXBlcy5FTVBUWSk7XG4gICAgICAgICAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdXBlci5leGVjKGV3KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFbXB0eUVsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9FbXB0eUVsZW1lbnRcIjtcbmltcG9ydCB7IERSZWdFbGVtZW50IH0gZnJvbSBcIi4vZWxlbWVudHMvRFJlZ0VsZW1lbnRcIjtcbmltcG9ydCB7IFJlc0VsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9SZXNFbGVtZW50XCI7XG5leHBvcnQgY2xhc3MgRWxlbWVudFR5cGVzIHtcbiAgICBzdGF0aWMgcmVnaXN0ZXJUeXBlKG5hbWUsIHR5cGUsIGMpIHtcbiAgICAgICAgdGhpcy5UWVBFU19BUlJBWS5wdXNoKHsgbmFtZSwgdHlwZSwgY2xhc3M6IGMgfSk7XG4gICAgfVxufVxuRWxlbWVudFR5cGVzLkVNUFRZID0geyBuYW1lOiBcIkVNUFRZXCIsIHR5cGU6IFwiRVwiLCBjbGFzczogRW1wdHlFbGVtZW50IH07XG5FbGVtZW50VHlwZXMuRFJFRyA9IHsgbmFtZTogXCJEUkVHXCIsIHR5cGU6IFwiRFwiLCBjbGFzczogRFJlZ0VsZW1lbnQgfTtcbkVsZW1lbnRUeXBlcy5SRVMgPSB7IG5hbWU6IFwiUkVTXCIsIHR5cGU6IFwiUlwiLCBjbGFzczogUmVzRWxlbWVudCB9O1xuRWxlbWVudFR5cGVzLlRZUEVTX0FSUkFZID0gW0VsZW1lbnRUeXBlcy5FTVBUWSwgRWxlbWVudFR5cGVzLkRSRUcsIEVsZW1lbnRUeXBlcy5SRVNdO1xuIiwiaW1wb3J0IHsgRWxlbSB9IGZyb20gXCIuLi9FbGVtXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgRW1wdHlFbGVtZW50IGV4dGVuZHMgRWxlbSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKEVsZW1lbnRUeXBlcy5FTVBUWS5uYW1lLCBFbGVtZW50VHlwZXMuRU1QVFkudHlwZSk7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgc3VwZXIuZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRWxlbSB9IGZyb20gXCIuLi9FbGVtXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgUmVzRWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuUkVTLm5hbWUsIEVsZW1lbnRUeXBlcy5SRVMudHlwZSk7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhldy5nZXRSYW5kb20oRWxlbWVudFR5cGVzLkVNUFRZKSk7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVsZW1lbnRUeXBlcyB9IGZyb20gXCIuL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIEF0b20ge1xuICAgIGNvbnN0cnVjdG9yKF90eXBlID0gRWxlbWVudFR5cGVzLkVNUFRZKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IF90eXBlO1xuICAgICAgICB0aGlzLmVsZW0gPSBuZXcgdGhpcy50eXBlLmNsYXNzKCk7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgdGhpcy5lbGVtLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgeyBBdG9tIH0gZnJvbSBcIi4vQXRvbVwiO1xuZXhwb3J0IGNsYXNzIFNpdGUge1xuICAgIGNvbnN0cnVjdG9yKF9wb3MpIHtcbiAgICAgICAgdGhpcy50aWxlUG9zID0gX3BvcztcbiAgICAgICAgdGhpcy5pZCA9IE1GTVV0aWxzLkN0b0lEKHRoaXMudGlsZVBvcyk7XG4gICAgICAgIHRoaXMuY3JlYXRlKCk7XG4gICAgfVxuICAgIHN3YXBBdG9tcyh0YXJnZXRTaXRlKSB7XG4gICAgICAgIGlmICh0YXJnZXRTaXRlKVxuICAgICAgICAgICAgW3RoaXMuYXRvbSwgdGFyZ2V0U2l0ZS5hdG9tXSA9IFt0YXJnZXRTaXRlLmF0b20sIHRoaXMuYXRvbV07XG4gICAgfVxuICAgIGNyZWF0ZSgpIHtcbiAgICAgICAgdGhpcy5hdG9tID0gbmV3IEF0b20oKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBUaWxlIH0gZnJvbSBcIi4vbWZtL2NsYXNzZXMvVGlsZVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4vbWZtL2NsYXNzZXMvRWxlbWVudFR5cGVzXCI7XG5pbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuL21mbS91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgRFJlZ0VsZW1lbnQgfSBmcm9tIFwiLi9tZm0vY2xhc3Nlcy9lbGVtZW50cy9EUmVnRWxlbWVudFwiO1xubGV0IGcgPSBuZXcgVGlsZSgzMCwgMzApO1xuY29uc29sZS5sb2coZyk7XG5jb25zb2xlLmxvZyhnLmdldFJhbmRvbVNpdGUoKSk7XG5nLmdldFJhbmRvbVNpdGUoKS5hdG9tLmVsZW0gPSBuZXcgRFJlZ0VsZW1lbnQoKTtcbmcuZ2V0UmFuZG9tU2l0ZSgpLmF0b20uZWxlbSA9IG5ldyBEUmVnRWxlbWVudCgpO1xuZy5nZXRSYW5kb21TaXRlKCkuYXRvbS5lbGVtID0gbmV3IERSZWdFbGVtZW50KCk7XG5nLmdldFJhbmRvbVNpdGUoKS5hdG9tLmVsZW0gPSBuZXcgRFJlZ0VsZW1lbnQoKTtcbnZhciBza2V0Y2ggPSAocCkgPT4ge1xuICAgIGxldCBzaXRlU2l6ZSA9IDEyO1xuICAgIHAucHJlbG9hZCA9ICgpID0+IHsgfTtcbiAgICBwLnNldHVwID0gKCkgPT4ge1xuICAgICAgICBwLmNyZWF0ZUNhbnZhcyg2MDAsIDYwMCk7XG4gICAgfTtcbiAgICAvLyAgIHAud2luZG93UmVzaXplZCA9ICgpID0+IHtcbiAgICAvLyAgICAgcC5yZXNpemVDYW52YXMocC53aW5kb3dXaWR0aCAtIDUwLCBwLndpbmRvd0hlaWdodCAtIDUwKTtcbiAgICAvLyAgIH07XG4gICAgbGV0IGRyYXdHcmlkID0gKHAsIHQpID0+IHtcbiAgICAgICAgcC5wdXNoKCk7XG4gICAgICAgIHAudHJhbnNsYXRlKDUwLCA1MCk7XG4gICAgICAgIHQuc2l0ZXMuZm9yRWFjaCgoc2l0ZSkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChzaXRlLmF0b20uZWxlbS50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBFbGVtZW50VHlwZXMuRU1QVFkudHlwZTpcbiAgICAgICAgICAgICAgICAgICAgcC5maWxsKDMyKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBFbGVtZW50VHlwZXMuRFJFRy50eXBlOlxuICAgICAgICAgICAgICAgICAgICBwLmZpbGwoMjU1LCAzMiwgMzIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIEVsZW1lbnRUeXBlcy5SRVMudHlwZTpcbiAgICAgICAgICAgICAgICAgICAgcC5maWxsKDMyLCAyNTUsIDY0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwLnN0cm9rZSgwKTtcbiAgICAgICAgICAgIHAuZWxsaXBzZShzaXRlLnRpbGVQb3MuY29sICogc2l0ZVNpemUsIHNpdGUudGlsZVBvcy5yb3cgKiBzaXRlU2l6ZSwgc2l0ZVNpemUsIHNpdGVTaXplKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHAucG9wKCk7XG4gICAgfTtcbiAgICBsZXQgcnVuID0gKCkgPT4ge1xuICAgICAgICBsZXQgc3BlZWQgPSAyNTAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwZWVkOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBldyA9IE1GTVV0aWxzLkdlbmVyYXRlRXZlbnRXaW5kb3coZywgZy53aWR0aCwgZy5oZWlnaHQpO1xuICAgICAgICAgICAgZXcub3JpZ2luLmF0b20uZXhlYyhldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHAuZHJhdyA9ICgpID0+IHtcbiAgICAgICAgcC5iYWNrZ3JvdW5kKDEwMCk7XG4gICAgICAgIGRyYXdHcmlkKHAsIGcpO1xuICAgICAgICBydW4oKTtcbiAgICB9O1xufTtcbmxldCBza2V0Y2hQID0gbmV3IHA1KHNrZXRjaCk7XG4iLCJpbXBvcnQgeyBTaXRlIH0gZnJvbSBcIi4vU2l0ZVwiO1xuaW1wb3J0IHsgTUZNVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHNcIjtcbmV4cG9ydCBjbGFzcyBUaWxlIHtcbiAgICBjb25zdHJ1Y3Rvcihfd2lkdGggPSAxLCBfaGVpZ2h0ID0gMSkge1xuICAgICAgICB0aGlzLndpZHRoID0gX3dpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IF9oZWlnaHQ7XG4gICAgICAgIHRoaXMuY3JlYXRlKCk7XG4gICAgfVxuICAgIGdldFNpdGVCeUNvb3JkKGMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2l0ZXMuZ2V0KE1GTVV0aWxzLkN0b0lEKGMpKTtcbiAgICB9XG4gICAgZ2V0UmFuZG9tU2l0ZSgpIHtcbiAgICAgICAgbGV0IHJyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5oZWlnaHQpO1xuICAgICAgICBsZXQgcmMgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLndpZHRoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2l0ZXMuZ2V0KGAke3JyfToke3JjfWApO1xuICAgIH1cbiAgICBjcmVhdGUoKSB7XG4gICAgICAgIHRoaXMuc2l0ZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53aWR0aDsgaSsrKSB7XG4gICAgICAgICAgICAvL2Fjcm9zcyBjb2x1bW5zXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuaGVpZ2h0OyBqKyspIHtcbiAgICAgICAgICAgICAgICAvL2Rvd24gcm93c1xuICAgICAgICAgICAgICAgIHRoaXMuc2l0ZXMuc2V0KGAke2p9OiR7aX1gLCBuZXcgU2l0ZSh7IHJvdzogaiwgY29sOiBpIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=