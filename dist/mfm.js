!function(t){var e={};function o(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(r,s,function(e){return t[e]}.bind(null,s));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);class r{constructor(t,e,o=100,r=100){this.name=t,this.type=e,this.moveability=o,this.killability=r}exec(t){}}class s{constructor(t=i.EMPTY){this.type=t,this.elem=new this.type.class}exec(t){this.elem.exec(t)}}class i{static registerType(t,e,o){this.TYPES_ARRAY.push({name:t,type:e,class:o})}}i.EMPTY={name:"EMPTY",type:"E",class:class extends r{constructor(){super(i.EMPTY.name,i.EMPTY.type)}exec(t){super.exec(t)}}},i.DREG={name:"DREG",type:"D",class:class extends r{constructor(){super(i.DREG.name,i.DREG.type),this.pTOTAL_CHANCE=100,this.pDREG_CREATE=.1,this.pRES_CREATE=.5,this.pDREG_DESTROY=10,this.pANY_DESTROY=1}exec(t){const e=t.getAdjacent4Way();if(e.atom.type===i.EMPTY){const o=Math.random()*this.pTOTAL_CHANCE<this.pDREG_CREATE,r=Math.random()*this.pTOTAL_CHANCE<this.pRES_CREATE;o?(t.origin.moveAtom(e,new s(i.DREG)),console.log("DREG CREATED")):r?(t.origin.moveAtom(e,new s(i.RES)),console.log("RES CREATED")):t.origin.swapAtoms(e)}else e.atom.type===i.DREG?Math.random()*this.pTOTAL_CHANCE<this.pDREG_DESTROY&&(console.log("DREG DESTROYED"),t.origin.moveAtom(e)):Math.random()*this.pTOTAL_CHANCE<this.pANY_DESTROY&&(console.log(e.atom.type.name+" DESTROYED"),t.origin.moveAtom(e));super.exec(t)}}},i.RES={name:"RES",type:"R",class:class extends r{constructor(){super(i.RES.name,i.RES.type)}exec(t){t.origin.swapAtoms(t.getRandom(i.EMPTY)),super.exec(t)}}},i.WALL={name:"WALL",type:"W",class:class extends r{constructor(){super(i.WALL.name,i.WALL.type,0,0)}exec(t){super.exec(t)}}},i.MASON={name:"MASON",type:"Ma",class:class extends r{constructor(t="EEEENNNNWWWWSSSS"){super(i.MASON.name,i.MASON.type,100,10),this.path=[],t=this.boxPath(),this.path=t.toUpperCase().split("")}randomPath(){let t="";const e=Math.floor(8*Math.random())+6,o=["E","N","S","W"];for(var r=0;r<e;r++){const e=Math.floor(Math.random()*o.length),r=Math.floor(3*Math.random())+3,i=o[e];for(var s=0;s<r;s++)t=t.concat(i)}return t}boxPath(){let t="";const e=["E","N","W","S"];for(;e.length;){const r=5,s=e.shift();for(var o=0;o<r;o++)t=t.concat(s)}return t}exec(t){if(this.path.length){let e;switch(this.path.shift()){case"E":e=t.getEast();break;case"N":e=t.getNorth();break;case"S":e=t.getSouth();break;case"W":e=t.getWest()}!e||e.atom.type!==i.RES&&e.atom.type!==i.EMPTY?e&&(e.atom.type,i.WALL):t.origin.moveAtom(e,new s(i.WALL))}else t.origin.killSelf(new s(i.WALL));super.exec(t)}}},i.TYPES_ARRAY=[i.EMPTY,i.DREG,i.RES,i.WALL,i.MASON];class a{constructor(t,e){this.tile=t,this.makeWindow(t,e)}makeWindow(t,e){if(this.window=new Map,this.origin=this.tile.getSiteByCoord(e),this.origin.atom.type===i.EMPTY)return;this.window.set(this.origin.id,this.origin),a.WINDOW_ORDER_OFFSETS.map(t=>this.OffsetFromOrigin(e,t.row,t.col)).forEach(e=>{let o=t.getSiteByCoord(e);o&&this.window.set(o.id,o)})}OffsetFromOrigin(t,e,o){return{row:t.row+e,col:t.col+o}}getRandom(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!0,t)}getNearest(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!1,t)}getEast(){return this.getDirection(a.EW_EAST)}getWest(){return this.getDirection(a.EW_WEST)}getNorth(){return this.getDirection(a.EW_NORTH)}getSouth(){return this.getDirection(a.EW_SOUTH)}getNorthWest(){return this.getDirection(a.EW_NORTHWEST)}getSouthWest(){return this.getDirection(a.EW_SOUTHWEST)}getNorthEast(){return this.getDirection(a.EW_NORTHEAST)}getSouthEast(){return this.getDirection(a.EW_SOUTHEAST)}getAdjacent4Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast()],t,e)}getAdjacent8Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast(),this.getNorthWest(),this.getSouthWest(),this.getNorthEast(),this.getSouthEast()],t,e)}getSiteFromCandidates(t,e=!0,o){if(!((t=t.filter(t=>!!t&&(o?!(!o||t.atom.type!==o)&&t:t))).length<1))return e?t[Math.floor(Math.random()*t.length)]:t[0]}getDirection(t){let e=this.tile.sites.get(n.CtoID(this.OffsetFromOrigin(this.origin.tilePos,t.row,t.col)));if(e)return e}}a.WINDOW_ORDER_OFFSETS=[{col:0,row:0},{col:-1,row:0},{col:0,row:-1},{col:0,row:1},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1},{col:-2,row:0},{col:0,row:-1},{col:0,row:2},{col:2,row:0},{col:-2,row:-1},{col:-2,row:1},{col:-1,row:-2},{col:-1,row:2},{col:1,row:-2},{col:1,row:2},{col:2,row:-1},{col:2,row:1},{col:-3,row:0},{col:0,row:-3},{col:0,row:3},{col:3,row:0},{col:-2,row:-2},{col:-2,row:2},{col:2,row:-2},{col:2,row:2},{col:-3,row:-1},{col:-3,row:1},{col:-1,row:-3},{col:-1,row:3},{col:1,row:-3},{col:1,row:3},{col:3,row:-1},{col:3,row:1},{col:-4,row:0},{col:0,row:-4},{col:0,row:4},{col:4,row:0}],a.EW_WEST={col:-1,row:0},a.EW_EAST={col:1,row:0},a.EW_NORTH={col:0,row:-1},a.EW_SOUTH={col:0,row:1},a.EW_NORTHWEST={col:-1,row:-1},a.EW_SOUTHWEST={col:-1,row:1},a.EW_NORTHEAST={col:1,row:-1},a.EW_SOUTHEAST={col:1,row:1};class n{static CtoID(t){return`${t.row}:${t.col}`}static IDtoC(t){let e=t.split(":");return{row:parseInt(e[0]),col:parseInt(e[1])}}static GenerateEventWindow(t,e,o){let r=Math.floor(Math.random()*e),s=Math.floor(Math.random()*o);return new a(t,{row:s,col:r})}}class l{constructor(t){this.tilePos=t,this.id=n.CtoID(this.tilePos),this.create()}killAtom(t){100*Math.random()<t.atom.elem.killability&&(t.atom=new s(i.EMPTY))}killSelf(t=new s(i.EMPTY)){this.atom=t}moveAtom(t,e=new s(i.EMPTY)){if(t){100*Math.random()<t.atom.elem.killability&&([this.atom,t.atom]=[e,this.atom])}}swapAtoms(t){if(t){100*Math.random()<t.atom.elem.moveability&&([this.atom,t.atom]=[t.atom,this.atom])}}create(){this.atom=new s}}let c=new class{constructor(t=1,e=1){this.width=t,this.height=e,this.create()}getSiteByCoord(t){return this.sites.get(n.CtoID(t))}getRandomSite(){let t=Math.floor(Math.random()*this.height),e=Math.floor(Math.random()*this.width);return this.sites.get(`${t}:${e}`)}create(){this.sites=new Map;for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)this.sites.set(`${e}:${t}`,new l({row:e,col:t}))}}(32,32);new p5(t=>{t.preload=(()=>{}),t.setup=(()=>{t.createCanvas(700,700)});t.draw=(()=>{t.background(100),((t,e)=>{t.push(),t.translate(25,25),e.sites.forEach(e=>{switch(e.atom.elem.type){case i.EMPTY.type:t.stroke(0,0,0,0),t.fill(32,32,32,127);break;case i.DREG.type:t.stroke(0,0,0,127),t.fill(255,32,32);break;case i.RES.type:t.stroke(0,0,0,127),t.fill(32,255,64);break;case i.WALL.type:t.stroke(0,0,0,127),t.fill(32,32,255);break;case i.MASON.type:t.stroke(0,0,0,127),t.fill(32,255,255)}t.ellipse(14*e.tilePos.col,14*e.tilePos.row,14,14)}),t.pop()})(t,c),(()=>{for(var t=0;t<1e3;t++){let t=n.GenerateEventWindow(c,c.width,c.height);t.origin.atom.exec(t)}})()}),t.mouseClicked=(()=>{let e=((t,e)=>(t=t-25+7,e=e-25+7,t=Math.floor(t/14),e=Math.floor(e/14),c.getSiteByCoord({row:e,col:t})))(t.mouseX,t.mouseY);e&&(t.keyIsPressed?e.atom=new s(i.MASON):e.atom=new s(i.DREG))})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW0udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0F0b20udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW1lbnRUeXBlcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvRW1wdHlFbGVtZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9tZm0vY2xhc3Nlcy9lbGVtZW50cy9EUmVnRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvUmVzRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvV2FsbEVsZW1lbnQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL2VsZW1lbnRzL01hc29uRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvRXZlbnR3aW5kb3cudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS91dGlscy91dGlscy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvU2l0ZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL1RpbGUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJFbGVtIiwiW29iamVjdCBPYmplY3RdIiwiX25hbWUiLCJfdHlwZSIsIl9tb3ZlYWJpbGl0eSIsIl9raWxsYWJpbGl0eSIsInRoaXMiLCJ0eXBlIiwibW92ZWFiaWxpdHkiLCJraWxsYWJpbGl0eSIsImV3IiwiQXRvbV9BdG9tIiwiRWxlbWVudFR5cGVzIiwiRU1QVFkiLCJlbGVtIiwiY2xhc3MiLCJleGVjIiwiVFlQRVNfQVJSQVkiLCJwdXNoIiwic3VwZXIiLCJEUkVHIiwicFRPVEFMX0NIQU5DRSIsInBEUkVHX0NSRUFURSIsInBSRVNfQ1JFQVRFIiwicERSRUdfREVTVFJPWSIsInBBTllfREVTVFJPWSIsImF2YWlsYWJsZVNpdGUiLCJnZXRBZGphY2VudDRXYXkiLCJhdG9tIiwiY3JlYXRlRFJlZyIsIk1hdGgiLCJyYW5kb20iLCJjcmVhdGVSZXMiLCJvcmlnaW4iLCJtb3ZlQXRvbSIsImNvbnNvbGUiLCJsb2ciLCJSRVMiLCJzd2FwQXRvbXMiLCJnZXRSYW5kb20iLCJXQUxMIiwiTUFTT04iLCJfcGF0aCIsInBhdGgiLCJib3hQYXRoIiwidG9VcHBlckNhc2UiLCJzcGxpdCIsImZsb29yIiwiY2hvaWNlcyIsImxlbmd0aCIsImRpciIsImoiLCJjb25jYXQiLCJzaGlmdCIsImdldEVhc3QiLCJnZXROb3J0aCIsImdldFNvdXRoIiwiZ2V0V2VzdCIsImtpbGxTZWxmIiwiRXZlbnR3aW5kb3dfRXZlbnRXaW5kb3ciLCJfdGlsZSIsIl9vcmlnaW4iLCJ0aWxlIiwibWFrZVdpbmRvdyIsIndpbmRvdyIsIk1hcCIsImdldFNpdGVCeUNvb3JkIiwic2V0IiwiaWQiLCJXSU5ET1dfT1JERVJfT0ZGU0VUUyIsIm1hcCIsIm9mZnNldCIsIk9mZnNldEZyb21PcmlnaW4iLCJyb3ciLCJjb2wiLCJmb3JFYWNoIiwidGlsZUNvb3JkIiwic2l0ZSIsInJvd09mZnNldCIsImNvbE9mZnNldCIsInNwZWNpZmljVHlwZSIsImdldFNpdGVGcm9tQ2FuZGlkYXRlcyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImdldERpcmVjdGlvbiIsIkVXX0VBU1QiLCJFV19XRVNUIiwiRVdfTk9SVEgiLCJFV19TT1VUSCIsIkVXX05PUlRIV0VTVCIsIkVXX1NPVVRIV0VTVCIsIkVXX05PUlRIRUFTVCIsIkVXX1NPVVRIRUFTVCIsInJhbmRvbWl6ZSIsImdldE5vcnRoV2VzdCIsImdldFNvdXRoV2VzdCIsImdldE5vcnRoRWFzdCIsImdldFNvdXRoRWFzdCIsImNhbmRpZGF0ZVNpdGVzIiwiZmlsdGVyIiwiZGlyZWN0aW9uIiwic2l0ZXMiLCJ1dGlsc19NRk1VdGlscyIsIkN0b0lEIiwidGlsZVBvcyIsInJjYSIsInBhcnNlSW50IiwidyIsImgiLCJyYyIsInJyIiwiU2l0ZV9TaXRlIiwiX3BvcyIsInRhcmdldFNpdGUiLCJsZWF2aW5nQXRvbSIsImciLCJfd2lkdGgiLCJfaGVpZ2h0Iiwid2lkdGgiLCJoZWlnaHQiLCJwNSIsInByZWxvYWQiLCJzZXR1cCIsImNyZWF0ZUNhbnZhcyIsImRyYXciLCJiYWNrZ3JvdW5kIiwidHJhbnNsYXRlIiwic3Ryb2tlIiwiZmlsbCIsImVsbGlwc2UiLCJwb3AiLCJkcmF3R3JpZCIsIkdlbmVyYXRlRXZlbnRXaW5kb3ciLCJydW4iLCJtb3VzZUNsaWNrZWQiLCJ4IiwieSIsInNpdGVTaXplIiwiZ2V0U2l0ZUZyb21DYW52YXNYWSIsIm1vdXNlWCIsIm1vdXNlWSIsImtleUlzUHJlc3NlZCJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdB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QUFBLEVBQUFELEtBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsS0FBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxLQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsS0FBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELEtBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsS0FBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUdMZCxFQUFXNEIsU0FBWWIsS0FBQSxFQUFBRCxJQUFBLEdBQ3ZCZCxFQUFXMkIsU0FBWVosSUFBQSxFQUFBRCxJQUFBLEdBQ3ZCZCxFQUFXNkIsVUFBYWQsSUFBQSxFQUFBRCxLQUFBLEdBQ3hCZCxF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QixPQUdqRG9DLEVBQUFqRCxLQUFBLElBQWdDakIsRUFBS0MsRUFBWVEiLCJmaWxlIjoibWZtLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGNsYXNzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKF9uYW1lLCBfdHlwZSwgX21vdmVhYmlsaXR5ID0gMTAwLCBfa2lsbGFiaWxpdHkgPSAxMDApIHtcbiAgICAgICAgdGhpcy5uYW1lID0gX25hbWU7XG4gICAgICAgIHRoaXMudHlwZSA9IF90eXBlO1xuICAgICAgICB0aGlzLm1vdmVhYmlsaXR5ID0gX21vdmVhYmlsaXR5O1xuICAgICAgICB0aGlzLmtpbGxhYmlsaXR5ID0gX2tpbGxhYmlsaXR5O1xuICAgIH1cbiAgICBleGVjKGV3KSB7IH1cbn1cbiIsImltcG9ydCB7IEVsZW1lbnRUeXBlcyB9IGZyb20gXCIuL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIEF0b20ge1xuICAgIGNvbnN0cnVjdG9yKF90eXBlID0gRWxlbWVudFR5cGVzLkVNUFRZKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IF90eXBlO1xuICAgICAgICB0aGlzLmVsZW0gPSBuZXcgdGhpcy50eXBlLmNsYXNzKCk7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgdGhpcy5lbGVtLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVtcHR5RWxlbWVudCB9IGZyb20gXCIuL2VsZW1lbnRzL0VtcHR5RWxlbWVudFwiO1xuaW1wb3J0IHsgRFJlZ0VsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9EUmVnRWxlbWVudFwiO1xuaW1wb3J0IHsgUmVzRWxlbWVudCB9IGZyb20gXCIuL2VsZW1lbnRzL1Jlc0VsZW1lbnRcIjtcbmltcG9ydCB7IFdhbGxFbGVtZW50IH0gZnJvbSBcIi4vZWxlbWVudHMvV2FsbEVsZW1lbnRcIjtcbmltcG9ydCB7IE1hc29uRWxlbWVudCB9IGZyb20gXCIuL2VsZW1lbnRzL01hc29uRWxlbWVudFwiO1xuZXhwb3J0IGNsYXNzIEVsZW1lbnRUeXBlcyB7XG4gICAgc3RhdGljIHJlZ2lzdGVyVHlwZShuYW1lLCB0eXBlLCBjKSB7XG4gICAgICAgIHRoaXMuVFlQRVNfQVJSQVkucHVzaCh7IG5hbWUsIHR5cGUsIGNsYXNzOiBjIH0pO1xuICAgIH1cbn1cbkVsZW1lbnRUeXBlcy5FTVBUWSA9IHsgbmFtZTogXCJFTVBUWVwiLCB0eXBlOiBcIkVcIiwgY2xhc3M6IEVtcHR5RWxlbWVudCB9O1xuRWxlbWVudFR5cGVzLkRSRUcgPSB7IG5hbWU6IFwiRFJFR1wiLCB0eXBlOiBcIkRcIiwgY2xhc3M6IERSZWdFbGVtZW50IH07XG5FbGVtZW50VHlwZXMuUkVTID0geyBuYW1lOiBcIlJFU1wiLCB0eXBlOiBcIlJcIiwgY2xhc3M6IFJlc0VsZW1lbnQgfTtcbkVsZW1lbnRUeXBlcy5XQUxMID0geyBuYW1lOiBcIldBTExcIiwgdHlwZTogXCJXXCIsIGNsYXNzOiBXYWxsRWxlbWVudCB9O1xuRWxlbWVudFR5cGVzLk1BU09OID0geyBuYW1lOiBcIk1BU09OXCIsIHR5cGU6IFwiTWFcIiwgY2xhc3M6IE1hc29uRWxlbWVudCB9O1xuRWxlbWVudFR5cGVzLlRZUEVTX0FSUkFZID0gW1xuICAgIEVsZW1lbnRUeXBlcy5FTVBUWSxcbiAgICBFbGVtZW50VHlwZXMuRFJFRyxcbiAgICBFbGVtZW50VHlwZXMuUkVTLFxuICAgIEVsZW1lbnRUeXBlcy5XQUxMLFxuICAgIEVsZW1lbnRUeXBlcy5NQVNPTlxuXTtcbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIEVtcHR5RWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuRU1QVFkubmFtZSwgRWxlbWVudFR5cGVzLkVNUFRZLnR5cGUpO1xuICAgIH1cbiAgICBleGVjKGV3KSB7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuaW1wb3J0IHsgQXRvbSB9IGZyb20gXCIuLi9BdG9tXCI7XG5leHBvcnQgY2xhc3MgRFJlZ0VsZW1lbnQgZXh0ZW5kcyBFbGVtIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoRWxlbWVudFR5cGVzLkRSRUcubmFtZSwgRWxlbWVudFR5cGVzLkRSRUcudHlwZSk7XG4gICAgICAgIHRoaXMucFRPVEFMX0NIQU5DRSA9IDEwMDtcbiAgICAgICAgdGhpcy5wRFJFR19DUkVBVEUgPSAwLjE7XG4gICAgICAgIHRoaXMucFJFU19DUkVBVEUgPSAwLjU7XG4gICAgICAgIHRoaXMucERSRUdfREVTVFJPWSA9IDEwO1xuICAgICAgICB0aGlzLnBBTllfREVTVFJPWSA9IDE7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgLy9nZXQgYSByYW5kb20gTkVTVyBzaXRlXG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZVNpdGUgPSBldy5nZXRBZGphY2VudDRXYXkoKTtcbiAgICAgICAgLy9DUkVBVElPTlxuICAgICAgICBpZiAoYXZhaWxhYmxlU2l0ZS5hdG9tLnR5cGUgPT09IEVsZW1lbnRUeXBlcy5FTVBUWSkge1xuICAgICAgICAgICAgY29uc3QgY3JlYXRlRFJlZyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBEUkVHX0NSRUFURTtcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZVJlcyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBSRVNfQ1JFQVRFO1xuICAgICAgICAgICAgaWYgKGNyZWF0ZURSZWcpIHtcbiAgICAgICAgICAgICAgICBldy5vcmlnaW4ubW92ZUF0b20oYXZhaWxhYmxlU2l0ZSwgbmV3IEF0b20oRWxlbWVudFR5cGVzLkRSRUcpKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRSRUcgQ1JFQVRFRFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNyZWF0ZVJlcykge1xuICAgICAgICAgICAgICAgIGV3Lm9yaWdpbi5tb3ZlQXRvbShhdmFpbGFibGVTaXRlLCBuZXcgQXRvbShFbGVtZW50VHlwZXMuUkVTKSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSRVMgQ1JFQVRFRFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGV3Lm9yaWdpbi5zd2FwQXRvbXMoYXZhaWxhYmxlU2l0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYXZhaWxhYmxlU2l0ZS5hdG9tLnR5cGUgPT09IEVsZW1lbnRUeXBlcy5EUkVHKSB7XG4gICAgICAgICAgICBjb25zdCBkZXN0cm95RFJlZyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBEUkVHX0RFU1RST1k7XG4gICAgICAgICAgICBpZiAoZGVzdHJveURSZWcpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRSRUcgREVTVFJPWUVEXCIpO1xuICAgICAgICAgICAgICAgIGV3Lm9yaWdpbi5tb3ZlQXRvbShhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vaXQncyBzb21ldGhpbmcgZWxzZVxuICAgICAgICAgICAgY29uc3QgZGVzdHJveUFueSA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBBTllfREVTVFJPWTtcbiAgICAgICAgICAgIGlmIChkZXN0cm95QW55KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYXZhaWxhYmxlU2l0ZS5hdG9tLnR5cGUubmFtZSArIFwiIERFU1RST1lFRFwiKTtcbiAgICAgICAgICAgICAgICBldy5vcmlnaW4ubW92ZUF0b20oYXZhaWxhYmxlU2l0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIuZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRWxlbSB9IGZyb20gXCIuLi9FbGVtXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgUmVzRWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuUkVTLm5hbWUsIEVsZW1lbnRUeXBlcy5SRVMudHlwZSk7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhldy5nZXRSYW5kb20oRWxlbWVudFR5cGVzLkVNUFRZKSk7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIFdhbGxFbGVtZW50IGV4dGVuZHMgRWxlbSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKEVsZW1lbnRUeXBlcy5XQUxMLm5hbWUsIEVsZW1lbnRUeXBlcy5XQUxMLnR5cGUsIDAsIDApO1xuICAgIH1cbiAgICBleGVjKGV3KSB7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuaW1wb3J0IHsgQXRvbSB9IGZyb20gXCIuLi9BdG9tXCI7XG5leHBvcnQgY2xhc3MgTWFzb25FbGVtZW50IGV4dGVuZHMgRWxlbSB7XG4gICAgY29uc3RydWN0b3IoX3BhdGggPSBcIkVFRUVOTk5OV1dXV1NTU1NcIikge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuTUFTT04ubmFtZSwgRWxlbWVudFR5cGVzLk1BU09OLnR5cGUsIDEwMCwgMTApO1xuICAgICAgICB0aGlzLnBhdGggPSBbXTtcbiAgICAgICAgX3BhdGggPSB0aGlzLmJveFBhdGgoKTtcbiAgICAgICAgdGhpcy5wYXRoID0gX3BhdGgudG9VcHBlckNhc2UoKS5zcGxpdChcIlwiKTtcbiAgICB9XG4gICAgLy9tYWtlIGEgcmFuZG9tIHdhbGwgcGF0aFxuICAgIHJhbmRvbVBhdGgoKSB7XG4gICAgICAgIGxldCBwYXRoID0gXCJcIjtcbiAgICAgICAgY29uc3QgciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpICsgNjtcbiAgICAgICAgY29uc3QgY2hvaWNlcyA9IFtcIkVcIiwgXCJOXCIsIFwiU1wiLCBcIldcIl07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcjsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2hvaWNlcy5sZW5ndGgpO1xuICAgICAgICAgICAgY29uc3QgbCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMztcbiAgICAgICAgICAgIGNvbnN0IGRpciA9IGNob2ljZXNbZF07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGw7IGorKykge1xuICAgICAgICAgICAgICAgIHBhdGggPSBwYXRoLmNvbmNhdChkaXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXRoO1xuICAgIH1cbiAgICBib3hQYXRoKCkge1xuICAgICAgICBsZXQgcGF0aCA9IFwiXCI7XG4gICAgICAgIGNvbnN0IGNob2ljZXMgPSBbXCJFXCIsIFwiTlwiLCBcIldcIiwgXCJTXCJdO1xuICAgICAgICB3aGlsZSAoY2hvaWNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGwgPSA1O1xuICAgICAgICAgICAgY29uc3QgZGlyID0gY2hvaWNlcy5zaGlmdCgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBsOyBqKyspIHtcbiAgICAgICAgICAgICAgICBwYXRoID0gcGF0aC5jb25jYXQoZGlyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGF0aDtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICBpZiAodGhpcy5wYXRoLmxlbmd0aCkge1xuICAgICAgICAgICAgbGV0IGF2YWlsYWJsZVNpdGU7XG4gICAgICAgICAgICBsZXQgZGlyID0gdGhpcy5wYXRoLnNoaWZ0KCk7XG4gICAgICAgICAgICBzd2l0Y2ggKGRpcikge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJFXCI6XG4gICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUgPSBldy5nZXRFYXN0KCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJOXCI6XG4gICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUgPSBldy5nZXROb3J0aCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiU1wiOlxuICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVTaXRlID0gZXcuZ2V0U291dGgoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIldcIjpcbiAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlU2l0ZSA9IGV3LmdldFdlc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXZhaWxhYmxlU2l0ZSAmJlxuICAgICAgICAgICAgICAgIChhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLlJFUyB8fCBhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLkVNUFRZKSkge1xuICAgICAgICAgICAgICAgIGV3Lm9yaWdpbi5tb3ZlQXRvbShhdmFpbGFibGVTaXRlLCBuZXcgQXRvbShFbGVtZW50VHlwZXMuV0FMTCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYXZhaWxhYmxlU2l0ZSAmJiBhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLldBTEwpIHtcbiAgICAgICAgICAgICAgICAvL2V3Lm9yaWdpbi5raWxsU2VsZihuZXcgQXRvbShFbGVtZW50VHlwZXMuV0FMTCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFhdmFpbGFibGVTaXRlKSB7XG4gICAgICAgICAgICAgICAgLy9ldy5vcmlnaW4ua2lsbFNlbGYobmV3IEF0b20oRWxlbWVudFR5cGVzLldBTEwpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGV3Lm9yaWdpbi5raWxsU2VsZihuZXcgQXRvbShFbGVtZW50VHlwZXMuV0FMTCkpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi9FbGVtZW50VHlwZXNcIjtcbi8vRXZlbnQgd2luZG93IGFzIGRlc2NyaWJiZWQgaGVyZTogaHR0cDovL3JvYnVzdC5jcy51bm0uZWR1L2xpYi9leGUvZmV0Y2gucGhwP3c9MzAwJnRvaz00YzhmNDkmbWVkaWE9ZGV2OmV2ZW50LXdpbmRvdy0xMC5wbmdcbi8vQ29sbGVjdGlvbiBvZiBzaXRlcyB3aGljaCBjb250YWluIGF0b21zLCBidWlsdCBmcm9tIGFuIG9yaWdpbiAoY2VudGVyKSBzaXRlXG5leHBvcnQgY2xhc3MgRXZlbnRXaW5kb3cge1xuICAgIGNvbnN0cnVjdG9yKF90aWxlLCBfb3JpZ2luKSB7XG4gICAgICAgIHRoaXMudGlsZSA9IF90aWxlO1xuICAgICAgICB0aGlzLm1ha2VXaW5kb3coX3RpbGUsIF9vcmlnaW4pO1xuICAgIH1cbiAgICBtYWtlV2luZG93KHRpbGUsIG9yaWdpbikge1xuICAgICAgICB0aGlzLndpbmRvdyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5vcmlnaW4gPSB0aGlzLnRpbGUuZ2V0U2l0ZUJ5Q29vcmQob3JpZ2luKTtcbiAgICAgICAgLy9pZiB0aGUgb3JpZ2luIGlzIEVNUFRZIEVsZW1lbnQsIGxldCdzIHNhdmUgc29tZSBjeWNsZXMgKGdvb2QsIGJhZD8pXG4gICAgICAgIGlmICh0aGlzLm9yaWdpbi5hdG9tLnR5cGUgPT09IEVsZW1lbnRUeXBlcy5FTVBUWSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy53aW5kb3cuc2V0KHRoaXMub3JpZ2luLmlkLCB0aGlzLm9yaWdpbik7XG4gICAgICAgIGxldCB3aW5kb3dBcnJheSA9IEV2ZW50V2luZG93LldJTkRPV19PUkRFUl9PRkZTRVRTLm1hcCgob2Zmc2V0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5PZmZzZXRGcm9tT3JpZ2luKG9yaWdpbiwgb2Zmc2V0LnJvdywgb2Zmc2V0LmNvbCk7XG4gICAgICAgIH0pO1xuICAgICAgICB3aW5kb3dBcnJheS5mb3JFYWNoKCh0aWxlQ29vcmQpID0+IHtcbiAgICAgICAgICAgIGxldCBzaXRlID0gdGlsZS5nZXRTaXRlQnlDb29yZCh0aWxlQ29vcmQpO1xuICAgICAgICAgICAgaWYgKHNpdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy5zZXQoc2l0ZS5pZCwgc2l0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBPZmZzZXRGcm9tT3JpZ2luKG9yaWdpbiwgcm93T2Zmc2V0LCBjb2xPZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIHsgcm93OiBvcmlnaW4ucm93ICsgcm93T2Zmc2V0LCBjb2w6IG9yaWdpbi5jb2wgKyBjb2xPZmZzZXQgfTtcbiAgICB9XG4gICAgZ2V0UmFuZG9tKHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTaXRlRnJvbUNhbmRpZGF0ZXMoQXJyYXkuZnJvbSh0aGlzLndpbmRvdy52YWx1ZXMoKSksIHRydWUsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIGdldE5lYXJlc3Qoc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNpdGVGcm9tQ2FuZGlkYXRlcyhBcnJheS5mcm9tKHRoaXMud2luZG93LnZhbHVlcygpKSwgZmFsc2UsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIGdldEVhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19FQVNUKTtcbiAgICB9XG4gICAgZ2V0V2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1dFU1QpO1xuICAgIH1cbiAgICBnZXROb3J0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIKTtcbiAgICB9XG4gICAgZ2V0U291dGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19TT1VUSCk7XG4gICAgfVxuICAgIGdldE5vcnRoV2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIV0VTVCk7XG4gICAgfVxuICAgIGdldFNvdXRoV2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1NPVVRIV0VTVCk7XG4gICAgfVxuICAgIGdldE5vcnRoRWFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIRUFTVCk7XG4gICAgfVxuICAgIGdldFNvdXRoRWFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1NPVVRIRUFTVCk7XG4gICAgfVxuICAgIGdldEFkamFjZW50NFdheShyYW5kb21pemUgPSB0cnVlLCBzcGVjaWZpY1R5cGUgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2l0ZUZyb21DYW5kaWRhdGVzKFt0aGlzLmdldFdlc3QoKSwgdGhpcy5nZXROb3J0aCgpLCB0aGlzLmdldFNvdXRoKCksIHRoaXMuZ2V0RWFzdCgpXSwgcmFuZG9taXplLCBzcGVjaWZpY1R5cGUpO1xuICAgIH1cbiAgICBnZXRBZGphY2VudDhXYXkocmFuZG9taXplID0gdHJ1ZSwgc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNpdGVGcm9tQ2FuZGlkYXRlcyhbXG4gICAgICAgICAgICB0aGlzLmdldFdlc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0Tm9ydGgoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0U291dGgoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0RWFzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXROb3J0aFdlc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0U291dGhXZXN0KCksXG4gICAgICAgICAgICB0aGlzLmdldE5vcnRoRWFzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXRTb3V0aEVhc3QoKVxuICAgICAgICBdLCByYW5kb21pemUsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIC8vR2l2ZW4gYW4gYXJyYXkgb2YgY2FuZGlkYXRlIHNpdGVzIChzeW1tZXRyaWVzIGluIHRoZSBmdXR1cmUgSSBob3BlKSwgZ2l2ZSBtZSBiYWNrIG9uZSwgcmFuZG9tIGJ5IGRlZmF1bHQsIG5vdCBmaWx0ZXJlZCBieSB0eXBlIGJ5IGRlZmF1bHRcbiAgICBnZXRTaXRlRnJvbUNhbmRpZGF0ZXMoY2FuZGlkYXRlU2l0ZXMsIHJhbmRvbWl6ZSA9IHRydWUsIHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICBjYW5kaWRhdGVTaXRlcyA9IGNhbmRpZGF0ZVNpdGVzLmZpbHRlcihzaXRlID0+IHtcbiAgICAgICAgICAgIGlmICghc2l0ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNwZWNpZmljVHlwZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzaXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3BlY2lmaWNUeXBlICYmIHNpdGUuYXRvbS50eXBlID09PSBzcGVjaWZpY1R5cGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2l0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vbm8gc2l0ZXMhIHlpa2VzISBwb3NzaWJsZSE/ISBwcm9iYWJseSBvbmx5IHdoZW4gdXNpbmcgc3BlY2lmaWNUeXBlIGFuZCBsb29raW5nIGZvciBhIHJhcmUgZWxlbWVudFxuICAgICAgICBpZiAoY2FuZGlkYXRlU2l0ZXMubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICAvL3JldHVybiByYW5kb21cbiAgICAgICAgaWYgKHJhbmRvbWl6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZVNpdGVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNhbmRpZGF0ZVNpdGVzLmxlbmd0aCldO1xuICAgICAgICB9XG4gICAgICAgIC8vcmV0dXJuIGZpcnN0IG1hdGNoaW5nXG4gICAgICAgIHJldHVybiBjYW5kaWRhdGVTaXRlc1swXTtcbiAgICB9XG4gICAgZ2V0RGlyZWN0aW9uKGRpcmVjdGlvbikge1xuICAgICAgICBsZXQgc2l0ZSA9IHRoaXMudGlsZS5zaXRlcy5nZXQoTUZNVXRpbHMuQ3RvSUQodGhpcy5PZmZzZXRGcm9tT3JpZ2luKHRoaXMub3JpZ2luLnRpbGVQb3MsIGRpcmVjdGlvbi5yb3csIGRpcmVjdGlvbi5jb2wpKSk7XG4gICAgICAgIGlmIChzaXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gc2l0ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbn1cbkV2ZW50V2luZG93LldJTkRPV19PUkRFUl9PRkZTRVRTID0gW1xuICAgIHsgY29sOiAwLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogMSB9LFxuICAgIHsgY29sOiAxLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMSB9LFxuICAgIHsgY29sOiAxLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMCwgcm93OiAyIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMSwgcm93OiAtMiB9LFxuICAgIHsgY29sOiAxLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMiwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAyLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTMsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC0zIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogMyB9LFxuICAgIHsgY29sOiAzLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogLTIgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogMiB9LFxuICAgIHsgY29sOiAyLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogMiB9LFxuICAgIHsgY29sOiAtMywgcm93OiAtMSB9LFxuICAgIHsgY29sOiAtMywgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IC0zIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IDMgfSxcbiAgICB7IGNvbDogMSwgcm93OiAtMyB9LFxuICAgIHsgY29sOiAxLCByb3c6IDMgfSxcbiAgICB7IGNvbDogMywgcm93OiAtMSB9LFxuICAgIHsgY29sOiAzLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTQsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC00IH0sXG4gICAgeyBjb2w6IDAsIHJvdzogNCB9LFxuICAgIHsgY29sOiA0LCByb3c6IDAgfVxuXTtcbi8vYmVjYXVzZSwgbGF6eVxuRXZlbnRXaW5kb3cuRVdfV0VTVCA9IHsgY29sOiAtMSwgcm93OiAwIH07XG5FdmVudFdpbmRvdy5FV19FQVNUID0geyBjb2w6IDEsIHJvdzogMCB9O1xuRXZlbnRXaW5kb3cuRVdfTk9SVEggPSB7IGNvbDogMCwgcm93OiAtMSB9O1xuRXZlbnRXaW5kb3cuRVdfU09VVEggPSB7IGNvbDogMCwgcm93OiAxIH07XG5FdmVudFdpbmRvdy5FV19OT1JUSFdFU1QgPSB7IGNvbDogLTEsIHJvdzogLTEgfTtcbkV2ZW50V2luZG93LkVXX1NPVVRIV0VTVCA9IHsgY29sOiAtMSwgcm93OiAxIH07XG5FdmVudFdpbmRvdy5FV19OT1JUSEVBU1QgPSB7IGNvbDogMSwgcm93OiAtMSB9O1xuRXZlbnRXaW5kb3cuRVdfU09VVEhFQVNUID0geyBjb2w6IDEsIHJvdzogMSB9O1xuIiwiaW1wb3J0IHsgRXZlbnRXaW5kb3cgfSBmcm9tIFwiLi4vY2xhc3Nlcy9FdmVudHdpbmRvd1wiO1xuZXhwb3J0IGNsYXNzIE1GTVV0aWxzIHtcbiAgICBzdGF0aWMgQ3RvSUQoYykge1xuICAgICAgICByZXR1cm4gYCR7Yy5yb3d9OiR7Yy5jb2x9YDtcbiAgICB9XG4gICAgc3RhdGljIElEdG9DKGlkKSB7XG4gICAgICAgIGxldCByY2EgPSBpZC5zcGxpdChcIjpcIik7XG4gICAgICAgIHJldHVybiB7IHJvdzogcGFyc2VJbnQocmNhWzBdKSwgY29sOiBwYXJzZUludChyY2FbMV0pIH07XG4gICAgfVxuICAgIHN0YXRpYyBHZW5lcmF0ZUV2ZW50V2luZG93KHRpbGUsIHcsIGgpIHtcbiAgICAgICAgbGV0IHJjID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdyk7XG4gICAgICAgIGxldCByciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGgpO1xuICAgICAgICByZXR1cm4gbmV3IEV2ZW50V2luZG93KHRpbGUsIHsgcm93OiByciwgY29sOiByYyB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgQXRvbSB9IGZyb20gXCIuL0F0b21cIjtcbmltcG9ydCB7IEVsZW1lbnRUeXBlcyB9IGZyb20gXCIuL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIFNpdGUge1xuICAgIGNvbnN0cnVjdG9yKF9wb3MpIHtcbiAgICAgICAgdGhpcy50aWxlUG9zID0gX3BvcztcbiAgICAgICAgdGhpcy5pZCA9IE1GTVV0aWxzLkN0b0lEKHRoaXMudGlsZVBvcyk7XG4gICAgICAgIHRoaXMuY3JlYXRlKCk7XG4gICAgfVxuICAgIC8vaWYgdGFyZ2V0U2l0ZSBpcyBraWxsYWJsZVxuICAgIC8va2lsbCBpdHMgYXRvbSAocmVwbGFjZSB3aXRoIGVtcHR5KVxuICAgIGtpbGxBdG9tKHRhcmdldFNpdGUpIHtcbiAgICAgICAgbGV0IGtpbGwgPSBNYXRoLnJhbmRvbSgpICogMTAwIDwgdGFyZ2V0U2l0ZS5hdG9tLmVsZW0ua2lsbGFiaWxpdHk7XG4gICAgICAgIGlmIChraWxsKSB7XG4gICAgICAgICAgICB0YXJnZXRTaXRlLmF0b20gPSBuZXcgQXRvbShFbGVtZW50VHlwZXMuRU1QVFkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGtpbGxTZWxmKGxlYXZpbmdBdG9tID0gbmV3IEF0b20oRWxlbWVudFR5cGVzLkVNUFRZKSkge1xuICAgICAgICB0aGlzLmF0b20gPSBsZWF2aW5nQXRvbTtcbiAgICB9XG4gICAgLy9pZiB0YXJnZXQgc2l0ZSBpcyBraWxsYWJsZVxuICAgIC8vbW92ZSB0aGlzIGF0b20gdG8gdGFyZ2V0U2l0ZSwgYW5kIGxlYXZlIGJlaGluZCBsZWF2aW5nQXRvbSwgd2hpY2ggYnkgZGVmYXVsdCBpcyBlbXB0eVxuICAgIG1vdmVBdG9tKHRhcmdldFNpdGUsIGxlYXZpbmdBdG9tID0gbmV3IEF0b20oRWxlbWVudFR5cGVzLkVNUFRZKSkge1xuICAgICAgICBpZiAodGFyZ2V0U2l0ZSkge1xuICAgICAgICAgICAgbGV0IGtpbGwgPSBNYXRoLnJhbmRvbSgpICogMTAwIDwgdGFyZ2V0U2l0ZS5hdG9tLmVsZW0ua2lsbGFiaWxpdHk7XG4gICAgICAgICAgICBpZiAoa2lsbCkge1xuICAgICAgICAgICAgICAgIFt0aGlzLmF0b20sIHRhcmdldFNpdGUuYXRvbV0gPSBbbGVhdmluZ0F0b20sIHRoaXMuYXRvbV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy9pZiB0YXJnZXRTaXRlIGlzIG1vdmVhYmxlXG4gICAgLy9zd2FwIGF0b21zIHdpdGggdGhpcyBvbmVcbiAgICBzd2FwQXRvbXModGFyZ2V0U2l0ZSkge1xuICAgICAgICBpZiAodGFyZ2V0U2l0ZSkge1xuICAgICAgICAgICAgbGV0IG1vdmUgPSBNYXRoLnJhbmRvbSgpICogMTAwIDwgdGFyZ2V0U2l0ZS5hdG9tLmVsZW0ubW92ZWFiaWxpdHk7XG4gICAgICAgICAgICBpZiAobW92ZSkge1xuICAgICAgICAgICAgICAgIFt0aGlzLmF0b20sIHRhcmdldFNpdGUuYXRvbV0gPSBbdGFyZ2V0U2l0ZS5hdG9tLCB0aGlzLmF0b21dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZSgpIHtcbiAgICAgICAgdGhpcy5hdG9tID0gbmV3IEF0b20oKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBUaWxlIH0gZnJvbSBcIi4vbWZtL2NsYXNzZXMvVGlsZVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4vbWZtL2NsYXNzZXMvRWxlbWVudFR5cGVzXCI7XG5pbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuL21mbS91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgQXRvbSB9IGZyb20gXCIuL21mbS9jbGFzc2VzL0F0b21cIjtcbmxldCBnID0gbmV3IFRpbGUoMzIsIDMyKTtcbnZhciBza2V0Y2ggPSAocCkgPT4ge1xuICAgIGxldCBzaXRlU2l6ZSA9IDE0O1xuICAgIGxldCBncmlkT2Zmc2V0ID0gMjU7XG4gICAgcC5wcmVsb2FkID0gKCkgPT4geyB9O1xuICAgIHAuc2V0dXAgPSAoKSA9PiB7XG4gICAgICAgIHAuY3JlYXRlQ2FudmFzKDcwMCwgNzAwKTtcbiAgICB9O1xuICAgIC8vICAgcC53aW5kb3dSZXNpemVkID0gKCkgPT4ge1xuICAgIC8vICAgICBwLnJlc2l6ZUNhbnZhcyhwLndpbmRvd1dpZHRoIC0gNTAsIHAud2luZG93SGVpZ2h0IC0gNTApO1xuICAgIC8vICAgfTtcbiAgICBsZXQgZHJhd0dyaWQgPSAocCwgdCkgPT4ge1xuICAgICAgICBwLnB1c2goKTtcbiAgICAgICAgcC50cmFuc2xhdGUoZ3JpZE9mZnNldCwgZ3JpZE9mZnNldCk7XG4gICAgICAgIHQuc2l0ZXMuZm9yRWFjaCgoc2l0ZSkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChzaXRlLmF0b20uZWxlbS50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBFbGVtZW50VHlwZXMuRU1QVFkudHlwZTpcbiAgICAgICAgICAgICAgICAgICAgcC5zdHJva2UoMCwgMCwgMCwgMCk7XG4gICAgICAgICAgICAgICAgICAgIHAuZmlsbCgzMiwgMzIsIDMyLCAxMjcpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIEVsZW1lbnRUeXBlcy5EUkVHLnR5cGU6XG4gICAgICAgICAgICAgICAgICAgIHAuc3Ryb2tlKDAsIDAsIDAsIDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIHAuZmlsbCgyNTUsIDMyLCAzMik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgRWxlbWVudFR5cGVzLlJFUy50eXBlOlxuICAgICAgICAgICAgICAgICAgICBwLnN0cm9rZSgwLCAwLCAwLCAxMjcpO1xuICAgICAgICAgICAgICAgICAgICBwLmZpbGwoMzIsIDI1NSwgNjQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIEVsZW1lbnRUeXBlcy5XQUxMLnR5cGU6XG4gICAgICAgICAgICAgICAgICAgIHAuc3Ryb2tlKDAsIDAsIDAsIDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIHAuZmlsbCgzMiwgMzIsIDI1NSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgRWxlbWVudFR5cGVzLk1BU09OLnR5cGU6XG4gICAgICAgICAgICAgICAgICAgIHAuc3Ryb2tlKDAsIDAsIDAsIDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIHAuZmlsbCgzMiwgMjU1LCAyNTUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAuZWxsaXBzZShzaXRlLnRpbGVQb3MuY29sICogc2l0ZVNpemUsIHNpdGUudGlsZVBvcy5yb3cgKiBzaXRlU2l6ZSwgc2l0ZVNpemUsIHNpdGVTaXplKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHAucG9wKCk7XG4gICAgfTtcbiAgICBsZXQgcnVuID0gKCkgPT4ge1xuICAgICAgICBsZXQgc3BlZWQgPSAxMDAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwZWVkOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBldyA9IE1GTVV0aWxzLkdlbmVyYXRlRXZlbnRXaW5kb3coZywgZy53aWR0aCwgZy5oZWlnaHQpO1xuICAgICAgICAgICAgZXcub3JpZ2luLmF0b20uZXhlYyhldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGxldCBnZXRTaXRlRnJvbUNhbnZhc1hZID0gKHgsIHkpID0+IHtcbiAgICAgICAgeCA9IHggLSBncmlkT2Zmc2V0ICsgc2l0ZVNpemUgKiAwLjU7XG4gICAgICAgIHkgPSB5IC0gZ3JpZE9mZnNldCArIHNpdGVTaXplICogMC41O1xuICAgICAgICB4ID0gTWF0aC5mbG9vcih4IC8gc2l0ZVNpemUpO1xuICAgICAgICB5ID0gTWF0aC5mbG9vcih5IC8gc2l0ZVNpemUpO1xuICAgICAgICByZXR1cm4gZy5nZXRTaXRlQnlDb29yZCh7IHJvdzogeSwgY29sOiB4IH0pO1xuICAgIH07XG4gICAgcC5kcmF3ID0gKCkgPT4ge1xuICAgICAgICBwLmJhY2tncm91bmQoMTAwKTtcbiAgICAgICAgZHJhd0dyaWQocCwgZyk7XG4gICAgICAgIHJ1bigpO1xuICAgIH07XG4gICAgcC5tb3VzZUNsaWNrZWQgPSAoKSA9PiB7XG4gICAgICAgIGxldCBzaXRlID0gZ2V0U2l0ZUZyb21DYW52YXNYWShwLm1vdXNlWCwgcC5tb3VzZVkpO1xuICAgICAgICBpZiAoc2l0ZSkge1xuICAgICAgICAgICAgaWYgKHAua2V5SXNQcmVzc2VkKSB7XG4gICAgICAgICAgICAgICAgc2l0ZS5hdG9tID0gbmV3IEF0b20oRWxlbWVudFR5cGVzLk1BU09OKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNpdGUuYXRvbSA9IG5ldyBBdG9tKEVsZW1lbnRUeXBlcy5EUkVHKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59O1xubGV0IHNrZXRjaFAgPSBuZXcgcDUoc2tldGNoKTtcbiIsImltcG9ydCB7IFNpdGUgfSBmcm9tIFwiLi9TaXRlXCI7XG5pbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuZXhwb3J0IGNsYXNzIFRpbGUge1xuICAgIGNvbnN0cnVjdG9yKF93aWR0aCA9IDEsIF9oZWlnaHQgPSAxKSB7XG4gICAgICAgIHRoaXMud2lkdGggPSBfd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gX2hlaWdodDtcbiAgICAgICAgdGhpcy5jcmVhdGUoKTtcbiAgICB9XG4gICAgZ2V0U2l0ZUJ5Q29vcmQoYykge1xuICAgICAgICByZXR1cm4gdGhpcy5zaXRlcy5nZXQoTUZNVXRpbHMuQ3RvSUQoYykpO1xuICAgIH1cbiAgICBnZXRSYW5kb21TaXRlKCkge1xuICAgICAgICBsZXQgcnIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLmhlaWdodCk7XG4gICAgICAgIGxldCByYyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMud2lkdGgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zaXRlcy5nZXQoYCR7cnJ9OiR7cmN9YCk7XG4gICAgfVxuICAgIGNyZWF0ZSgpIHtcbiAgICAgICAgdGhpcy5zaXRlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLndpZHRoOyBpKyspIHtcbiAgICAgICAgICAgIC8vYWNyb3NzIGNvbHVtbnNcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5oZWlnaHQ7IGorKykge1xuICAgICAgICAgICAgICAgIC8vZG93biByb3dzXG4gICAgICAgICAgICAgICAgdGhpcy5zaXRlcy5zZXQoYCR7an06JHtpfWAsIG5ldyBTaXRlKHsgcm93OiBqLCBjb2w6IGkgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==