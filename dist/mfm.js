!function(t){var e={};function o(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(r,s,function(e){return t[e]}.bind(null,s));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);class r{constructor(t,e,o=!0,r=!0,s=0){this.name=t,this.type=e,this.data=s,this.moveable=o,this.killable=r}set data(t){this._data=t}get data(){return this._data}set name(t){this._name=t}get name(){return this._name}set type(t){this._type=t}get type(){return this._type}set moveable(t){this._moveable=t}get moveable(){return this._moveable}set killable(t){this._killable=t}get killable(){return this._killable}exec(t){}}class s{constructor(t=i.EMPTY){this.type=t,this.elem=new this.type.class}exec(t){this.elem.exec(t)}}class i{static registerType(t,e,o){this.TYPES_ARRAY.push({name:t,type:e,class:o})}}i.EMPTY={name:"EMPTY",type:"E",class:class extends r{constructor(){super(i.EMPTY.name,i.EMPTY.type)}exec(t){super.exec(t)}}},i.DREG={name:"DREG",type:"D",class:class extends r{constructor(){super(i.DREG.name,i.DREG.type),this.pTOTAL_CHANCE=100,this.pDREG_CREATE=.1,this.pRES_CREATE=.5,this.pDREG_DESTROY=10,this.pANY_DESTROY=1}exec(t){const e=t.getAdjacent4Way();if(e.atom.type===i.EMPTY){const o=Math.random()*this.pTOTAL_CHANCE<this.pDREG_CREATE,r=Math.random()*this.pTOTAL_CHANCE<this.pRES_CREATE;o?(e.atom=new s(i.DREG),console.log("DREG CREATED")):r&&(e.atom=new s(i.RES),console.log("RES CREATED")),t.origin.swapAtoms(e)}else e.atom.type===i.DREG?Math.random()*this.pTOTAL_CHANCE<this.pDREG_DESTROY&&(e.atom=new s(i.EMPTY),console.log("DREG DESTROYED"),t.origin.swapAtoms(e)):Math.random()*this.pTOTAL_CHANCE<this.pANY_DESTROY&&(console.log(e.atom.type.name+" DESTROYED"),e.atom=new s(i.EMPTY),t.origin.swapAtoms(e));super.exec(t)}}},i.RES={name:"RES",type:"R",class:class extends r{constructor(){super(i.RES.name,i.RES.type)}exec(t){t.origin.swapAtoms(t.getRandom(i.EMPTY)),super.exec(t)}}},i.TYPES_ARRAY=[i.EMPTY,i.DREG,i.RES];class n{constructor(t,e){this.tile=t,this.makeWindow(t,e)}makeWindow(t,e){if(this.window=new Map,this.origin=this.tile.getSiteByCoord(e),this.origin.atom.type===i.EMPTY)return;this.window.set(this.origin.id,this.origin),n.WINDOW_ORDER_OFFSETS.map(t=>this.OffsetFromOrigin(e,t.row,t.col)).forEach(e=>{let o=t.getSiteByCoord(e);o&&this.window.set(o.id,o)})}OffsetFromOrigin(t,e,o){return{row:t.row+e,col:t.col+o}}getRandom(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!0,t)}getNearest(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!1,t)}getEast(){return this.getDirection(n.EW_EAST)}getWest(){return this.getDirection(n.EW_WEST)}getNorth(){return this.getDirection(n.EW_NORTH)}getSouth(){return this.getDirection(n.EW_SOUTH)}getNorthWest(){return this.getDirection(n.EW_NORTHWEST)}getSouthWest(){return this.getDirection(n.EW_SOUTHWEST)}getNorthEast(){return this.getDirection(n.EW_NORTHEAST)}getSouthEast(){return this.getDirection(n.EW_SOUTHEAST)}getAdjacent4Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast()],t,e)}getAdjacent8Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast(),this.getNorthWest(),this.getSouthWest(),this.getNorthEast(),this.getSouthEast()],t,e)}getSiteFromCandidates(t,e=!0,o){if(!((t=t.filter(t=>!!t&&(o?!(!o||t.atom.type!==o)&&t:t))).length<1))return e?t[Math.floor(Math.random()*t.length)]:t[0]}getDirection(t){let e=this.tile.sites.get(a.CtoID(this.OffsetFromOrigin(this.origin.tilePos,t.row,t.col)));if(e)return e}}n.WINDOW_ORDER_OFFSETS=[{col:0,row:0},{col:-1,row:0},{col:0,row:-1},{col:0,row:1},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1},{col:-2,row:0},{col:0,row:-1},{col:0,row:2},{col:2,row:0},{col:-2,row:-1},{col:-2,row:1},{col:-1,row:-2},{col:-1,row:2},{col:1,row:-2},{col:1,row:2},{col:2,row:-1},{col:2,row:1},{col:-3,row:0},{col:0,row:-3},{col:0,row:3},{col:3,row:0},{col:-2,row:-2},{col:-2,row:2},{col:2,row:-2},{col:2,row:2},{col:-3,row:-1},{col:-3,row:1},{col:-1,row:-3},{col:-1,row:3},{col:1,row:-3},{col:1,row:3},{col:3,row:-1},{col:3,row:1},{col:-4,row:0},{col:0,row:-4},{col:0,row:4},{col:4,row:0}],n.EW_WEST={col:-1,row:0},n.EW_EAST={col:1,row:0},n.EW_NORTH={col:0,row:-1},n.EW_SOUTH={col:0,row:1},n.EW_NORTHWEST={col:-1,row:-1},n.EW_SOUTHWEST={col:-1,row:1},n.EW_NORTHEAST={col:1,row:-1},n.EW_SOUTHEAST={col:1,row:1};class a{static CtoID(t){return`${t.row}:${t.col}`}static IDtoC(t){let e=t.split(":");return{row:parseInt(e[0]),col:parseInt(e[1])}}static GenerateEventWindow(t,e,o){let r=Math.floor(Math.random()*e),s=Math.floor(Math.random()*o);return new n(t,{row:s,col:r})}}class l{constructor(t){this.tilePos=t,this.id=a.CtoID(this.tilePos),this.create()}swapAtoms(t){t&&([this.atom,t.atom]=[t.atom,this.atom])}create(){this.atom=new s}}let c=new class{constructor(t=1,e=1){this.width=t,this.height=e,this.create()}getSiteByCoord(t){return this.sites.get(a.CtoID(t))}getRandomSite(){let t=Math.floor(Math.random()*this.height),e=Math.floor(Math.random()*this.width);return this.sites.get(`${t}:${e}`)}create(){this.sites=new Map;for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)this.sites.set(`${e}:${t}`,new l({row:e,col:t}))}}(32,32);new p5(t=>{t.preload=(()=>{}),t.setup=(()=>{t.createCanvas(700,700)});t.draw=(()=>{t.background(100),((t,e)=>{t.push(),t.translate(25,25),e.sites.forEach(e=>{switch(e.atom.elem.type){case i.EMPTY.type:t.stroke(0,0,0,0),t.fill(32,32,32,127);break;case i.DREG.type:t.stroke(0,0,0,127),t.fill(255,32,32);break;case i.RES.type:t.stroke(0,0,0,127),t.fill(32,255,64)}t.ellipse(14*e.tilePos.col,14*e.tilePos.row,14,14)}),t.pop()})(t,c),(()=>{for(var t=0;t<1e3;t++){let t=a.GenerateEventWindow(c,c.width,c.height);t.origin.atom.exec(t)}})()}),t.mouseClicked=(()=>{let e=((t,e)=>(t=t-25+7,e=e-25+7,t=Math.floor(t/14),e=Math.floor(e/14),c.getSiteByCoord({row:e,col:t})))(t.mouseX,t.mouseY);e&&(e.atom=new s(i.DREG))})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW0udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0F0b20udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW1lbnRUeXBlcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvRW1wdHlFbGVtZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9tZm0vY2xhc3Nlcy9lbGVtZW50cy9EUmVnRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvUmVzRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvRXZlbnR3aW5kb3cudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS91dGlscy91dGlscy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvU2l0ZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL1RpbGUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJFbGVtIiwiW29iamVjdCBPYmplY3RdIiwiX25hbWUiLCJfdHlwZSIsIl9tb3ZlYWJsZSIsIl9raWxsYWJsZSIsIl9kYXRhIiwidGhpcyIsInR5cGUiLCJkYXRhIiwibW92ZWFibGUiLCJraWxsYWJsZSIsImsiLCJldyIsIkF0b21fQXRvbSIsIkVsZW1lbnRUeXBlcyIsIkVNUFRZIiwiZWxlbSIsImNsYXNzIiwiZXhlYyIsIlRZUEVTX0FSUkFZIiwicHVzaCIsInN1cGVyIiwiRFJFRyIsInBUT1RBTF9DSEFOQ0UiLCJwRFJFR19DUkVBVEUiLCJwUkVTX0NSRUFURSIsInBEUkVHX0RFU1RST1kiLCJwQU5ZX0RFU1RST1kiLCJhdmFpbGFibGVTaXRlIiwiZ2V0QWRqYWNlbnQ0V2F5IiwiYXRvbSIsImNyZWF0ZURSZWciLCJNYXRoIiwicmFuZG9tIiwiY3JlYXRlUmVzIiwiY29uc29sZSIsImxvZyIsIlJFUyIsIm9yaWdpbiIsInN3YXBBdG9tcyIsImdldFJhbmRvbSIsIkV2ZW50d2luZG93X0V2ZW50V2luZG93IiwiX3RpbGUiLCJfb3JpZ2luIiwidGlsZSIsIm1ha2VXaW5kb3ciLCJ3aW5kb3ciLCJNYXAiLCJnZXRTaXRlQnlDb29yZCIsInNldCIsImlkIiwiV0lORE9XX09SREVSX09GRlNFVFMiLCJtYXAiLCJvZmZzZXQiLCJPZmZzZXRGcm9tT3JpZ2luIiwicm93IiwiY29sIiwiZm9yRWFjaCIsInRpbGVDb29yZCIsInNpdGUiLCJyb3dPZmZzZXQiLCJjb2xPZmZzZXQiLCJzcGVjaWZpY1R5cGUiLCJnZXRTaXRlRnJvbUNhbmRpZGF0ZXMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJnZXREaXJlY3Rpb24iLCJFV19FQVNUIiwiRVdfV0VTVCIsIkVXX05PUlRIIiwiRVdfU09VVEgiLCJFV19OT1JUSFdFU1QiLCJFV19TT1VUSFdFU1QiLCJFV19OT1JUSEVBU1QiLCJFV19TT1VUSEVBU1QiLCJyYW5kb21pemUiLCJnZXRXZXN0IiwiZ2V0Tm9ydGgiLCJnZXRTb3V0aCIsImdldEVhc3QiLCJnZXROb3J0aFdlc3QiLCJnZXRTb3V0aFdlc3QiLCJnZXROb3J0aEVhc3QiLCJnZXRTb3V0aEVhc3QiLCJjYW5kaWRhdGVTaXRlcyIsImZpbHRlciIsImxlbmd0aCIsImZsb29yIiwiZGlyZWN0aW9uIiwic2l0ZXMiLCJ1dGlsc19NRk1VdGlscyIsIkN0b0lEIiwidGlsZVBvcyIsInJjYSIsInNwbGl0IiwicGFyc2VJbnQiLCJ3IiwiaCIsInJjIiwicnIiLCJTaXRlX1NpdGUiLCJfcG9zIiwidGFyZ2V0U2l0ZSIsImciLCJfd2lkdGgiLCJfaGVpZ2h0Iiwid2lkdGgiLCJoZWlnaHQiLCJqIiwicDUiLCJwcmVsb2FkIiwic2V0dXAiLCJjcmVhdGVDYW52YXMiLCJkcmF3IiwiYmFja2dyb3VuZCIsInRyYW5zbGF0ZSIsInN0cm9rZSIsImZpbGwiLCJlbGxpcHNlIiwicG9wIiwiZHJhd0dyaWQiLCJHZW5lcmF0ZUV2ZW50V2luZG93IiwicnVuIiwibW91c2VDbGlja2VkIiwieCIsInkiLCJzaXRlU2l6ZSIsImdldFNpdGVGcm9tQ2FudmFzWFkiLCJtb3VzZVgiLCJtb3VzZVkiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsYUFBd0RDLE1BQUEsV0FF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QUFzQyxFQTFDQSxJQTJDQXRCLEVBQUF4RCxnQkFBaUNPLElBQUF1RSxFQUFBdEUsSUFBQXFFLEtBUWpDRyxDQUFBbkksRUFBQW9JLE9BQUFwSSxFQUFBcUksUUFDQXZFLElBQ0FBLEVBQUE3QixLQUFBLElBQTRCakIsRUFBS0MsRUFBWVEiLCJmaWxlIjoibWZtLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGNsYXNzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKF9uYW1lLCBfdHlwZSwgX21vdmVhYmxlID0gdHJ1ZSwgX2tpbGxhYmxlID0gdHJ1ZSwgX2RhdGEgPSAwKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IF9uYW1lO1xuICAgICAgICB0aGlzLnR5cGUgPSBfdHlwZTtcbiAgICAgICAgdGhpcy5kYXRhID0gX2RhdGE7XG4gICAgICAgIHRoaXMubW92ZWFibGUgPSBfbW92ZWFibGU7XG4gICAgICAgIHRoaXMua2lsbGFibGUgPSBfa2lsbGFibGU7XG4gICAgfVxuICAgIHNldCBkYXRhKGQpIHtcbiAgICAgICAgdGhpcy5fZGF0YSA9IGQ7XG4gICAgfVxuICAgIGdldCBkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICB9XG4gICAgc2V0IG5hbWUobikge1xuICAgICAgICB0aGlzLl9uYW1lID0gbjtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgIH1cbiAgICBzZXQgdHlwZSh0KSB7XG4gICAgICAgIHRoaXMuX3R5cGUgPSB0O1xuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgfVxuICAgIHNldCBtb3ZlYWJsZShtKSB7XG4gICAgICAgIHRoaXMuX21vdmVhYmxlID0gbTtcbiAgICB9XG4gICAgZ2V0IG1vdmVhYmxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbW92ZWFibGU7XG4gICAgfVxuICAgIHNldCBraWxsYWJsZShrKSB7XG4gICAgICAgIHRoaXMuX2tpbGxhYmxlID0gaztcbiAgICB9XG4gICAgZ2V0IGtpbGxhYmxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2lsbGFibGU7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHsgfVxufVxuIiwiaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgQXRvbSB7XG4gICAgY29uc3RydWN0b3IoX3R5cGUgPSBFbGVtZW50VHlwZXMuRU1QVFkpIHtcbiAgICAgICAgdGhpcy50eXBlID0gX3R5cGU7XG4gICAgICAgIHRoaXMuZWxlbSA9IG5ldyB0aGlzLnR5cGUuY2xhc3MoKTtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICB0aGlzLmVsZW0uZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRW1wdHlFbGVtZW50IH0gZnJvbSBcIi4vZWxlbWVudHMvRW1wdHlFbGVtZW50XCI7XG5pbXBvcnQgeyBEUmVnRWxlbWVudCB9IGZyb20gXCIuL2VsZW1lbnRzL0RSZWdFbGVtZW50XCI7XG5pbXBvcnQgeyBSZXNFbGVtZW50IH0gZnJvbSBcIi4vZWxlbWVudHMvUmVzRWxlbWVudFwiO1xuZXhwb3J0IGNsYXNzIEVsZW1lbnRUeXBlcyB7XG4gICAgc3RhdGljIHJlZ2lzdGVyVHlwZShuYW1lLCB0eXBlLCBjKSB7XG4gICAgICAgIHRoaXMuVFlQRVNfQVJSQVkucHVzaCh7IG5hbWUsIHR5cGUsIGNsYXNzOiBjIH0pO1xuICAgIH1cbn1cbkVsZW1lbnRUeXBlcy5FTVBUWSA9IHsgbmFtZTogXCJFTVBUWVwiLCB0eXBlOiBcIkVcIiwgY2xhc3M6IEVtcHR5RWxlbWVudCB9O1xuRWxlbWVudFR5cGVzLkRSRUcgPSB7IG5hbWU6IFwiRFJFR1wiLCB0eXBlOiBcIkRcIiwgY2xhc3M6IERSZWdFbGVtZW50IH07XG5FbGVtZW50VHlwZXMuUkVTID0geyBuYW1lOiBcIlJFU1wiLCB0eXBlOiBcIlJcIiwgY2xhc3M6IFJlc0VsZW1lbnQgfTtcbkVsZW1lbnRUeXBlcy5UWVBFU19BUlJBWSA9IFtFbGVtZW50VHlwZXMuRU1QVFksIEVsZW1lbnRUeXBlcy5EUkVHLCBFbGVtZW50VHlwZXMuUkVTXTtcbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIEVtcHR5RWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuRU1QVFkubmFtZSwgRWxlbWVudFR5cGVzLkVNUFRZLnR5cGUpO1xuICAgIH1cbiAgICBleGVjKGV3KSB7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuaW1wb3J0IHsgQXRvbSB9IGZyb20gXCIuLi9BdG9tXCI7XG5leHBvcnQgY2xhc3MgRFJlZ0VsZW1lbnQgZXh0ZW5kcyBFbGVtIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoRWxlbWVudFR5cGVzLkRSRUcubmFtZSwgRWxlbWVudFR5cGVzLkRSRUcudHlwZSk7XG4gICAgICAgIHRoaXMucFRPVEFMX0NIQU5DRSA9IDEwMDtcbiAgICAgICAgdGhpcy5wRFJFR19DUkVBVEUgPSAwLjE7XG4gICAgICAgIHRoaXMucFJFU19DUkVBVEUgPSAwLjU7XG4gICAgICAgIHRoaXMucERSRUdfREVTVFJPWSA9IDEwO1xuICAgICAgICB0aGlzLnBBTllfREVTVFJPWSA9IDE7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgLy9nZXQgYSByYW5kb20gTkVTVyBzaXRlXG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZVNpdGUgPSBldy5nZXRBZGphY2VudDRXYXkoKTtcbiAgICAgICAgLy9DUkVBVElPTlxuICAgICAgICBpZiAoYXZhaWxhYmxlU2l0ZS5hdG9tLnR5cGUgPT09IEVsZW1lbnRUeXBlcy5FTVBUWSkge1xuICAgICAgICAgICAgY29uc3QgY3JlYXRlRFJlZyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBEUkVHX0NSRUFURTtcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZVJlcyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBSRVNfQ1JFQVRFO1xuICAgICAgICAgICAgaWYgKGNyZWF0ZURSZWcpIHtcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVTaXRlLmF0b20gPSBuZXcgQXRvbShFbGVtZW50VHlwZXMuRFJFRyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEUkVHIENSRUFURURcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjcmVhdGVSZXMpIHtcbiAgICAgICAgICAgICAgICAvL21ha2UgcmVzXG4gICAgICAgICAgICAgICAgYXZhaWxhYmxlU2l0ZS5hdG9tID0gbmV3IEF0b20oRWxlbWVudFR5cGVzLlJFUyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSRVMgQ1JFQVRFRFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV3Lm9yaWdpbi5zd2FwQXRvbXMoYXZhaWxhYmxlU2l0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYXZhaWxhYmxlU2l0ZS5hdG9tLnR5cGUgPT09IEVsZW1lbnRUeXBlcy5EUkVHKSB7XG4gICAgICAgICAgICBjb25zdCBkZXN0cm95RFJlZyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBEUkVHX0RFU1RST1k7XG4gICAgICAgICAgICBpZiAoZGVzdHJveURSZWcpIHtcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVTaXRlLmF0b20gPSBuZXcgQXRvbShFbGVtZW50VHlwZXMuRU1QVFkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRFJFRyBERVNUUk9ZRURcIik7XG4gICAgICAgICAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vaXQncyBzb21ldGhpbmcgZWxzZVxuICAgICAgICAgICAgY29uc3QgZGVzdHJveUFueSA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBBTllfREVTVFJPWTtcbiAgICAgICAgICAgIGlmIChkZXN0cm95QW55KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYXZhaWxhYmxlU2l0ZS5hdG9tLnR5cGUubmFtZSArIFwiIERFU1RST1lFRFwiKTtcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVTaXRlLmF0b20gPSBuZXcgQXRvbShFbGVtZW50VHlwZXMuRU1QVFkpO1xuICAgICAgICAgICAgICAgIGV3Lm9yaWdpbi5zd2FwQXRvbXMoYXZhaWxhYmxlU2l0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIuZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRWxlbSB9IGZyb20gXCIuLi9FbGVtXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgUmVzRWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuUkVTLm5hbWUsIEVsZW1lbnRUeXBlcy5SRVMudHlwZSk7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhldy5nZXRSYW5kb20oRWxlbWVudFR5cGVzLkVNUFRZKSk7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi9FbGVtZW50VHlwZXNcIjtcbi8vRXZlbnQgd2luZG93IGFzIGRlc2NyaWJiZWQgaGVyZTogaHR0cDovL3JvYnVzdC5jcy51bm0uZWR1L2xpYi9leGUvZmV0Y2gucGhwP3c9MzAwJnRvaz00YzhmNDkmbWVkaWE9ZGV2OmV2ZW50LXdpbmRvdy0xMC5wbmdcbi8vQ29sbGVjdGlvbiBvZiBzaXRlcyB3aGljaCBjb250YWluIGF0b21zLCBidWlsdCBmcm9tIGFuIG9yaWdpbiAoY2VudGVyKSBzaXRlXG5leHBvcnQgY2xhc3MgRXZlbnRXaW5kb3cge1xuICAgIGNvbnN0cnVjdG9yKF90aWxlLCBfb3JpZ2luKSB7XG4gICAgICAgIHRoaXMudGlsZSA9IF90aWxlO1xuICAgICAgICB0aGlzLm1ha2VXaW5kb3coX3RpbGUsIF9vcmlnaW4pO1xuICAgIH1cbiAgICBtYWtlV2luZG93KHRpbGUsIG9yaWdpbikge1xuICAgICAgICB0aGlzLndpbmRvdyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5vcmlnaW4gPSB0aGlzLnRpbGUuZ2V0U2l0ZUJ5Q29vcmQob3JpZ2luKTtcbiAgICAgICAgLy9pZiB0aGUgb3JpZ2luIGlzIEVNUFRZIEVsZW1lbnQsIGxldCdzIHNhdmUgc29tZSBjeWNsZXMgKGdvb2QsIGJhZD8pXG4gICAgICAgIGlmICh0aGlzLm9yaWdpbi5hdG9tLnR5cGUgPT09IEVsZW1lbnRUeXBlcy5FTVBUWSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy53aW5kb3cuc2V0KHRoaXMub3JpZ2luLmlkLCB0aGlzLm9yaWdpbik7XG4gICAgICAgIGxldCB3aW5kb3dBcnJheSA9IEV2ZW50V2luZG93LldJTkRPV19PUkRFUl9PRkZTRVRTLm1hcCgob2Zmc2V0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5PZmZzZXRGcm9tT3JpZ2luKG9yaWdpbiwgb2Zmc2V0LnJvdywgb2Zmc2V0LmNvbCk7XG4gICAgICAgIH0pO1xuICAgICAgICB3aW5kb3dBcnJheS5mb3JFYWNoKCh0aWxlQ29vcmQpID0+IHtcbiAgICAgICAgICAgIGxldCBzaXRlID0gdGlsZS5nZXRTaXRlQnlDb29yZCh0aWxlQ29vcmQpO1xuICAgICAgICAgICAgaWYgKHNpdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy5zZXQoc2l0ZS5pZCwgc2l0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBPZmZzZXRGcm9tT3JpZ2luKG9yaWdpbiwgcm93T2Zmc2V0LCBjb2xPZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIHsgcm93OiBvcmlnaW4ucm93ICsgcm93T2Zmc2V0LCBjb2w6IG9yaWdpbi5jb2wgKyBjb2xPZmZzZXQgfTtcbiAgICB9XG4gICAgZ2V0UmFuZG9tKHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTaXRlRnJvbUNhbmRpZGF0ZXMoQXJyYXkuZnJvbSh0aGlzLndpbmRvdy52YWx1ZXMoKSksIHRydWUsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIGdldE5lYXJlc3Qoc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNpdGVGcm9tQ2FuZGlkYXRlcyhBcnJheS5mcm9tKHRoaXMud2luZG93LnZhbHVlcygpKSwgZmFsc2UsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIGdldEVhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19FQVNUKTtcbiAgICB9XG4gICAgZ2V0V2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1dFU1QpO1xuICAgIH1cbiAgICBnZXROb3J0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIKTtcbiAgICB9XG4gICAgZ2V0U291dGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19TT1VUSCk7XG4gICAgfVxuICAgIGdldE5vcnRoV2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIV0VTVCk7XG4gICAgfVxuICAgIGdldFNvdXRoV2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1NPVVRIV0VTVCk7XG4gICAgfVxuICAgIGdldE5vcnRoRWFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIRUFTVCk7XG4gICAgfVxuICAgIGdldFNvdXRoRWFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1NPVVRIRUFTVCk7XG4gICAgfVxuICAgIGdldEFkamFjZW50NFdheShyYW5kb21pemUgPSB0cnVlLCBzcGVjaWZpY1R5cGUgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2l0ZUZyb21DYW5kaWRhdGVzKFt0aGlzLmdldFdlc3QoKSwgdGhpcy5nZXROb3J0aCgpLCB0aGlzLmdldFNvdXRoKCksIHRoaXMuZ2V0RWFzdCgpXSwgcmFuZG9taXplLCBzcGVjaWZpY1R5cGUpO1xuICAgIH1cbiAgICBnZXRBZGphY2VudDhXYXkocmFuZG9taXplID0gdHJ1ZSwgc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNpdGVGcm9tQ2FuZGlkYXRlcyhbXG4gICAgICAgICAgICB0aGlzLmdldFdlc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0Tm9ydGgoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0U291dGgoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0RWFzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXROb3J0aFdlc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0U291dGhXZXN0KCksXG4gICAgICAgICAgICB0aGlzLmdldE5vcnRoRWFzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXRTb3V0aEVhc3QoKVxuICAgICAgICBdLCByYW5kb21pemUsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIC8vR2l2ZW4gYW4gYXJyYXkgb2YgY2FuZGlkYXRlIHNpdGVzIChzeW1tZXRyaWVzIGluIHRoZSBmdXR1cmUgSSBob3BlKSwgZ2l2ZSBtZSBiYWNrIG9uZSwgcmFuZG9tIGJ5IGRlZmF1bHQsIG5vdCBmaWx0ZXJlZCBieSB0eXBlIGJ5IGRlZmF1bHRcbiAgICBnZXRTaXRlRnJvbUNhbmRpZGF0ZXMoY2FuZGlkYXRlU2l0ZXMsIHJhbmRvbWl6ZSA9IHRydWUsIHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICBjYW5kaWRhdGVTaXRlcyA9IGNhbmRpZGF0ZVNpdGVzLmZpbHRlcihzaXRlID0+IHtcbiAgICAgICAgICAgIGlmICghc2l0ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNwZWNpZmljVHlwZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzaXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3BlY2lmaWNUeXBlICYmIHNpdGUuYXRvbS50eXBlID09PSBzcGVjaWZpY1R5cGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2l0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vbm8gc2l0ZXMhIHlpa2VzISBwb3NzaWJsZSE/ISBwcm9iYWJseSBvbmx5IHdoZW4gdXNpbmcgc3BlY2lmaWNUeXBlIGFuZCBsb29raW5nIGZvciBhIHJhcmUgZWxlbWVudFxuICAgICAgICBpZiAoY2FuZGlkYXRlU2l0ZXMubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICAvL3JldHVybiByYW5kb21cbiAgICAgICAgaWYgKHJhbmRvbWl6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZVNpdGVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNhbmRpZGF0ZVNpdGVzLmxlbmd0aCldO1xuICAgICAgICB9XG4gICAgICAgIC8vcmV0dXJuIGZpcnN0IG1hdGNoaW5nXG4gICAgICAgIHJldHVybiBjYW5kaWRhdGVTaXRlc1swXTtcbiAgICB9XG4gICAgZ2V0RGlyZWN0aW9uKGRpcmVjdGlvbikge1xuICAgICAgICBsZXQgc2l0ZSA9IHRoaXMudGlsZS5zaXRlcy5nZXQoTUZNVXRpbHMuQ3RvSUQodGhpcy5PZmZzZXRGcm9tT3JpZ2luKHRoaXMub3JpZ2luLnRpbGVQb3MsIGRpcmVjdGlvbi5yb3csIGRpcmVjdGlvbi5jb2wpKSk7XG4gICAgICAgIGlmIChzaXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gc2l0ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbn1cbkV2ZW50V2luZG93LldJTkRPV19PUkRFUl9PRkZTRVRTID0gW1xuICAgIHsgY29sOiAwLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogMSB9LFxuICAgIHsgY29sOiAxLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMSB9LFxuICAgIHsgY29sOiAxLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMCwgcm93OiAyIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMSwgcm93OiAtMiB9LFxuICAgIHsgY29sOiAxLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMiwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAyLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTMsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC0zIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogMyB9LFxuICAgIHsgY29sOiAzLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogLTIgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogMiB9LFxuICAgIHsgY29sOiAyLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogMiB9LFxuICAgIHsgY29sOiAtMywgcm93OiAtMSB9LFxuICAgIHsgY29sOiAtMywgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IC0zIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IDMgfSxcbiAgICB7IGNvbDogMSwgcm93OiAtMyB9LFxuICAgIHsgY29sOiAxLCByb3c6IDMgfSxcbiAgICB7IGNvbDogMywgcm93OiAtMSB9LFxuICAgIHsgY29sOiAzLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTQsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC00IH0sXG4gICAgeyBjb2w6IDAsIHJvdzogNCB9LFxuICAgIHsgY29sOiA0LCByb3c6IDAgfVxuXTtcbi8vYmVjYXVzZSwgbGF6eVxuRXZlbnRXaW5kb3cuRVdfV0VTVCA9IHsgY29sOiAtMSwgcm93OiAwIH07XG5FdmVudFdpbmRvdy5FV19FQVNUID0geyBjb2w6IDEsIHJvdzogMCB9O1xuRXZlbnRXaW5kb3cuRVdfTk9SVEggPSB7IGNvbDogMCwgcm93OiAtMSB9O1xuRXZlbnRXaW5kb3cuRVdfU09VVEggPSB7IGNvbDogMCwgcm93OiAxIH07XG5FdmVudFdpbmRvdy5FV19OT1JUSFdFU1QgPSB7IGNvbDogLTEsIHJvdzogLTEgfTtcbkV2ZW50V2luZG93LkVXX1NPVVRIV0VTVCA9IHsgY29sOiAtMSwgcm93OiAxIH07XG5FdmVudFdpbmRvdy5FV19OT1JUSEVBU1QgPSB7IGNvbDogMSwgcm93OiAtMSB9O1xuRXZlbnRXaW5kb3cuRVdfU09VVEhFQVNUID0geyBjb2w6IDEsIHJvdzogMSB9O1xuIiwiaW1wb3J0IHsgRXZlbnRXaW5kb3cgfSBmcm9tIFwiLi4vY2xhc3Nlcy9FdmVudHdpbmRvd1wiO1xuZXhwb3J0IGNsYXNzIE1GTVV0aWxzIHtcbiAgICBzdGF0aWMgQ3RvSUQoYykge1xuICAgICAgICByZXR1cm4gYCR7Yy5yb3d9OiR7Yy5jb2x9YDtcbiAgICB9XG4gICAgc3RhdGljIElEdG9DKGlkKSB7XG4gICAgICAgIGxldCByY2EgPSBpZC5zcGxpdChcIjpcIik7XG4gICAgICAgIHJldHVybiB7IHJvdzogcGFyc2VJbnQocmNhWzBdKSwgY29sOiBwYXJzZUludChyY2FbMV0pIH07XG4gICAgfVxuICAgIHN0YXRpYyBHZW5lcmF0ZUV2ZW50V2luZG93KHRpbGUsIHcsIGgpIHtcbiAgICAgICAgbGV0IHJjID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdyk7XG4gICAgICAgIGxldCByciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGgpO1xuICAgICAgICByZXR1cm4gbmV3IEV2ZW50V2luZG93KHRpbGUsIHsgcm93OiByciwgY29sOiByYyB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgQXRvbSB9IGZyb20gXCIuL0F0b21cIjtcbmV4cG9ydCBjbGFzcyBTaXRlIHtcbiAgICBjb25zdHJ1Y3RvcihfcG9zKSB7XG4gICAgICAgIHRoaXMudGlsZVBvcyA9IF9wb3M7XG4gICAgICAgIHRoaXMuaWQgPSBNRk1VdGlscy5DdG9JRCh0aGlzLnRpbGVQb3MpO1xuICAgICAgICB0aGlzLmNyZWF0ZSgpO1xuICAgIH1cbiAgICBzd2FwQXRvbXModGFyZ2V0U2l0ZSkge1xuICAgICAgICBpZiAodGFyZ2V0U2l0ZSlcbiAgICAgICAgICAgIFt0aGlzLmF0b20sIHRhcmdldFNpdGUuYXRvbV0gPSBbdGFyZ2V0U2l0ZS5hdG9tLCB0aGlzLmF0b21dO1xuICAgIH1cbiAgICBjcmVhdGUoKSB7XG4gICAgICAgIHRoaXMuYXRvbSA9IG5ldyBBdG9tKCk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVGlsZSB9IGZyb20gXCIuL21mbS9jbGFzc2VzL1RpbGVcIjtcbmltcG9ydCB7IEVsZW1lbnRUeXBlcyB9IGZyb20gXCIuL21mbS9jbGFzc2VzL0VsZW1lbnRUeXBlc1wiO1xuaW1wb3J0IHsgTUZNVXRpbHMgfSBmcm9tIFwiLi9tZm0vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IEF0b20gfSBmcm9tIFwiLi9tZm0vY2xhc3Nlcy9BdG9tXCI7XG5sZXQgZyA9IG5ldyBUaWxlKDMyLCAzMik7XG52YXIgc2tldGNoID0gKHApID0+IHtcbiAgICBsZXQgc2l0ZVNpemUgPSAxNDtcbiAgICBsZXQgZ3JpZE9mZnNldCA9IDI1O1xuICAgIHAucHJlbG9hZCA9ICgpID0+IHsgfTtcbiAgICBwLnNldHVwID0gKCkgPT4ge1xuICAgICAgICBwLmNyZWF0ZUNhbnZhcyg3MDAsIDcwMCk7XG4gICAgfTtcbiAgICAvLyAgIHAud2luZG93UmVzaXplZCA9ICgpID0+IHtcbiAgICAvLyAgICAgcC5yZXNpemVDYW52YXMocC53aW5kb3dXaWR0aCAtIDUwLCBwLndpbmRvd0hlaWdodCAtIDUwKTtcbiAgICAvLyAgIH07XG4gICAgbGV0IGRyYXdHcmlkID0gKHAsIHQpID0+IHtcbiAgICAgICAgcC5wdXNoKCk7XG4gICAgICAgIHAudHJhbnNsYXRlKGdyaWRPZmZzZXQsIGdyaWRPZmZzZXQpO1xuICAgICAgICB0LnNpdGVzLmZvckVhY2goKHNpdGUpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoc2l0ZS5hdG9tLmVsZW0udHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgRWxlbWVudFR5cGVzLkVNUFRZLnR5cGU6XG4gICAgICAgICAgICAgICAgICAgIHAuc3Ryb2tlKDAsIDAsIDAsIDApO1xuICAgICAgICAgICAgICAgICAgICBwLmZpbGwoMzIsIDMyLCAzMiwgMTI3KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBFbGVtZW50VHlwZXMuRFJFRy50eXBlOlxuICAgICAgICAgICAgICAgICAgICBwLnN0cm9rZSgwLCAwLCAwLCAxMjcpO1xuICAgICAgICAgICAgICAgICAgICBwLmZpbGwoMjU1LCAzMiwgMzIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIEVsZW1lbnRUeXBlcy5SRVMudHlwZTpcbiAgICAgICAgICAgICAgICAgICAgcC5zdHJva2UoMCwgMCwgMCwgMTI3KTtcbiAgICAgICAgICAgICAgICAgICAgcC5maWxsKDMyLCAyNTUsIDY0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwLmVsbGlwc2Uoc2l0ZS50aWxlUG9zLmNvbCAqIHNpdGVTaXplLCBzaXRlLnRpbGVQb3Mucm93ICogc2l0ZVNpemUsIHNpdGVTaXplLCBzaXRlU2l6ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBwLnBvcCgpO1xuICAgIH07XG4gICAgbGV0IHJ1biA9ICgpID0+IHtcbiAgICAgICAgbGV0IHNwZWVkID0gMTAwMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGVlZDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgZXcgPSBNRk1VdGlscy5HZW5lcmF0ZUV2ZW50V2luZG93KGcsIGcud2lkdGgsIGcuaGVpZ2h0KTtcbiAgICAgICAgICAgIGV3Lm9yaWdpbi5hdG9tLmV4ZWMoZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBsZXQgZ2V0U2l0ZUZyb21DYW52YXNYWSA9ICh4LCB5KSA9PiB7XG4gICAgICAgIHggPSB4IC0gZ3JpZE9mZnNldCArIHNpdGVTaXplICogMC41O1xuICAgICAgICB5ID0geSAtIGdyaWRPZmZzZXQgKyBzaXRlU2l6ZSAqIDAuNTtcbiAgICAgICAgeCA9IE1hdGguZmxvb3IoeCAvIHNpdGVTaXplKTtcbiAgICAgICAgeSA9IE1hdGguZmxvb3IoeSAvIHNpdGVTaXplKTtcbiAgICAgICAgcmV0dXJuIGcuZ2V0U2l0ZUJ5Q29vcmQoeyByb3c6IHksIGNvbDogeCB9KTtcbiAgICB9O1xuICAgIHAuZHJhdyA9ICgpID0+IHtcbiAgICAgICAgcC5iYWNrZ3JvdW5kKDEwMCk7XG4gICAgICAgIGRyYXdHcmlkKHAsIGcpO1xuICAgICAgICBydW4oKTtcbiAgICB9O1xuICAgIHAubW91c2VDbGlja2VkID0gKCkgPT4ge1xuICAgICAgICBsZXQgc2l0ZSA9IGdldFNpdGVGcm9tQ2FudmFzWFkocC5tb3VzZVgsIHAubW91c2VZKTtcbiAgICAgICAgaWYgKHNpdGUpXG4gICAgICAgICAgICBzaXRlLmF0b20gPSBuZXcgQXRvbShFbGVtZW50VHlwZXMuRFJFRyk7XG4gICAgfTtcbn07XG5sZXQgc2tldGNoUCA9IG5ldyBwNShza2V0Y2gpO1xuIiwiaW1wb3J0IHsgU2l0ZSB9IGZyb20gXCIuL1NpdGVcIjtcbmltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5leHBvcnQgY2xhc3MgVGlsZSB7XG4gICAgY29uc3RydWN0b3IoX3dpZHRoID0gMSwgX2hlaWdodCA9IDEpIHtcbiAgICAgICAgdGhpcy53aWR0aCA9IF93aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBfaGVpZ2h0O1xuICAgICAgICB0aGlzLmNyZWF0ZSgpO1xuICAgIH1cbiAgICBnZXRTaXRlQnlDb29yZChjKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNpdGVzLmdldChNRk1VdGlscy5DdG9JRChjKSk7XG4gICAgfVxuICAgIGdldFJhbmRvbVNpdGUoKSB7XG4gICAgICAgIGxldCByciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuaGVpZ2h0KTtcbiAgICAgICAgbGV0IHJjID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy53aWR0aCk7XG4gICAgICAgIHJldHVybiB0aGlzLnNpdGVzLmdldChgJHtycn06JHtyY31gKTtcbiAgICB9XG4gICAgY3JlYXRlKCkge1xuICAgICAgICB0aGlzLnNpdGVzID0gbmV3IE1hcCgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMud2lkdGg7IGkrKykge1xuICAgICAgICAgICAgLy9hY3Jvc3MgY29sdW1uc1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmhlaWdodDsgaisrKSB7XG4gICAgICAgICAgICAgICAgLy9kb3duIHJvd3NcbiAgICAgICAgICAgICAgICB0aGlzLnNpdGVzLnNldChgJHtqfToke2l9YCwgbmV3IFNpdGUoeyByb3c6IGosIGNvbDogaSB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9