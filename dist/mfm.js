!function(t){var e={};function o(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(r,s,function(e){return t[e]}.bind(null,s));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);class r{constructor(t,e){this.tile=t,this.makeWindow(t,e)}makeWindow(t,e){this.window=new Map,this.origin=this.tile.getSiteByCoord(e),this.window.set(s.CtoID(e),this.origin),r.WINDOW_ORDER_OFFSETS.map(t=>this.OffsetFromOrigin(e,t.row,t.col)).forEach(e=>{t.getSiteByCoord(e)&&this.window.set(s.CtoID(e),t.getSiteByCoord(e))})}OffsetFromOrigin(t,e,o){return{row:t.row+e,col:t.col+o}}getRandom(t){let e;if(0!==(e=t?Array.from(this.window.values()).filter(e=>{if(e.atom&&e.atom.elem.type===t.type)return e}):Array.from(this.window.values())).length)return e[Math.floor(Math.random()*e.length)]}getAdjacent(t){if(t){const e=(t,e)=>{if(t&&t.atom&&t.atom.type==e)return t};let o=this.getWest();if(e(o,t))return o;if(e(o=this.getNorth(),t))return o;if(e(o=this.getSouth(),t))return o;if(e(o=this.getEast(),t))return o;if(e(o=this.getNorthWest(),t))return o;if(e(o=this.getSouthWest(),t))return o;if(e(o=this.getNorthEast(),t))return o;if(e(o=this.getSouthEast(),t))return o}else{if(this.getWest())return this.getWest();if(this.getNorth())return this.getNorth();if(this.getSouth())return this.getSouth();if(this.getEast())return this.getEast();if(this.getNorthWest())return this.getNorthWest();if(this.getSouthWest())return this.getSouthWest();if(this.getNorthEast())return this.getNorthEast();if(this.getSouthEast())return this.getSouthEast()}}getEast(){return this.getDirection(r.EW_EAST)}getWest(){return this.getDirection(r.EW_WEST)}getNorth(){return this.getDirection(r.EW_NORTH)}getSouth(){return this.getDirection(r.EW_SOUTH)}getNorthWest(){return this.getDirection(r.EW_NORTHWEST)}getSouthWest(){return this.getDirection(r.EW_SOUTHWEST)}getNorthEast(){return this.getDirection(r.EW_NORTHEAST)}getSouthEast(){return this.getDirection(r.EW_SOUTHEAST)}getDirection(t){let e=this.tile.sites.get(s.CtoID(this.OffsetFromOrigin(this.origin.tilePos,t.row,t.col)));if(e)return e}}r.WINDOW_ORDER_OFFSETS=[{col:0,row:0},{col:-1,row:0},{col:0,row:-1},{col:0,row:1},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1},{col:-2,row:0},{col:0,row:-1},{col:0,row:2},{col:2,row:0},{col:-2,row:-1},{col:-2,row:1},{col:-1,row:-2},{col:-1,row:2},{col:1,row:-2},{col:1,row:2},{col:2,row:-1},{col:2,row:1},{col:-3,row:0},{col:0,row:-3},{col:0,row:3},{col:3,row:0},{col:-2,row:-2},{col:-2,row:2},{col:2,row:-2},{col:2,row:2},{col:-3,row:-1},{col:-3,row:1},{col:-1,row:-3},{col:-1,row:3},{col:1,row:-3},{col:1,row:3},{col:3,row:-1},{col:3,row:1},{col:-4,row:0},{col:0,row:-4},{col:0,row:4},{col:4,row:0}],r.EW_WEST={col:-1,row:0},r.EW_EAST={col:1,row:0},r.EW_NORTH={col:0,row:-1},r.EW_SOUTH={col:0,row:1},r.EW_NORTHWEST={col:-1,row:-1},r.EW_SOUTHWEST={col:-1,row:1},r.EW_NORTHEAST={col:1,row:-1},r.EW_SOUTHEAST={col:1,row:1};class s{static CtoID(t){return`${t.row}:${t.col}`}static IDtoC(t){let e=t.split(":");return{row:parseInt(e[0]),col:parseInt(e[1])}}static GenerateEventWindow(t,e,o){let s=Math.floor(Math.random()*e),i=Math.floor(Math.random()*o);return new r(t,{row:i,col:s})}}class i{constructor(t,e,o=!0,r=!0,s=0){this.name=t,this.type=e,this.data=s,this.moveable=o,this.killable=r}set data(t){this._data=t}get data(){return this._data}set name(t){this._name=t}get name(){return this._name}set type(t){this._type=t}get type(){return this._type}set moveable(t){this._moveable=t}get moveable(){return this._moveable}set killable(t){this._killable=t}get killable(){return this._killable}exec(t){}}class n extends i{constructor(){super(h.EMPTY.name,h.EMPTY.type)}exec(t){super.exec(t)}}class a extends i{constructor(){super(h.RES.name,h.RES.type)}exec(t){super.exec(t)}}class l extends i{constructor(){super(h.DREG.name,h.DREG.type),this.pTOTAL_CHANCE=100,this.pDREG_CREATE=.1,this.pRES_CREATE=.5,this.pDREG_DESTROY=10,this.pANY_DESTROY=1}exec(t){const e=Math.random()*this.pTOTAL_CHANCE<this.pDREG_CREATE,o=Math.random()*this.pTOTAL_CHANCE<this.pRES_CREATE,r=Math.random()*this.pTOTAL_CHANCE<this.pDREG_DESTROY,s=Math.random()*this.pTOTAL_CHANCE<this.pANY_DESTROY,i=t.getRandom();switch(e?(i.atom.elem=new l,console.log("DREG CREATED",i)):o?i.atom.type===h.EMPTY&&(i.atom.elem=new a,console.log("RES CREATED",i)):r?i.atom.type===h.DREG&&(i.atom.elem=new n,console.log("DREG DESTROYED",i)):s&&(i.atom.elem=new n,console.log("ANY DESTROYED",i)),Math.floor(8*Math.random())){case 0:t.getWest()&&t.origin.swapAtoms(t.getWest());break;case 1:t.getEast()&&t.origin.swapAtoms(t.getEast());break;case 2:t.getNorth()&&t.origin.swapAtoms(t.getNorth());break;case 3:t.getSouth()&&t.origin.swapAtoms(t.getSouth())}Math.random();super.exec(t)}}class h{static registerType(t,e,o){this.TYPES_ARRAY.push({name:t,type:e,class:o})}}h.EMPTY={name:"EMPTY",type:"E",class:n},h.DREG={name:"DREG",type:"D",class:l},h.RES={name:"RES",type:"R",class:a},h.TYPES_ARRAY=[h.EMPTY,h.DREG,h.RES];class c{constructor(t=h.EMPTY){this.type=t,this.elem=new this.type.class}exec(t){this.elem.exec(t)}}class u{constructor(t){this.tilePos=t,this.id=s.CtoID(this.tilePos),this.create()}swapAtoms(t){let e=this.atom;this.atom=t.atom,t.atom=e}create(){this.atom=new c}}let E=new class{constructor(t=1,e=1){this.width=t,this.height=e,this.create()}getSiteByCoord(t){return this.sites.get(s.CtoID(t))}getRandomSite(){let t=Math.floor(Math.random()*this.height),e=Math.floor(Math.random()*this.width);return this.sites.get(`${t}:${e}`)}create(){this.sites=new Map;for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)this.sites.set(`${e}:${t}`,new u({row:e,col:t}))}}(30,30);console.log(E),console.log(E.getRandomSite()),E.getRandomSite().atom.elem=new l,E.getRandomSite().atom.elem=new l,E.getRandomSite().atom.elem=new l,E.getRandomSite().atom.elem=new l;new p5(t=>{t.preload=(()=>{}),t.setup=(()=>{t.createCanvas(800,800)});t.draw=(()=>{t.background(100),((t,e)=>{t.push(),t.translate(50,50),e.sites.forEach(e=>{switch(e.atom.elem.type){case h.EMPTY.type:t.fill(32);break;case h.DREG.type:t.fill(255,32,32);break;case h.RES.type:t.fill(32,255,64)}t.stroke(0),t.ellipse(12*e.tilePos.col,12*e.tilePos.row,12,12)}),t.pop()})(t,E),(()=>{for(var t=0;t<1500;t++){let t=s.GenerateEventWindow(E,E.width,E.height);t.origin.atom.exec(t)}})()})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0V2ZW50d2luZG93LnRzIiwid2VicGFjazovLy8uL3NyYy9tZm0vdXRpbHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW0udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL2VsZW1lbnRzL0VtcHR5RWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvUmVzRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvRFJlZ0VsZW1lbnQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW1lbnRUeXBlcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvQXRvbS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvU2l0ZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL1RpbGUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJFdmVudHdpbmRvd19FdmVudFdpbmRvdyIsIltvYmplY3QgT2JqZWN0XSIsIl90aWxlIiwiX29yaWdpbiIsInRoaXMiLCJ0aWxlIiwibWFrZVdpbmRvdyIsIm9yaWdpbiIsIndpbmRvdyIsIk1hcCIsImdldFNpdGVCeUNvb3JkIiwic2V0IiwidXRpbHNfTUZNVXRpbHMiLCJDdG9JRCIsIldJTkRPV19PUkRFUl9PRkZTRVRTIiwibWFwIiwib2Zmc2V0IiwiT2Zmc2V0RnJvbU9yaWdpbiIsInJvdyIsImNvbCIsImZvckVhY2giLCJ0aWxlQ29vcmQiLCJyb3dPZmZzZXQiLCJjb2xPZmZzZXQiLCJzcGVjaWZpY1R5cGUiLCJpdGVtcyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImZpbHRlciIsInNpdGUiLCJhdG9tIiwiZWxlbSIsInR5cGUiLCJsZW5ndGgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJjaGVjayIsImdldFdlc3QiLCJnZXROb3J0aCIsImdldFNvdXRoIiwiZ2V0RWFzdCIsImdldE5vcnRoV2VzdCIsImdldFNvdXRoV2VzdCIsImdldE5vcnRoRWFzdCIsImdldFNvdXRoRWFzdCIsImdldERpcmVjdGlvbiIsIkVXX0VBU1QiLCJFV19XRVNUIiwiRVdfTk9SVEgiLCJFV19TT1VUSCIsIkVXX05PUlRIV0VTVCIsIkVXX1NPVVRIV0VTVCIsIkVXX05PUlRIRUFTVCIsIkVXX1NPVVRIRUFTVCIsImRpcmVjdGlvbiIsInNpdGVzIiwidGlsZVBvcyIsImlkIiwicmNhIiwic3BsaXQiLCJwYXJzZUludCIsInciLCJoIiwicmMiLCJyciIsIkVsZW0iLCJfbmFtZSIsIl90eXBlIiwiX21vdmVhYmxlIiwiX2tpbGxhYmxlIiwiX2RhdGEiLCJkYXRhIiwibW92ZWFibGUiLCJraWxsYWJsZSIsImsiLCJldyIsIkVtcHR5RWxlbWVudF9FbXB0eUVsZW1lbnQiLCJzdXBlciIsIkVsZW1lbnRUeXBlcyIsIkVNUFRZIiwiZXhlYyIsIlJlc0VsZW1lbnRfUmVzRWxlbWVudCIsIlJFUyIsIkRSZWdFbGVtZW50X0RSZWdFbGVtZW50IiwiRFJFRyIsInBUT1RBTF9DSEFOQ0UiLCJwRFJFR19DUkVBVEUiLCJwUkVTX0NSRUFURSIsInBEUkVHX0RFU1RST1kiLCJwQU5ZX0RFU1RST1kiLCJjcmVhdGVEUmVnIiwiY3JlYXRlUmVzIiwiZGVzdHJveURSZWciLCJkZXN0cm95QW55IiwiYXZhaWxhYmxlU2l0ZSIsImdldFJhbmRvbSIsImNvbnNvbGUiLCJsb2ciLCJzd2FwQXRvbXMiLCJUWVBFU19BUlJBWSIsInB1c2giLCJjbGFzcyIsIkF0b21fQXRvbSIsIlNpdGVfU2l0ZSIsIl9wb3MiLCJ0YXJnZXRTaXRlIiwidGVtcCIsImciLCJfd2lkdGgiLCJfaGVpZ2h0Iiwid2lkdGgiLCJoZWlnaHQiLCJqIiwiZ2V0UmFuZG9tU2l0ZSIsInA1IiwicHJlbG9hZCIsInNldHVwIiwiY3JlYXRlQ2FudmFzIiwiZHJhdyIsImJhY2tncm91bmQiLCJ0cmFuc2xhdGUiLCJmaWxsIiwic3Ryb2tlIiwiZWxsaXBzZSIsInBvcCIsImRyYXdHcmlkIiwiR2VuZXJhdGVFdmVudFdpbmRvdyIsInJ1biJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxhQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFILEVBQ0EsSUFBQUksRUFBQVgsT0FBQVksT0FBQSxNQUdBLEdBRkExQixFQUFBa0IsRUFBQU8sR0FDQVgsT0FBQUMsZUFBQVUsRUFBQSxXQUF5Q1QsWUFBQSxFQUFBSyxVQUN6QyxFQUFBRSxHQUFBLGlCQUFBRixFQUFBLFFBQUFNLEtBQUFOLEVBQUFyQixFQUFBVSxFQUFBZSxFQUFBRSxFQUFBLFNBQUFBLEdBQWdILE9BQUFOLEVBQUFNLElBQXFCQyxLQUFBLEtBQUFELElBQ3JJLE9BQUFGLEdBSUF6QixFQUFBNkIsRUFBQSxTQUFBMUIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBcUIsV0FDQSxXQUEyQixPQUFBckIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQWlCLEVBQUFDLEdBQXNELE9BQUFqQixPQUFBa0IsVUFBQUMsZUFBQTFCLEtBQUF1QixFQUFBQyxJQUd0RC9CLEVBQUFrQyxFQUFBLEdBSUFsQyxJQUFBbUMsRUFBQSwrQ0MvRWFDLEVBQ2JDLFlBQUFDLEVBQUFDLEdBQ0FDLEtBQUFDLEtBQUFILEVBQ0FFLEtBQUFFLFdBQUFKLEVBQUFDLEdBRUFGLFdBQUFJLEVBQUFFLEdBQ0FILEtBQUFJLE9BQUEsSUFBQUMsSUFDQUwsS0FBQUcsT0FBQUgsS0FBQUMsS0FBQUssZUFBQUgsR0FDQUgsS0FBQUksT0FBQUcsSUFBd0JDLEVBQVFDLE1BQUFOLEdBQUFILEtBQUFHLFFBQ05QLEVBQVdjLHFCQUFBQyxJQUFBQyxHQUNyQ1osS0FBQWEsaUJBQUFWLEVBQUFTLEVBQUFFLElBQUFGLEVBQUFHLE1BRUFDLFFBQUFDLElBQ0FoQixFQUFBSyxlQUFBVyxJQUNBakIsS0FBQUksT0FBQUcsSUFBZ0NDLEVBQVFDLE1BQUFRLEdBQUFoQixFQUFBSyxlQUFBVyxNQUl4Q3BCLGlCQUFBTSxFQUFBZSxFQUFBQyxHQUNBLE9BQWdCTCxJQUFBWCxFQUFBVyxJQUFBSSxFQUFBSCxJQUFBWixFQUFBWSxJQUFBSSxHQUVoQnRCLFVBQUF1QixHQUNBLElBQUFDLEVBV0EsUUFOQUEsRUFKQUQsRUFJQUUsTUFBQUMsS0FBQXZCLEtBQUFJLE9BQUFvQixVQUFBQyxPQUFBQyxJQUNBLEdBQUFBLEVBQUFDLE1BQUFELEVBQUFDLEtBQUFDLEtBQUFDLE9BQUFULEVBQUFTLEtBQ0EsT0FBQUgsSUFMQUosTUFBQUMsS0FBQXZCLEtBQUFJLE9BQUFvQixXQVNBTSxPQUlBLE9BQUFULEVBREFVLEtBQUFDLE1BQUFELEtBQUFFLFNBQUFaLEVBQUFTLFNBSUFqQyxZQUFBdUIsR0FDQSxHQUFBQSxFQWtCQSxDQUNBLE1BQUFjLEVBQUEsQ0FBQXZDLEVBQUF5QixLQUNBLEdBQUF6QixLQUFBZ0MsTUFBQWhDLEVBQUFnQyxLQUFBRSxNQUFBVCxFQUNBLE9BQUF6QixHQUlBLElBQUFBLEVBQUFLLEtBQUFtQyxVQUNBLEdBQUFELEVBQUF2QyxFQUFBeUIsR0FDQSxPQUFBekIsRUFHQSxHQUFBdUMsRUFEQXZDLEVBQUFLLEtBQUFvQyxXQUNBaEIsR0FDQSxPQUFBekIsRUFHQSxHQUFBdUMsRUFEQXZDLEVBQUFLLEtBQUFxQyxXQUNBakIsR0FDQSxPQUFBekIsRUFHQSxHQUFBdUMsRUFEQXZDLEVBQUFLLEtBQUFzQyxVQUNBbEIsR0FDQSxPQUFBekIsRUFHQSxHQUFBdUMsRUFEQXZDLEVBQUFLLEtBQUF1QyxlQUNBbkIsR0FDQSxPQUFBekIsRUFHQSxHQUFBdUMsRUFEQXZDLEVBQUFLLEtBQUF3QyxlQUNBcEIsR0FDQSxPQUFBekIsRUFHQSxHQUFBdUMsRUFEQXZDLEVBQUFLLEtBQUF5QyxlQUNBckIsR0FDQSxPQUFBekIsRUFHQSxHQUFBdUMsRUFEQXZDLEVBQUFLLEtBQUEwQyxlQUNBdEIsR0FDQSxPQUFBekIsTUF2REEsQ0FDQSxHQUFBSyxLQUFBbUMsVUFDQSxPQUFBbkMsS0FBQW1DLFVBQ0EsR0FBQW5DLEtBQUFvQyxXQUNBLE9BQUFwQyxLQUFBb0MsV0FDQSxHQUFBcEMsS0FBQXFDLFdBQ0EsT0FBQXJDLEtBQUFxQyxXQUNBLEdBQUFyQyxLQUFBc0MsVUFDQSxPQUFBdEMsS0FBQXNDLFVBQ0EsR0FBQXRDLEtBQUF1QyxlQUNBLE9BQUF2QyxLQUFBdUMsZUFDQSxHQUFBdkMsS0FBQXdDLGVBQ0EsT0FBQXhDLEtBQUF3QyxlQUNBLEdBQUF4QyxLQUFBeUMsZUFDQSxPQUFBekMsS0FBQXlDLGVBQ0EsR0FBQXpDLEtBQUEwQyxlQUNBLE9BQUExQyxLQUFBMEMsZ0JBNENBN0MsVUFDQSxPQUFBRyxLQUFBMkMsYUFBaUMvQyxFQUFXZ0QsU0FFNUMvQyxVQUNBLE9BQUFHLEtBQUEyQyxhQUFpQy9DLEVBQVdpRCxTQUU1Q2hELFdBQ0EsT0FBQUcsS0FBQTJDLGFBQWlDL0MsRUFBV2tELFVBRTVDakQsV0FDQSxPQUFBRyxLQUFBMkMsYUFBaUMvQyxFQUFXbUQsVUFFNUNsRCxlQUNBLE9BQUFHLEtBQUEyQyxhQUFpQy9DLEVBQVdvRCxjQUU1Q25ELGVBQ0EsT0FBQUcsS0FBQTJDLGFBQWlDL0MsRUFBV3FELGNBRTVDcEQsZUFDQSxPQUFBRyxLQUFBMkMsYUFBaUMvQyxFQUFXc0QsY0FFNUNyRCxlQUNBLE9BQUFHLEtBQUEyQyxhQUFpQy9DLEVBQVd1RCxjQUU1Q3RELGFBQUF1RCxHQUNBLElBQUExQixFQUFBMUIsS0FBQUMsS0FBQW9ELE1BQUE1RSxJQUF1QytCLEVBQVFDLE1BQUFULEtBQUFhLGlCQUFBYixLQUFBRyxPQUFBbUQsUUFBQUYsRUFBQXRDLElBQUFzQyxFQUFBckMsT0FDL0MsR0FBQVcsRUFDQSxPQUFBQSxHQUtBOUIsRUFBV2MsdUJBQ05LLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxLQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELEtBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsS0FBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELEtBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxLQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELEtBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFHTGxCLEVBQVdpRCxTQUFZOUIsS0FBQSxFQUFBRCxJQUFBLEdBQ3ZCbEIsRUFBV2dELFNBQVk3QixJQUFBLEVBQUFELElBQUEsR0FDdkJsQixFQUFXa0QsVUFBYS9CLElBQUEsRUFBQUQsS0FBQSxHQUN4QmxCLEVBQVdtRCxVQUFhaEMsSUFBQSxFQUFBRCxJQUFBLEdBQ3hCbEIsRUFBV29ELGNBQWlCakMsS0FBQSxFQUFBRCxLQUFBLEdBQzVCbEIsRUFBV3FELGNBQWlCbEMsS0FBQSxFQUFBRCxJQUFBLEdBQzVCbEIsRUFBV3NELGNBQWlCbkMsSUFBQSxFQUFBRCxLQUFBLEdBQzVCbEIsRUFBV3VELGNBQWlCcEMsSUFBQSxFQUFBRCxJQUFBLFNDMUxmTixFQUNiWCxhQUFBNUIsR0FDQSxTQUFrQkEsRUFBQTZDLE9BQVM3QyxFQUFBOEMsTUFFM0JsQixhQUFBMEQsR0FDQSxJQUFBQyxFQUFBRCxFQUFBRSxNQUFBLEtBQ0EsT0FBZ0IzQyxJQUFBNEMsU0FBQUYsRUFBQSxJQUFBekMsSUFBQTJDLFNBQUFGLEVBQUEsS0FFaEIzRCwyQkFBQUksRUFBQTBELEVBQUFDLEdBQ0EsSUFBQUMsRUFBQTlCLEtBQUFDLE1BQUFELEtBQUFFLFNBQUEwQixHQUNBRyxFQUFBL0IsS0FBQUMsTUFBQUQsS0FBQUUsU0FBQTJCLEdBQ0EsV0FBbUJoRSxFQUFXSyxHQUFRYSxJQUFBZ0QsRUFBQS9DLElBQUE4QyxXQ1ovQkUsRUFDUGxFLFlBQUFtRSxFQUFBQyxFQUFBQyxHQUFBLEVBQUFDLEdBQUEsRUFBQUMsRUFBQSxHQUNBcEUsS0FBQTdCLEtBQUE2RixFQUNBaEUsS0FBQTZCLEtBQUFvQyxFQUNBakUsS0FBQXFFLEtBQUFELEVBQ0FwRSxLQUFBc0UsU0FBQUosRUFDQWxFLEtBQUF1RSxTQUFBSixFQUVBRSxTQUFBbkcsR0FDQThCLEtBQUFvRSxNQUFBbEcsRUFFQW1HLFdBQ0EsT0FBQXJFLEtBQUFvRSxNQUVBakcsU0FBQWtCLEdBQ0FXLEtBQUFnRSxNQUFBM0UsRUFFQWxCLFdBQ0EsT0FBQTZCLEtBQUFnRSxNQUVBbkMsU0FBQS9DLEdBQ0FrQixLQUFBaUUsTUFBQW5GLEVBRUErQyxXQUNBLE9BQUE3QixLQUFBaUUsTUFFQUssYUFBQXRHLEdBQ0FnQyxLQUFBa0UsVUFBQWxHLEVBRUFzRyxlQUNBLE9BQUF0RSxLQUFBa0UsVUFFQUssYUFBQUMsR0FDQXhFLEtBQUFtRSxVQUFBSyxFQUVBRCxlQUNBLE9BQUF2RSxLQUFBbUUsVUFFQXRFLEtBQUE0RSxXQ3BDYUMsVUFBcUJYLEVBQ2xDbEUsY0FDQThFLE1BQWNDLEVBQVlDLE1BQUExRyxLQUFheUcsRUFBWUMsTUFBQWhELE1BRW5EaEMsS0FBQTRFLEdBQ0FFLE1BQUFHLEtBQUFMLFVDTGFNLFVBQW1CaEIsRUFDaENsRSxjQUNBOEUsTUFBY0MsRUFBWUksSUFBQTdHLEtBQVd5RyxFQUFZSSxJQUFBbkQsTUFFakRoQyxLQUFBNEUsR0FDQUUsTUFBQUcsS0FBQUwsVUNIYVEsVUFBb0JsQixFQUNqQ2xFLGNBQ0E4RSxNQUFjQyxFQUFZTSxLQUFBL0csS0FBWXlHLEVBQVlNLEtBQUFyRCxNQUNsRDdCLEtBQUFtRixjQUFBLElBQ0FuRixLQUFBb0YsYUFBQSxHQUNBcEYsS0FBQXFGLFlBQUEsR0FDQXJGLEtBQUFzRixjQUFBLEdBQ0F0RixLQUFBdUYsYUFBQSxFQUVBMUYsS0FBQTRFLEdBQ0EsTUFBQWUsRUFBQXpELEtBQUFFLFNBQUFqQyxLQUFBbUYsY0FBQW5GLEtBQUFvRixhQUNBSyxFQUFBMUQsS0FBQUUsU0FBQWpDLEtBQUFtRixjQUFBbkYsS0FBQXFGLFlBQ0FLLEVBQUEzRCxLQUFBRSxTQUFBakMsS0FBQW1GLGNBQUFuRixLQUFBc0YsY0FDQUssRUFBQTVELEtBQUFFLFNBQUFqQyxLQUFBbUYsY0FBQW5GLEtBQUF1RixhQUNBSyxFQUFBbkIsRUFBQW9CLFlBd0JBLE9BdkJBTCxHQUNBSSxFQUFBakUsS0FBQUMsS0FBQSxJQUEwQ3FELEVBQzFDYSxRQUFBQyxJQUFBLGVBQUFILElBRUFILEVBRUFHLEVBQUFqRSxLQUFBRSxPQUE0QytDLEVBQVlDLFFBQ3hEZSxFQUFBakUsS0FBQUMsS0FBQSxJQUE4Q21ELEVBQzlDZSxRQUFBQyxJQUFBLGNBQUFILElBR0FGLEVBQ0FFLEVBQUFqRSxLQUFBRSxPQUE0QytDLEVBQVlNLE9BQ3hEVSxFQUFBakUsS0FBQUMsS0FBQSxJQUE4QzhDLEVBQzlDb0IsUUFBQUMsSUFBQSxpQkFBQUgsSUFHQUQsSUFDQUMsRUFBQWpFLEtBQUFDLEtBQUEsSUFBMEM4QyxFQUMxQ29CLFFBQUFDLElBQUEsZ0JBQUFILElBR0E3RCxLQUFBQyxNQUFBLEVBQUFELEtBQUFFLFdBRUEsT0FDQXdDLEVBQUF0QyxXQUNBc0MsRUFBQXRFLE9BQUE2RixVQUFBdkIsRUFBQXRDLFdBRUEsTUFDQSxPQUNBc0MsRUFBQW5DLFdBQ0FtQyxFQUFBdEUsT0FBQTZGLFVBQUF2QixFQUFBbkMsV0FFQSxNQUNBLE9BQ0FtQyxFQUFBckMsWUFDQXFDLEVBQUF0RSxPQUFBNkYsVUFBQXZCLEVBQUFyQyxZQUVBLE1BQ0EsT0FDQXFDLEVBQUFwQyxZQUNBb0MsRUFBQXRFLE9BQUE2RixVQUFBdkIsRUFBQXBDLFlBSUFOLEtBQUFFLFNBZUEwQyxNQUFBRyxLQUFBTCxVQzVFT0csRUFDUC9FLG9CQUFBMUIsRUFBQTBELEVBQUE1RCxHQUNBK0IsS0FBQWlHLFlBQUFDLE1BQStCL0gsT0FBQTBELE9BQUFzRSxNQUFBbEksS0FHL0IyRyxFQUFBQyxPQUFzQjFHLEtBQUEsUUFBQTBELEtBQUEsSUFBQXNFLE1BQWtDekIsR0FDeERFLEVBQUFNLE1BQXFCL0csS0FBQSxPQUFBMEQsS0FBQSxJQUFBc0UsTUFBaUNsQixHQUN0REwsRUFBQUksS0FBb0I3RyxLQUFBLE1BQUEwRCxLQUFBLElBQUFzRSxNQUFnQ3BCLEdBQ3BESCxFQUFBcUIsYUFBQXJCLEVBQUFDLE1BQUFELEVBQUFNLEtBQUFOLEVBQUFJLFdDVmFvQixFQUNidkcsWUFBQW9FLEVBQXdCVyxFQUFZQyxPQUNwQzdFLEtBQUE2QixLQUFBb0MsRUFDQWpFLEtBQUE0QixLQUFBLElBQUE1QixLQUFBNkIsS0FBQXNFLE1BRUF0RyxLQUFBNEUsR0FDQXpFLEtBQUE0QixLQUFBa0QsS0FBQUwsVUNMYTRCLEVBQ2J4RyxZQUFBeUcsR0FDQXRHLEtBQUFzRCxRQUFBZ0QsRUFDQXRHLEtBQUF1RCxHQUFrQi9DLEVBQVFDLE1BQUFULEtBQUFzRCxTQUMxQnRELEtBQUFkLFNBRUFXLFVBQUEwRyxHQUNBLElBQUFDLEVBQUF4RyxLQUFBMkIsS0FDQTNCLEtBQUEyQixLQUFBNEUsRUFBQTVFLEtBQ0E0RSxFQUFBNUUsS0FBQTZFLEVBRUEzRyxTQUNBRyxLQUFBMkIsS0FBQSxJQUF3QnlFLEdDVnhCLElBQUFLLEVBQUEsVUNEQTVHLFlBQUE2RyxFQUFBLEVBQUFDLEVBQUEsR0FDQTNHLEtBQUE0RyxNQUFBRixFQUNBMUcsS0FBQTZHLE9BQUFGLEVBQ0EzRyxLQUFBZCxTQUVBVyxlQUFBNUIsR0FDQSxPQUFBK0IsS0FBQXFELE1BQUE1RSxJQUE4QitCLEVBQVFDLE1BQUF4QyxJQUV0QzRCLGdCQUNBLElBQUFpRSxFQUFBL0IsS0FBQUMsTUFBQUQsS0FBQUUsU0FBQWpDLEtBQUE2RyxRQUNBaEQsRUFBQTlCLEtBQUFDLE1BQUFELEtBQUFFLFNBQUFqQyxLQUFBNEcsT0FDQSxPQUFBNUcsS0FBQXFELE1BQUE1RSxPQUFpQ3FGLEtBQU1ELEtBRXZDaEUsU0FDQUcsS0FBQXFELE1BQUEsSUFBQWhELElBQ0EsUUFBQXpDLEVBQUEsRUFBdUJBLEVBQUFvQyxLQUFBNEcsTUFBZ0JoSixJQUV2QyxRQUFBa0osRUFBQSxFQUEyQkEsRUFBQTlHLEtBQUE2RyxPQUFpQkMsSUFFNUM5RyxLQUFBcUQsTUFBQTlDLE9BQWtDdUcsS0FBS2xKLElBQUUsSUFBT3lJLEdBQU12RixJQUFBZ0csRUFBQS9GLElBQUFuRCxPRGxCdEMsT0FDaEJrSSxRQUFBQyxJQUFBVSxHQUNBWCxRQUFBQyxJQUFBVSxFQUFBTSxpQkFDQU4sRUFBQU0sZ0JBQUFwRixLQUFBQyxLQUFBLElBQWtDcUQsRUFDbEN3QixFQUFBTSxnQkFBQXBGLEtBQUFDLEtBQUEsSUFBa0NxRCxFQUNsQ3dCLEVBQUFNLGdCQUFBcEYsS0FBQUMsS0FBQSxJQUFrQ3FELEVBQ2xDd0IsRUFBQU0sZ0JBQUFwRixLQUFBQyxLQUFBLElBQWtDcUQsRUE0Q2xDLElBQUErQixHQTNDQXRILElBRUFBLEVBQUF1SCxRQUFBLFNBQ0F2SCxFQUFBd0gsTUFBQSxNQUNBeEgsRUFBQXlILGFBQUEsV0FpQ0F6SCxFQUFBMEgsS0FBQSxNQUNBMUgsRUFBQTJILFdBQUEsS0E3QkEsRUFBQTNILEVBQUFaLEtBQ0FZLEVBQUF3RyxPQUNBeEcsRUFBQTRILFVBQUEsT0FDQXhJLEVBQUF1RSxNQUFBckMsUUFBQVUsSUFDQSxPQUFBQSxFQUFBQyxLQUFBQyxLQUFBQyxNQUNBLEtBQXFCK0MsRUFBWUMsTUFBQWhELEtBQ2pDbkMsRUFBQTZILEtBQUEsSUFDQSxNQUNBLEtBQXFCM0MsRUFBWU0sS0FBQXJELEtBQ2pDbkMsRUFBQTZILEtBQUEsV0FDQSxNQUNBLEtBQXFCM0MsRUFBWUksSUFBQW5ELEtBQ2pDbkMsRUFBQTZILEtBQUEsV0FHQTdILEVBQUE4SCxPQUFBLEdBQ0E5SCxFQUFBK0gsUUF4QkEsR0F3QkEvRixFQUFBNEIsUUFBQXZDLElBeEJBLEdBd0JBVyxFQUFBNEIsUUFBQXhDLElBeEJBLFNBMEJBcEIsRUFBQWdJLE9BWUFDLENBQUFqSSxFQUFBK0csR0FWQSxNQUVBLFFBQUE3SSxFQUFBLEVBQXVCQSxFQUR2QixLQUNrQ0EsSUFBQSxDQUNsQyxJQUFBNkcsRUFBcUJqRSxFQUFRb0gsb0JBQUFuQixJQUFBRyxNQUFBSCxFQUFBSSxRQUU3QnBDLEVBQUF0RSxPQUFBd0IsS0FBQW1ELEtBQUFMLEtBTUFvRCIsImZpbGUiOiJtZm0uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJpbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuLy9FdmVudCB3aW5kb3cgYXMgZGVzY3JpYmJlZCBoZXJlOiBodHRwOi8vcm9idXN0LmNzLnVubS5lZHUvbGliL2V4ZS9mZXRjaC5waHA/dz0zMDAmdG9rPTRjOGY0OSZtZWRpYT1kZXY6ZXZlbnQtd2luZG93LTEwLnBuZ1xuLy9Db2xsZWN0aW9uIG9mIHNpdGVzIHdoaWNoIGNvbnRhaW4gYXRvbXMsIGJ1aWx0IGZyb20gYW4gb3JpZ2luIChjZW50ZXIpIHNpdGVcbmV4cG9ydCBjbGFzcyBFdmVudFdpbmRvdyB7XG4gICAgY29uc3RydWN0b3IoX3RpbGUsIF9vcmlnaW4pIHtcbiAgICAgICAgdGhpcy50aWxlID0gX3RpbGU7XG4gICAgICAgIHRoaXMubWFrZVdpbmRvdyhfdGlsZSwgX29yaWdpbik7XG4gICAgfVxuICAgIG1ha2VXaW5kb3codGlsZSwgb3JpZ2luKSB7XG4gICAgICAgIHRoaXMud2luZG93ID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLm9yaWdpbiA9IHRoaXMudGlsZS5nZXRTaXRlQnlDb29yZChvcmlnaW4pO1xuICAgICAgICB0aGlzLndpbmRvdy5zZXQoTUZNVXRpbHMuQ3RvSUQob3JpZ2luKSwgdGhpcy5vcmlnaW4pO1xuICAgICAgICBsZXQgd2luZG93QXJyYXkgPSBFdmVudFdpbmRvdy5XSU5ET1dfT1JERVJfT0ZGU0VUUy5tYXAoKG9mZnNldCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuT2Zmc2V0RnJvbU9yaWdpbihvcmlnaW4sIG9mZnNldC5yb3csIG9mZnNldC5jb2wpO1xuICAgICAgICB9KTtcbiAgICAgICAgd2luZG93QXJyYXkuZm9yRWFjaCgodGlsZUNvb3JkKSA9PiB7XG4gICAgICAgICAgICBpZiAodGlsZS5nZXRTaXRlQnlDb29yZCh0aWxlQ29vcmQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53aW5kb3cuc2V0KE1GTVV0aWxzLkN0b0lEKHRpbGVDb29yZCksIHRpbGUuZ2V0U2l0ZUJ5Q29vcmQodGlsZUNvb3JkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBPZmZzZXRGcm9tT3JpZ2luKG9yaWdpbiwgcm93T2Zmc2V0LCBjb2xPZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIHsgcm93OiBvcmlnaW4ucm93ICsgcm93T2Zmc2V0LCBjb2w6IG9yaWdpbi5jb2wgKyBjb2xPZmZzZXQgfTtcbiAgICB9XG4gICAgZ2V0UmFuZG9tKHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICBsZXQgaXRlbXM7XG4gICAgICAgIGlmICghc3BlY2lmaWNUeXBlKSB7XG4gICAgICAgICAgICBpdGVtcyA9IEFycmF5LmZyb20odGhpcy53aW5kb3cudmFsdWVzKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaXRlbXMgPSBBcnJheS5mcm9tKHRoaXMud2luZG93LnZhbHVlcygpKS5maWx0ZXIoc2l0ZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHNpdGUuYXRvbSAmJiBzaXRlLmF0b20uZWxlbS50eXBlID09PSBzcGVjaWZpY1R5cGUudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2l0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGxldCByaSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGl0ZW1zLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiBpdGVtc1tyaV07XG4gICAgfVxuICAgIC8vZWFzeSB3YXkgdG8gZ2V0IGEgbmVpZ2hib3IgdGhhdCBpcyB0aGVyZVxuICAgIGdldEFkamFjZW50KHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoIXNwZWNpZmljVHlwZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0V2VzdCgpKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFdlc3QoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldE5vcnRoKCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Tm9ydGgoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldFNvdXRoKCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U291dGgoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldEVhc3QoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRFYXN0KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXROb3J0aFdlc3QoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXROb3J0aFdlc3QoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldFNvdXRoV2VzdCgpKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFNvdXRoV2VzdCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0Tm9ydGhFYXN0KCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Tm9ydGhFYXN0KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRTb3V0aEVhc3QoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTb3V0aEVhc3QoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrID0gKHMsIHNwZWNpZmljVHlwZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzICYmIHMuYXRvbSAmJiBzLmF0b20udHlwZSA9PSBzcGVjaWZpY1R5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbGV0IHMgPSB0aGlzLmdldFdlc3QoKTtcbiAgICAgICAgICAgIGlmIChjaGVjayhzLCBzcGVjaWZpY1R5cGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzID0gdGhpcy5nZXROb3J0aCgpO1xuICAgICAgICAgICAgaWYgKGNoZWNrKHMsIHNwZWNpZmljVHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMgPSB0aGlzLmdldFNvdXRoKCk7XG4gICAgICAgICAgICBpZiAoY2hlY2socywgc3BlY2lmaWNUeXBlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcyA9IHRoaXMuZ2V0RWFzdCgpO1xuICAgICAgICAgICAgaWYgKGNoZWNrKHMsIHNwZWNpZmljVHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMgPSB0aGlzLmdldE5vcnRoV2VzdCgpO1xuICAgICAgICAgICAgaWYgKGNoZWNrKHMsIHNwZWNpZmljVHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMgPSB0aGlzLmdldFNvdXRoV2VzdCgpO1xuICAgICAgICAgICAgaWYgKGNoZWNrKHMsIHNwZWNpZmljVHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMgPSB0aGlzLmdldE5vcnRoRWFzdCgpO1xuICAgICAgICAgICAgaWYgKGNoZWNrKHMsIHNwZWNpZmljVHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMgPSB0aGlzLmdldFNvdXRoRWFzdCgpO1xuICAgICAgICAgICAgaWYgKGNoZWNrKHMsIHNwZWNpZmljVHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBnZXRFYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfRUFTVCk7XG4gICAgfVxuICAgIGdldFdlc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19XRVNUKTtcbiAgICB9XG4gICAgZ2V0Tm9ydGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19OT1JUSCk7XG4gICAgfVxuICAgIGdldFNvdXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfU09VVEgpO1xuICAgIH1cbiAgICBnZXROb3J0aFdlc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19OT1JUSFdFU1QpO1xuICAgIH1cbiAgICBnZXRTb3V0aFdlc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19TT1VUSFdFU1QpO1xuICAgIH1cbiAgICBnZXROb3J0aEVhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19OT1JUSEVBU1QpO1xuICAgIH1cbiAgICBnZXRTb3V0aEVhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19TT1VUSEVBU1QpO1xuICAgIH1cbiAgICBnZXREaXJlY3Rpb24oZGlyZWN0aW9uKSB7XG4gICAgICAgIGxldCBzaXRlID0gdGhpcy50aWxlLnNpdGVzLmdldChNRk1VdGlscy5DdG9JRCh0aGlzLk9mZnNldEZyb21PcmlnaW4odGhpcy5vcmlnaW4udGlsZVBvcywgZGlyZWN0aW9uLnJvdywgZGlyZWN0aW9uLmNvbCkpKTtcbiAgICAgICAgaWYgKHNpdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBzaXRlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxufVxuRXZlbnRXaW5kb3cuV0lORE9XX09SREVSX09GRlNFVFMgPSBbXG4gICAgeyBjb2w6IDAsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMCwgcm93OiAxIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAxIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMSwgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0yLCByb3c6IDAgfSxcbiAgICB7IGNvbDogMCwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAwLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMiwgcm93OiAwIH0sXG4gICAgeyBjb2w6IC0yLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IC0yLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogLTIgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMiB9LFxuICAgIHsgY29sOiAxLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMiB9LFxuICAgIHsgY29sOiAyLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtMywgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTMgfSxcbiAgICB7IGNvbDogMCwgcm93OiAzIH0sXG4gICAgeyBjb2w6IDMsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAtMiB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAyIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogLTIgfSxcbiAgICB7IGNvbDogMiwgcm93OiAyIH0sXG4gICAgeyBjb2w6IC0zLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IC0zLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogLTMgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMyB9LFxuICAgIHsgY29sOiAxLCByb3c6IC0zIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMyB9LFxuICAgIHsgY29sOiAzLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDMsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtNCwgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTQgfSxcbiAgICB7IGNvbDogMCwgcm93OiA0IH0sXG4gICAgeyBjb2w6IDQsIHJvdzogMCB9XG5dO1xuLy9iZWNhdXNlLCBsYXp5XG5FdmVudFdpbmRvdy5FV19XRVNUID0geyBjb2w6IC0xLCByb3c6IDAgfTtcbkV2ZW50V2luZG93LkVXX0VBU1QgPSB7IGNvbDogMSwgcm93OiAwIH07XG5FdmVudFdpbmRvdy5FV19OT1JUSCA9IHsgY29sOiAwLCByb3c6IC0xIH07XG5FdmVudFdpbmRvdy5FV19TT1VUSCA9IHsgY29sOiAwLCByb3c6IDEgfTtcbkV2ZW50V2luZG93LkVXX05PUlRIV0VTVCA9IHsgY29sOiAtMSwgcm93OiAtMSB9O1xuRXZlbnRXaW5kb3cuRVdfU09VVEhXRVNUID0geyBjb2w6IC0xLCByb3c6IDEgfTtcbkV2ZW50V2luZG93LkVXX05PUlRIRUFTVCA9IHsgY29sOiAxLCByb3c6IC0xIH07XG5FdmVudFdpbmRvdy5FV19TT1VUSEVBU1QgPSB7IGNvbDogMSwgcm93OiAxIH07XG4iLCJpbXBvcnQgeyBFdmVudFdpbmRvdyB9IGZyb20gXCIuLi9jbGFzc2VzL0V2ZW50d2luZG93XCI7XG5leHBvcnQgY2xhc3MgTUZNVXRpbHMge1xuICAgIHN0YXRpYyBDdG9JRChjKSB7XG4gICAgICAgIHJldHVybiBgJHtjLnJvd306JHtjLmNvbH1gO1xuICAgIH1cbiAgICBzdGF0aWMgSUR0b0MoaWQpIHtcbiAgICAgICAgbGV0IHJjYSA9IGlkLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgcmV0dXJuIHsgcm93OiBwYXJzZUludChyY2FbMF0pLCBjb2w6IHBhcnNlSW50KHJjYVsxXSkgfTtcbiAgICB9XG4gICAgc3RhdGljIEdlbmVyYXRlRXZlbnRXaW5kb3codGlsZSwgdywgaCkge1xuICAgICAgICBsZXQgcmMgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB3KTtcbiAgICAgICAgbGV0IHJyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaCk7XG4gICAgICAgIHJldHVybiBuZXcgRXZlbnRXaW5kb3codGlsZSwgeyByb3c6IHJyLCBjb2w6IHJjIH0pO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBFbGVtIHtcbiAgICBjb25zdHJ1Y3RvcihfbmFtZSwgX3R5cGUsIF9tb3ZlYWJsZSA9IHRydWUsIF9raWxsYWJsZSA9IHRydWUsIF9kYXRhID0gMCkge1xuICAgICAgICB0aGlzLm5hbWUgPSBfbmFtZTtcbiAgICAgICAgdGhpcy50eXBlID0gX3R5cGU7XG4gICAgICAgIHRoaXMuZGF0YSA9IF9kYXRhO1xuICAgICAgICB0aGlzLm1vdmVhYmxlID0gX21vdmVhYmxlO1xuICAgICAgICB0aGlzLmtpbGxhYmxlID0gX2tpbGxhYmxlO1xuICAgIH1cbiAgICBzZXQgZGF0YShkKSB7XG4gICAgICAgIHRoaXMuX2RhdGEgPSBkO1xuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7XG4gICAgfVxuICAgIHNldCBuYW1lKG4pIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IG47XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgICB9XG4gICAgc2V0IHR5cGUodCkge1xuICAgICAgICB0aGlzLl90eXBlID0gdDtcbiAgICB9XG4gICAgZ2V0IHR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgIH1cbiAgICBzZXQgbW92ZWFibGUobSkge1xuICAgICAgICB0aGlzLl9tb3ZlYWJsZSA9IG07XG4gICAgfVxuICAgIGdldCBtb3ZlYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21vdmVhYmxlO1xuICAgIH1cbiAgICBzZXQga2lsbGFibGUoaykge1xuICAgICAgICB0aGlzLl9raWxsYWJsZSA9IGs7XG4gICAgfVxuICAgIGdldCBraWxsYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tpbGxhYmxlO1xuICAgIH1cbiAgICBleGVjKGV3KSB7IH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIEVtcHR5RWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuRU1QVFkubmFtZSwgRWxlbWVudFR5cGVzLkVNUFRZLnR5cGUpO1xuICAgIH1cbiAgICBleGVjKGV3KSB7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIFJlc0VsZW1lbnQgZXh0ZW5kcyBFbGVtIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoRWxlbWVudFR5cGVzLlJFUy5uYW1lLCBFbGVtZW50VHlwZXMuUkVTLnR5cGUpO1xuICAgIH1cbiAgICBleGVjKGV3KSB7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuaW1wb3J0IHsgRW1wdHlFbGVtZW50IH0gZnJvbSBcIi4vRW1wdHlFbGVtZW50XCI7XG5pbXBvcnQgeyBSZXNFbGVtZW50IH0gZnJvbSBcIi4vUmVzRWxlbWVudFwiO1xuZXhwb3J0IGNsYXNzIERSZWdFbGVtZW50IGV4dGVuZHMgRWxlbSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKEVsZW1lbnRUeXBlcy5EUkVHLm5hbWUsIEVsZW1lbnRUeXBlcy5EUkVHLnR5cGUpO1xuICAgICAgICB0aGlzLnBUT1RBTF9DSEFOQ0UgPSAxMDA7XG4gICAgICAgIHRoaXMucERSRUdfQ1JFQVRFID0gMC4xO1xuICAgICAgICB0aGlzLnBSRVNfQ1JFQVRFID0gMC41O1xuICAgICAgICB0aGlzLnBEUkVHX0RFU1RST1kgPSAxMDtcbiAgICAgICAgdGhpcy5wQU5ZX0RFU1RST1kgPSAxO1xuICAgIH1cbiAgICBleGVjKGV3KSB7XG4gICAgICAgIGNvbnN0IGNyZWF0ZURSZWcgPSBNYXRoLnJhbmRvbSgpICogdGhpcy5wVE9UQUxfQ0hBTkNFIDwgdGhpcy5wRFJFR19DUkVBVEU7XG4gICAgICAgIGNvbnN0IGNyZWF0ZVJlcyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBSRVNfQ1JFQVRFO1xuICAgICAgICBjb25zdCBkZXN0cm95RFJlZyA9IE1hdGgucmFuZG9tKCkgKiB0aGlzLnBUT1RBTF9DSEFOQ0UgPCB0aGlzLnBEUkVHX0RFU1RST1k7XG4gICAgICAgIGNvbnN0IGRlc3Ryb3lBbnkgPSBNYXRoLnJhbmRvbSgpICogdGhpcy5wVE9UQUxfQ0hBTkNFIDwgdGhpcy5wQU5ZX0RFU1RST1k7XG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZVNpdGUgPSBldy5nZXRSYW5kb20oKTtcbiAgICAgICAgaWYgKGNyZWF0ZURSZWcpIHtcbiAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbS5lbGVtID0gbmV3IERSZWdFbGVtZW50KCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRSRUcgQ1JFQVRFRFwiLCBhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjcmVhdGVSZXMpIHtcbiAgICAgICAgICAgIC8vbWFrZSByZXNcbiAgICAgICAgICAgIGlmIChhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLkVNUFRZKSB7XG4gICAgICAgICAgICAgICAgYXZhaWxhYmxlU2l0ZS5hdG9tLmVsZW0gPSBuZXcgUmVzRWxlbWVudCgpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUkVTIENSRUFURURcIiwgYXZhaWxhYmxlU2l0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVzdHJveURSZWcpIHtcbiAgICAgICAgICAgIGlmIChhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLkRSRUcpIHtcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVTaXRlLmF0b20uZWxlbSA9IG5ldyBFbXB0eUVsZW1lbnQoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRSRUcgREVTVFJPWUVEXCIsIGF2YWlsYWJsZVNpdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRlc3Ryb3lBbnkpIHtcbiAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbS5lbGVtID0gbmV3IEVtcHR5RWxlbWVudCgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJBTlkgREVTVFJPWUVEXCIsIGF2YWlsYWJsZVNpdGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vTW92ZSByYW5kb21cbiAgICAgICAgbGV0IGRpciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDgpO1xuICAgICAgICBzd2l0Y2ggKGRpcikge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGlmIChldy5nZXRXZXN0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhldy5nZXRXZXN0KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBpZiAoZXcuZ2V0RWFzdCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGV3Lm9yaWdpbi5zd2FwQXRvbXMoZXcuZ2V0RWFzdCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgaWYgKGV3LmdldE5vcnRoKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhldy5nZXROb3J0aCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgaWYgKGV3LmdldFNvdXRoKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhldy5nZXRTb3V0aCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG4gPSBNYXRoLnJhbmRvbSgpICogMTA7XG4gICAgICAgIC8vIHN3aXRjaChuKSB7XG4gICAgICAgIC8vIGNhc2UgMDpcbiAgICAgICAgLy8gY2FzZSAxOlxuICAgICAgICAvLyBjYXNlIDI6XG4gICAgICAgIC8vICAgICBpZiggZXcuciAmJiBldy5yLmF0b20udHlwZSA9PSAwICkge1xuICAgICAgICAvLyAgICAgZXcuci5hdG9tLnNldFR5cGUoMik7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIGJyZWFrO1xuICAgICAgICAvLyBkZWZhdWx0OlxuICAgICAgICAvLyAgICAgaWYoIGV3LnIgJiYgZXcuci5hdG9tLnR5cGUgIT0gNCkge1xuICAgICAgICAvLyAgICAgZXcuci5hdG9tLnNldFR5cGUoMCk7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vICAgICBicmVhaztcbiAgICAgICAgLy8gfVxuICAgICAgICBzdXBlci5leGVjKGV3KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFbXB0eUVsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9FbXB0eUVsZW1lbnRcIjtcbmltcG9ydCB7IERSZWdFbGVtZW50IH0gZnJvbSBcIi4vZWxlbWVudHMvRFJlZ0VsZW1lbnRcIjtcbmltcG9ydCB7IFJlc0VsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9SZXNFbGVtZW50XCI7XG5leHBvcnQgY2xhc3MgRWxlbWVudFR5cGVzIHtcbiAgICBzdGF0aWMgcmVnaXN0ZXJUeXBlKG5hbWUsIHR5cGUsIGMpIHtcbiAgICAgICAgdGhpcy5UWVBFU19BUlJBWS5wdXNoKHsgbmFtZSwgdHlwZSwgY2xhc3M6IGMgfSk7XG4gICAgfVxufVxuRWxlbWVudFR5cGVzLkVNUFRZID0geyBuYW1lOiBcIkVNUFRZXCIsIHR5cGU6IFwiRVwiLCBjbGFzczogRW1wdHlFbGVtZW50IH07XG5FbGVtZW50VHlwZXMuRFJFRyA9IHsgbmFtZTogXCJEUkVHXCIsIHR5cGU6IFwiRFwiLCBjbGFzczogRFJlZ0VsZW1lbnQgfTtcbkVsZW1lbnRUeXBlcy5SRVMgPSB7IG5hbWU6IFwiUkVTXCIsIHR5cGU6IFwiUlwiLCBjbGFzczogUmVzRWxlbWVudCB9O1xuRWxlbWVudFR5cGVzLlRZUEVTX0FSUkFZID0gW0VsZW1lbnRUeXBlcy5FTVBUWSwgRWxlbWVudFR5cGVzLkRSRUcsIEVsZW1lbnRUeXBlcy5SRVNdO1xuIiwiaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgQXRvbSB7XG4gICAgY29uc3RydWN0b3IoX3R5cGUgPSBFbGVtZW50VHlwZXMuRU1QVFkpIHtcbiAgICAgICAgdGhpcy50eXBlID0gX3R5cGU7XG4gICAgICAgIHRoaXMuZWxlbSA9IG5ldyB0aGlzLnR5cGUuY2xhc3MoKTtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICB0aGlzLmVsZW0uZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTUZNVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IEF0b20gfSBmcm9tIFwiLi9BdG9tXCI7XG5leHBvcnQgY2xhc3MgU2l0ZSB7XG4gICAgY29uc3RydWN0b3IoX3Bvcykge1xuICAgICAgICB0aGlzLnRpbGVQb3MgPSBfcG9zO1xuICAgICAgICB0aGlzLmlkID0gTUZNVXRpbHMuQ3RvSUQodGhpcy50aWxlUG9zKTtcbiAgICAgICAgdGhpcy5jcmVhdGUoKTtcbiAgICB9XG4gICAgc3dhcEF0b21zKHRhcmdldFNpdGUpIHtcbiAgICAgICAgbGV0IHRlbXAgPSB0aGlzLmF0b207XG4gICAgICAgIHRoaXMuYXRvbSA9IHRhcmdldFNpdGUuYXRvbTtcbiAgICAgICAgdGFyZ2V0U2l0ZS5hdG9tID0gdGVtcDtcbiAgICB9XG4gICAgY3JlYXRlKCkge1xuICAgICAgICB0aGlzLmF0b20gPSBuZXcgQXRvbSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFRpbGUgfSBmcm9tIFwiLi9tZm0vY2xhc3Nlcy9UaWxlXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi9tZm0vY2xhc3Nlcy9FbGVtZW50VHlwZXNcIjtcbmltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4vbWZtL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgeyBEUmVnRWxlbWVudCB9IGZyb20gXCIuL21mbS9jbGFzc2VzL2VsZW1lbnRzL0RSZWdFbGVtZW50XCI7XG5sZXQgZyA9IG5ldyBUaWxlKDMwLCAzMCk7XG5jb25zb2xlLmxvZyhnKTtcbmNvbnNvbGUubG9nKGcuZ2V0UmFuZG9tU2l0ZSgpKTtcbmcuZ2V0UmFuZG9tU2l0ZSgpLmF0b20uZWxlbSA9IG5ldyBEUmVnRWxlbWVudCgpO1xuZy5nZXRSYW5kb21TaXRlKCkuYXRvbS5lbGVtID0gbmV3IERSZWdFbGVtZW50KCk7XG5nLmdldFJhbmRvbVNpdGUoKS5hdG9tLmVsZW0gPSBuZXcgRFJlZ0VsZW1lbnQoKTtcbmcuZ2V0UmFuZG9tU2l0ZSgpLmF0b20uZWxlbSA9IG5ldyBEUmVnRWxlbWVudCgpO1xudmFyIHNrZXRjaCA9IChwKSA9PiB7XG4gICAgbGV0IHNpdGVTaXplID0gMTI7XG4gICAgcC5wcmVsb2FkID0gKCkgPT4geyB9O1xuICAgIHAuc2V0dXAgPSAoKSA9PiB7XG4gICAgICAgIHAuY3JlYXRlQ2FudmFzKDgwMCwgODAwKTtcbiAgICB9O1xuICAgIC8vICAgcC53aW5kb3dSZXNpemVkID0gKCkgPT4ge1xuICAgIC8vICAgICBwLnJlc2l6ZUNhbnZhcyhwLndpbmRvd1dpZHRoIC0gNTAsIHAud2luZG93SGVpZ2h0IC0gNTApO1xuICAgIC8vICAgfTtcbiAgICBsZXQgZHJhd0dyaWQgPSAocCwgdCkgPT4ge1xuICAgICAgICBwLnB1c2goKTtcbiAgICAgICAgcC50cmFuc2xhdGUoNTAsIDUwKTtcbiAgICAgICAgdC5zaXRlcy5mb3JFYWNoKChzaXRlKSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKHNpdGUuYXRvbS5lbGVtLnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIEVsZW1lbnRUeXBlcy5FTVBUWS50eXBlOlxuICAgICAgICAgICAgICAgICAgICBwLmZpbGwoMzIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIEVsZW1lbnRUeXBlcy5EUkVHLnR5cGU6XG4gICAgICAgICAgICAgICAgICAgIHAuZmlsbCgyNTUsIDMyLCAzMik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgRWxlbWVudFR5cGVzLlJFUy50eXBlOlxuICAgICAgICAgICAgICAgICAgICBwLmZpbGwoMzIsIDI1NSwgNjQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAuc3Ryb2tlKDApO1xuICAgICAgICAgICAgcC5lbGxpcHNlKHNpdGUudGlsZVBvcy5jb2wgKiBzaXRlU2l6ZSwgc2l0ZS50aWxlUG9zLnJvdyAqIHNpdGVTaXplLCBzaXRlU2l6ZSwgc2l0ZVNpemUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcC5wb3AoKTtcbiAgICB9O1xuICAgIGxldCBydW4gPSAoKSA9PiB7XG4gICAgICAgIGxldCBzcGVlZCA9IDE1MDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BlZWQ7IGkrKykge1xuICAgICAgICAgICAgbGV0IGV3ID0gTUZNVXRpbHMuR2VuZXJhdGVFdmVudFdpbmRvdyhnLCBnLndpZHRoLCBnLmhlaWdodCk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGV3KTtcbiAgICAgICAgICAgIGV3Lm9yaWdpbi5hdG9tLmV4ZWMoZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBwLmRyYXcgPSAoKSA9PiB7XG4gICAgICAgIHAuYmFja2dyb3VuZCgxMDApO1xuICAgICAgICBkcmF3R3JpZChwLCBnKTtcbiAgICAgICAgcnVuKCk7XG4gICAgfTtcbn07XG5sZXQgc2tldGNoUCA9IG5ldyBwNShza2V0Y2gpO1xuIiwiaW1wb3J0IHsgU2l0ZSB9IGZyb20gXCIuL1NpdGVcIjtcbmltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5leHBvcnQgY2xhc3MgVGlsZSB7XG4gICAgY29uc3RydWN0b3IoX3dpZHRoID0gMSwgX2hlaWdodCA9IDEpIHtcbiAgICAgICAgdGhpcy53aWR0aCA9IF93aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBfaGVpZ2h0O1xuICAgICAgICB0aGlzLmNyZWF0ZSgpO1xuICAgIH1cbiAgICBnZXRTaXRlQnlDb29yZChjKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNpdGVzLmdldChNRk1VdGlscy5DdG9JRChjKSk7XG4gICAgfVxuICAgIGdldFJhbmRvbVNpdGUoKSB7XG4gICAgICAgIGxldCByciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuaGVpZ2h0KTtcbiAgICAgICAgbGV0IHJjID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy53aWR0aCk7XG4gICAgICAgIHJldHVybiB0aGlzLnNpdGVzLmdldChgJHtycn06JHtyY31gKTtcbiAgICB9XG4gICAgY3JlYXRlKCkge1xuICAgICAgICB0aGlzLnNpdGVzID0gbmV3IE1hcCgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMud2lkdGg7IGkrKykge1xuICAgICAgICAgICAgLy9hY3Jvc3MgY29sdW1uc1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmhlaWdodDsgaisrKSB7XG4gICAgICAgICAgICAgICAgLy9kb3duIHJvd3NcbiAgICAgICAgICAgICAgICB0aGlzLnNpdGVzLnNldChgJHtqfToke2l9YCwgbmV3IFNpdGUoeyByb3c6IGosIGNvbDogaSB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9