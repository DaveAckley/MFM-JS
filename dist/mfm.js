!function(t){var e={};function o(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(r,s,function(e){return t[e]}.bind(null,s));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);class r{constructor(t,e){this.tile=t,this.makeWindow(t,e)}makeWindow(t,e){this.window=new Map,this.origin=this.tile.getSiteByCoord(e),this.window.set(s.CtoID(e),this.origin),r.WINDOW_ORDER_OFFSETS.map(t=>this.OffsetFromOrigin(e,t.row,t.col)).forEach(e=>{t.getSiteByCoord(e)&&this.window.set(s.CtoID(e),t.getSiteByCoord(e))})}OffsetFromOrigin(t,e,o){return{row:t.row+e,col:t.col+o}}getRandom(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!0,t)}getNearest(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!1,t)}getEast(){return this.getDirection(r.EW_EAST)}getWest(){return this.getDirection(r.EW_WEST)}getNorth(){return this.getDirection(r.EW_NORTH)}getSouth(){return this.getDirection(r.EW_SOUTH)}getNorthWest(){return this.getDirection(r.EW_NORTHWEST)}getSouthWest(){return this.getDirection(r.EW_SOUTHWEST)}getNorthEast(){return this.getDirection(r.EW_NORTHEAST)}getSouthEast(){return this.getDirection(r.EW_SOUTHEAST)}getAdjacent4Way(t,e=!0){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast()],e,t)}getAdjacent8Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast(),this.getNorthWest(),this.getSouthWest(),this.getNorthEast(),this.getSouthEast()],t,e)}getSiteFromCandidates(t,e=!0,o){if(t=t.filter(t=>!!t&&(o?!(!o||t.atom.type!==o)&&t:t)),console.log("yikes",t),!(t.length<1))return e?t[Math.floor(Math.random()*t.length)]:t[0];console.log("yikes",t)}getDirection(t){let e=this.tile.sites.get(s.CtoID(this.OffsetFromOrigin(this.origin.tilePos,t.row,t.col)));if(e)return e}}r.WINDOW_ORDER_OFFSETS=[{col:0,row:0},{col:-1,row:0},{col:0,row:-1},{col:0,row:1},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1},{col:-2,row:0},{col:0,row:-1},{col:0,row:2},{col:2,row:0},{col:-2,row:-1},{col:-2,row:1},{col:-1,row:-2},{col:-1,row:2},{col:1,row:-2},{col:1,row:2},{col:2,row:-1},{col:2,row:1},{col:-3,row:0},{col:0,row:-3},{col:0,row:3},{col:3,row:0},{col:-2,row:-2},{col:-2,row:2},{col:2,row:-2},{col:2,row:2},{col:-3,row:-1},{col:-3,row:1},{col:-1,row:-3},{col:-1,row:3},{col:1,row:-3},{col:1,row:3},{col:3,row:-1},{col:3,row:1},{col:-4,row:0},{col:0,row:-4},{col:0,row:4},{col:4,row:0}],r.EW_WEST={col:-1,row:0},r.EW_EAST={col:1,row:0},r.EW_NORTH={col:0,row:-1},r.EW_SOUTH={col:0,row:1},r.EW_NORTHWEST={col:-1,row:-1},r.EW_SOUTHWEST={col:-1,row:1},r.EW_NORTHEAST={col:1,row:-1},r.EW_SOUTHEAST={col:1,row:1};class s{static CtoID(t){return`${t.row}:${t.col}`}static IDtoC(t){let e=t.split(":");return{row:parseInt(e[0]),col:parseInt(e[1])}}static GenerateEventWindow(t,e,o){let s=Math.floor(Math.random()*e),i=Math.floor(Math.random()*o);return new r(t,{row:i,col:s})}}class i{constructor(t,e,o=!0,r=!0,s=0){this.name=t,this.type=e,this.data=s,this.moveable=o,this.killable=r}set data(t){this._data=t}get data(){return this._data}set name(t){this._name=t}get name(){return this._name}set type(t){this._type=t}get type(){return this._type}set moveable(t){this._moveable=t}get moveable(){return this._moveable}set killable(t){this._killable=t}get killable(){return this._killable}exec(t){}}class n extends i{constructor(){super(c.EMPTY.name,c.EMPTY.type)}exec(t){super.exec(t)}}class l extends i{constructor(){super(c.RES.name,c.RES.type)}exec(t){t.origin.swapAtoms(t.getRandom(c.EMPTY)),super.exec(t)}}class a extends i{constructor(){super(c.DREG.name,c.DREG.type),this.pTOTAL_CHANCE=100,this.pDREG_CREATE=.1,this.pRES_CREATE=.5,this.pDREG_DESTROY=10,this.pANY_DESTROY=1}exec(t){const e=Math.random()*this.pTOTAL_CHANCE<this.pDREG_CREATE,o=Math.random()*this.pTOTAL_CHANCE<this.pRES_CREATE,r=Math.random()*this.pTOTAL_CHANCE<this.pDREG_DESTROY,s=Math.random()*this.pTOTAL_CHANCE<this.pANY_DESTROY,i=t.getAdjacent4Way();e?(i.atom.elem=new a,console.log("DREG CREATED",i)):o?i.atom.type===c.EMPTY&&(i.atom.elem=new l,console.log("RES CREATED",i)):r?i.atom.type===c.DREG&&(i.atom.elem=new n,console.log("DREG DESTROYED",i)):s&&(i.atom.elem=new n,console.log("ANY DESTROYED",i)),t.origin.swapAtoms(t.getRandom(c.EMPTY)),super.exec(t)}}class c{static registerType(t,e,o){this.TYPES_ARRAY.push({name:t,type:e,class:o})}}c.EMPTY={name:"EMPTY",type:"E",class:n},c.DREG={name:"DREG",type:"D",class:a},c.RES={name:"RES",type:"R",class:l},c.TYPES_ARRAY=[c.EMPTY,c.DREG,c.RES];class h{constructor(t=c.EMPTY){this.type=t,this.elem=new this.type.class}exec(t){this.elem.exec(t)}}class E{constructor(t){this.tilePos=t,this.id=s.CtoID(this.tilePos),this.create()}swapAtoms(t){[this.atom,t.atom]=[t.atom,this.atom]}create(){this.atom=new h}}let w=new class{constructor(t=1,e=1){this.width=t,this.height=e,this.create()}getSiteByCoord(t){return this.sites.get(s.CtoID(t))}getRandomSite(){let t=Math.floor(Math.random()*this.height),e=Math.floor(Math.random()*this.width);return this.sites.get(`${t}:${e}`)}create(){this.sites=new Map;for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)this.sites.set(`${e}:${t}`,new E({row:e,col:t}))}}(30,30);console.log(w),console.log(w.getRandomSite()),w.getRandomSite().atom.elem=new a,w.getRandomSite().atom.elem=new a,w.getRandomSite().atom.elem=new a,w.getRandomSite().atom.elem=new a;new p5(t=>{t.preload=(()=>{}),t.setup=(()=>{t.createCanvas(800,800)});t.draw=(()=>{t.background(100),((t,e)=>{t.push(),t.translate(50,50),e.sites.forEach(e=>{switch(e.atom.elem.type){case c.EMPTY.type:t.fill(32);break;case c.DREG.type:t.fill(255,32,32);break;case c.RES.type:t.fill(32,255,64)}t.stroke(0),t.ellipse(12*e.tilePos.col,12*e.tilePos.row,12,12)}),t.pop()})(t,w),(()=>{for(var t=0;t<1e3;t++){let t=s.GenerateEventWindow(w,w.width,w.height);t.origin.atom.exec(t)}})()})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0V2ZW50d2luZG93LnRzIiwid2VicGFjazovLy8uL3NyYy9tZm0vdXRpbHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW0udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL2VsZW1lbnRzL0VtcHR5RWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvUmVzRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvRFJlZ0VsZW1lbnQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW1lbnRUeXBlcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvQXRvbS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvU2l0ZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL1RpbGUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJFdmVudHdpbmRvd19FdmVudFdpbmRvdyIsIltvYmplY3QgT2JqZWN0XSIsIl90aWxlIiwiX29yaWdpbiIsInRoaXMiLCJ0aWxlIiwibWFrZVdpbmRvdyIsIm9yaWdpbiIsIndpbmRvdyIsIk1hcCIsImdldFNpdGVCeUNvb3JkIiwic2V0IiwidXRpbHNfTUZNVXRpbHMiLCJDdG9JRCIsIldJTkRPV19PUkRFUl9PRkZTRVRTIiwibWFwIiwib2Zmc2V0IiwiT2Zmc2V0RnJvbU9yaWdpbiIsInJvdyIsImNvbCIsImZvckVhY2giLCJ0aWxlQ29vcmQiLCJyb3dPZmZzZXQiLCJjb2xPZmZzZXQiLCJzcGVjaWZpY1R5cGUiLCJnZXRTaXRlRnJvbUNhbmRpZGF0ZXMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJnZXREaXJlY3Rpb24iLCJFV19FQVNUIiwiRVdfV0VTVCIsIkVXX05PUlRIIiwiRVdfU09VVEgiLCJFV19OT1JUSFdFU1QiLCJFV19TT1VUSFdFU1QiLCJFV19OT1JUSEVBU1QiLCJFV19TT1VUSEVBU1QiLCJyYW5kb21pemUiLCJnZXRXZXN0IiwiZ2V0Tm9ydGgiLCJnZXRTb3V0aCIsImdldEVhc3QiLCJnZXROb3J0aFdlc3QiLCJnZXRTb3V0aFdlc3QiLCJnZXROb3J0aEVhc3QiLCJnZXRTb3V0aEVhc3QiLCJjYW5kaWRhdGVTaXRlcyIsImZpbHRlciIsInNpdGUiLCJhdG9tIiwidHlwZSIsImNvbnNvbGUiLCJsb2ciLCJsZW5ndGgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJkaXJlY3Rpb24iLCJzaXRlcyIsInRpbGVQb3MiLCJpZCIsInJjYSIsInNwbGl0IiwicGFyc2VJbnQiLCJ3IiwiaCIsInJjIiwicnIiLCJFbGVtIiwiX25hbWUiLCJfdHlwZSIsIl9tb3ZlYWJsZSIsIl9raWxsYWJsZSIsIl9kYXRhIiwiZGF0YSIsIm1vdmVhYmxlIiwia2lsbGFibGUiLCJrIiwiZXciLCJFbXB0eUVsZW1lbnRfRW1wdHlFbGVtZW50Iiwic3VwZXIiLCJFbGVtZW50VHlwZXMiLCJFTVBUWSIsImV4ZWMiLCJSZXNFbGVtZW50X1Jlc0VsZW1lbnQiLCJSRVMiLCJzd2FwQXRvbXMiLCJnZXRSYW5kb20iLCJEUmVnRWxlbWVudF9EUmVnRWxlbWVudCIsIkRSRUciLCJwVE9UQUxfQ0hBTkNFIiwicERSRUdfQ1JFQVRFIiwicFJFU19DUkVBVEUiLCJwRFJFR19ERVNUUk9ZIiwicEFOWV9ERVNUUk9ZIiwiY3JlYXRlRFJlZyIsImNyZWF0ZVJlcyIsImRlc3Ryb3lEUmVnIiwiZGVzdHJveUFueSIsImF2YWlsYWJsZVNpdGUiLCJnZXRBZGphY2VudDRXYXkiLCJlbGVtIiwiVFlQRVNfQVJSQVkiLCJwdXNoIiwiY2xhc3MiLCJBdG9tX0F0b20iLCJTaXRlX1NpdGUiLCJfcG9zIiwidGFyZ2V0U2l0ZSIsImciLCJfd2lkdGgiLCJfaGVpZ2h0Iiwid2lkdGgiLCJoZWlnaHQiLCJqIiwiZ2V0UmFuZG9tU2l0ZSIsInA1IiwicHJlbG9hZCIsInNldHVwIiwiY3JlYXRlQ2FudmFzIiwiZHJhdyIsImJhY2tncm91bmQiLCJ0cmFuc2xhdGUiLCJmaWxsIiwic3Ryb2tlIiwiZWxsaXBzZSIsInBvcCIsImRyYXdHcmlkIiwiR2VuZXJhdGVFdmVudFdpbmRvdyIsInJ1biJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxhQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFILEVBQ0EsSUFBQUksRUFBQVgsT0FBQVksT0FBQSxNQUdBLEdBRkExQixFQUFBa0IsRUFBQU8sR0FDQVgsT0FBQUMsZUFBQVUsRUFBQSxXQUF5Q1QsWUFBQSxFQUFBSyxVQUN6QyxFQUFBRSxHQUFBLGlCQUFBRixFQUFBLFFBQUFNLEtBQUFOLEVBQUFyQixFQUFBVSxFQUFBZSxFQUFBRSxFQUFBLFNBQUFBLEdBQWdILE9BQUFOLEVBQUFNLElBQXFCQyxLQUFBLEtBQUFELElBQ3JJLE9BQUFGLEdBSUF6QixFQUFBNkIsRUFBQSxTQUFBMUIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBcUIsV0FDQSxXQUEyQixPQUFBckIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQWlCLEVBQUFDLEdBQXNELE9BQUFqQixPQUFBa0IsVUFBQUMsZUFBQTFCLEtBQUF1QixFQUFBQyxJQUd0RC9CLEVBQUFrQyxFQUFBLEdBSUFsQyxJQUFBbUMsRUFBQSwrQ0MvRWFDLEVBQ2JDLFlBQUFDLEVBQUFDLEdBQ0FDLEtBQUFDLEtBQUFILEVBQ0FFLEtBQUFFLFdBQUFKLEVBQUFDLEdBRUFGLFdBQUFJLEVBQUFFLEdBQ0FILEtBQUFJLE9BQUEsSUFBQUMsSUFDQUwsS0FBQUcsT0FBQUgsS0FBQUMsS0FBQUssZUFBQUgsR0FDQUgsS0FBQUksT0FBQUcsSUFBd0JDLEVBQVFDLE1BQUFOLEdBQUFILEtBQUFHLFFBQ05QLEVBQVdjLHFCQUFBQyxJQUFBQyxHQUNyQ1osS0FBQWEsaUJBQUFWLEVBQUFTLEVBQUFFLElBQUFGLEVBQUFHLE1BRUFDLFFBQUFDLElBQ0FoQixFQUFBSyxlQUFBVyxJQUNBakIsS0FBQUksT0FBQUcsSUFBZ0NDLEVBQVFDLE1BQUFRLEdBQUFoQixFQUFBSyxlQUFBVyxNQUl4Q3BCLGlCQUFBTSxFQUFBZSxFQUFBQyxHQUNBLE9BQWdCTCxJQUFBWCxFQUFBVyxJQUFBSSxFQUFBSCxJQUFBWixFQUFBWSxJQUFBSSxHQUVoQnRCLFVBQUF1QixHQUNBLE9BQUFwQixLQUFBcUIsc0JBQUFDLE1BQUFDLEtBQUF2QixLQUFBSSxPQUFBb0IsV0FBQSxFQUFBSixHQUVBdkIsV0FBQXVCLEdBQ0EsT0FBQXBCLEtBQUFxQixzQkFBQUMsTUFBQUMsS0FBQXZCLEtBQUFJLE9BQUFvQixXQUFBLEVBQUFKLEdBRUF2QixVQUNBLE9BQUFHLEtBQUF5QixhQUFpQzdCLEVBQVc4QixTQUU1QzdCLFVBQ0EsT0FBQUcsS0FBQXlCLGFBQWlDN0IsRUFBVytCLFNBRTVDOUIsV0FDQSxPQUFBRyxLQUFBeUIsYUFBaUM3QixFQUFXZ0MsVUFFNUMvQixXQUNBLE9BQUFHLEtBQUF5QixhQUFpQzdCLEVBQVdpQyxVQUU1Q2hDLGVBQ0EsT0FBQUcsS0FBQXlCLGFBQWlDN0IsRUFBV2tDLGNBRTVDakMsZUFDQSxPQUFBRyxLQUFBeUIsYUFBaUM3QixFQUFXbUMsY0FFNUNsQyxlQUNBLE9BQUFHLEtBQUF5QixhQUFpQzdCLEVBQVdvQyxjQUU1Q25DLGVBQ0EsT0FBQUcsS0FBQXlCLGFBQWlDN0IsRUFBV3FDLGNBRTVDcEMsZ0JBQUF1QixFQUFBYyxHQUFBLEdBQ0EsT0FBQWxDLEtBQUFxQix1QkFBQXJCLEtBQUFtQyxVQUFBbkMsS0FBQW9DLFdBQUFwQyxLQUFBcUMsV0FBQXJDLEtBQUFzQyxXQUFBSixFQUFBZCxHQUVBdkIsZ0JBQUFxQyxHQUFBLEVBQUFkLEdBQ0EsT0FBQXBCLEtBQUFxQix1QkFDQXJCLEtBQUFtQyxVQUNBbkMsS0FBQW9DLFdBQ0FwQyxLQUFBcUMsV0FDQXJDLEtBQUFzQyxVQUNBdEMsS0FBQXVDLGVBQ0F2QyxLQUFBd0MsZUFDQXhDLEtBQUF5QyxlQUNBekMsS0FBQTBDLGdCQUNBUixFQUFBZCxHQUdBdkIsc0JBQUE4QyxFQUFBVCxHQUFBLEVBQUFkLEdBY0EsR0FiQXVCLElBQUFDLE9BQUFDLEtBQ0FBLElBRUF6QixLQUdBQSxHQUFBeUIsRUFBQUMsS0FBQUMsT0FBQTNCLElBQ0F5QixFQUhBQSxJQVFBRyxRQUFBQyxJQUFBLFFBQUFOLEtBQ0FBLEVBQUFPLE9BQUEsR0FLQSxPQUFBaEIsRUFDQVMsRUFBQVEsS0FBQUMsTUFBQUQsS0FBQUUsU0FBQVYsRUFBQU8sU0FHQVAsRUFBQSxHQVJBSyxRQUFBQyxJQUFBLFFBQUFOLEdBVUE5QyxhQUFBeUQsR0FDQSxJQUFBVCxFQUFBN0MsS0FBQUMsS0FBQXNELE1BQUE5RSxJQUF1QytCLEVBQVFDLE1BQUFULEtBQUFhLGlCQUFBYixLQUFBRyxPQUFBcUQsUUFBQUYsRUFBQXhDLElBQUF3QyxFQUFBdkMsT0FDL0MsR0FBQThCLEVBQ0EsT0FBQUEsR0FLQWpELEVBQVdjLHVCQUNOSyxJQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsS0FBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxLQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELEtBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxLQUFBLElBQ0FDLElBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxLQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLEtBQUEsRUFBQUQsS0FBQSxJQUNBQyxLQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxLQUFBLElBQ0FDLEtBQUEsRUFBQUQsSUFBQSxJQUNBQyxJQUFBLEVBQUFELEtBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsS0FBQSxFQUFBRCxJQUFBLElBQ0FDLElBQUEsRUFBQUQsS0FBQSxJQUNBQyxJQUFBLEVBQUFELElBQUEsSUFDQUMsSUFBQSxFQUFBRCxJQUFBLElBR0xsQixFQUFXK0IsU0FBWVosS0FBQSxFQUFBRCxJQUFBLEdBQ3ZCbEIsRUFBVzhCLFNBQVlYLElBQUEsRUFBQUQsSUFBQSxHQUN2QmxCLEVBQVdnQyxVQUFhYixJQUFBLEVBQUFELEtBQUEsR0FDeEJsQixFQUFXaUMsVUFBYWQsSUFBQSxFQUFBRCxJQUFBLEdBQ3hCbEIsRUFBV2tDLGNBQWlCZixLQUFBLEVBQUFELEtBQUEsR0FDNUJsQixFQUFXbUMsY0FBaUJoQixLQUFBLEVBQUFELElBQUEsR0FDNUJsQixFQUFXb0MsY0FBaUJqQixJQUFBLEVBQUFELEtBQUEsR0FDNUJsQixFQUFXcUMsY0FBaUJsQixJQUFBLEVBQUFELElBQUEsU0N6SmZOLEVBQ2JYLGFBQUE1QixHQUNBLFNBQWtCQSxFQUFBNkMsT0FBUzdDLEVBQUE4QyxNQUUzQmxCLGFBQUE0RCxHQUNBLElBQUFDLEVBQUFELEVBQUFFLE1BQUEsS0FDQSxPQUFnQjdDLElBQUE4QyxTQUFBRixFQUFBLElBQUEzQyxJQUFBNkMsU0FBQUYsRUFBQSxLQUVoQjdELDJCQUFBSSxFQUFBNEQsRUFBQUMsR0FDQSxJQUFBQyxFQUFBWixLQUFBQyxNQUFBRCxLQUFBRSxTQUFBUSxHQUNBRyxFQUFBYixLQUFBQyxNQUFBRCxLQUFBRSxTQUFBUyxHQUNBLFdBQW1CbEUsRUFBV0ssR0FBUWEsSUFBQWtELEVBQUFqRCxJQUFBZ0QsV0NaL0JFLEVBQ1BwRSxZQUFBcUUsRUFBQUMsRUFBQUMsR0FBQSxFQUFBQyxHQUFBLEVBQUFDLEVBQUEsR0FDQXRFLEtBQUE3QixLQUFBK0YsRUFDQWxFLEtBQUErQyxLQUFBb0IsRUFDQW5FLEtBQUF1RSxLQUFBRCxFQUNBdEUsS0FBQXdFLFNBQUFKLEVBQ0FwRSxLQUFBeUUsU0FBQUosRUFFQUUsU0FBQXJHLEdBQ0E4QixLQUFBc0UsTUFBQXBHLEVBRUFxRyxXQUNBLE9BQUF2RSxLQUFBc0UsTUFFQW5HLFNBQUFrQixHQUNBVyxLQUFBa0UsTUFBQTdFLEVBRUFsQixXQUNBLE9BQUE2QixLQUFBa0UsTUFFQW5CLFNBQUFqRSxHQUNBa0IsS0FBQW1FLE1BQUFyRixFQUVBaUUsV0FDQSxPQUFBL0MsS0FBQW1FLE1BRUFLLGFBQUF4RyxHQUNBZ0MsS0FBQW9FLFVBQUFwRyxFQUVBd0csZUFDQSxPQUFBeEUsS0FBQW9FLFVBRUFLLGFBQUFDLEdBQ0ExRSxLQUFBcUUsVUFBQUssRUFFQUQsZUFDQSxPQUFBekUsS0FBQXFFLFVBRUF4RSxLQUFBOEUsV0NwQ2FDLFVBQXFCWCxFQUNsQ3BFLGNBQ0FnRixNQUFjQyxFQUFZQyxNQUFBNUcsS0FBYTJHLEVBQVlDLE1BQUFoQyxNQUVuRGxELEtBQUE4RSxHQUNBRSxNQUFBRyxLQUFBTCxVQ0xhTSxVQUFtQmhCLEVBQ2hDcEUsY0FDQWdGLE1BQWNDLEVBQVlJLElBQUEvRyxLQUFXMkcsRUFBWUksSUFBQW5DLE1BRWpEbEQsS0FBQThFLEdBQ0FBLEVBQUF4RSxPQUFBZ0YsVUFBQVIsRUFBQVMsVUFBeUNOLEVBQVlDLFFBQ3JERixNQUFBRyxLQUFBTCxVQ0phVSxVQUFvQnBCLEVBQ2pDcEUsY0FDQWdGLE1BQWNDLEVBQVlRLEtBQUFuSCxLQUFZMkcsRUFBWVEsS0FBQXZDLE1BQ2xEL0MsS0FBQXVGLGNBQUEsSUFDQXZGLEtBQUF3RixhQUFBLEdBQ0F4RixLQUFBeUYsWUFBQSxHQUNBekYsS0FBQTBGLGNBQUEsR0FDQTFGLEtBQUEyRixhQUFBLEVBRUE5RixLQUFBOEUsR0FDQSxNQUFBaUIsRUFBQXpDLEtBQUFFLFNBQUFyRCxLQUFBdUYsY0FBQXZGLEtBQUF3RixhQUNBSyxFQUFBMUMsS0FBQUUsU0FBQXJELEtBQUF1RixjQUFBdkYsS0FBQXlGLFlBQ0FLLEVBQUEzQyxLQUFBRSxTQUFBckQsS0FBQXVGLGNBQUF2RixLQUFBMEYsY0FDQUssRUFBQTVDLEtBQUFFLFNBQUFyRCxLQUFBdUYsY0FBQXZGLEtBQUEyRixhQUNBSyxFQUFBckIsRUFBQXNCLGtCQUNBTCxHQUNBSSxFQUFBbEQsS0FBQW9ELEtBQUEsSUFBMENiLEVBQzFDckMsUUFBQUMsSUFBQSxlQUFBK0MsSUFFQUgsRUFFQUcsRUFBQWxELEtBQUFDLE9BQTRDK0IsRUFBWUMsUUFDeERpQixFQUFBbEQsS0FBQW9ELEtBQUEsSUFBOENqQixFQUM5Q2pDLFFBQUFDLElBQUEsY0FBQStDLElBR0FGLEVBQ0FFLEVBQUFsRCxLQUFBQyxPQUE0QytCLEVBQVlRLE9BQ3hEVSxFQUFBbEQsS0FBQW9ELEtBQUEsSUFBOEN0QixFQUM5QzVCLFFBQUFDLElBQUEsaUJBQUErQyxJQUdBRCxJQUNBQyxFQUFBbEQsS0FBQW9ELEtBQUEsSUFBMEN0QixFQUMxQzVCLFFBQUFDLElBQUEsZ0JBQUErQyxJQUdBckIsRUFBQXhFLE9BQUFnRixVQUFBUixFQUFBUyxVQUF5Q04sRUFBWUMsUUFDckRGLE1BQUFHLEtBQUFMLFVDdkNPRyxFQUNQakYsb0JBQUExQixFQUFBNEUsRUFBQTlFLEdBQ0ErQixLQUFBbUcsWUFBQUMsTUFBK0JqSSxPQUFBNEUsT0FBQXNELE1BQUFwSSxLQUcvQjZHLEVBQUFDLE9BQXNCNUcsS0FBQSxRQUFBNEUsS0FBQSxJQUFBc0QsTUFBa0N6QixHQUN4REUsRUFBQVEsTUFBcUJuSCxLQUFBLE9BQUE0RSxLQUFBLElBQUFzRCxNQUFpQ2hCLEdBQ3REUCxFQUFBSSxLQUFvQi9HLEtBQUEsTUFBQTRFLEtBQUEsSUFBQXNELE1BQWdDcEIsR0FDcERILEVBQUFxQixhQUFBckIsRUFBQUMsTUFBQUQsRUFBQVEsS0FBQVIsRUFBQUksV0NWYW9CLEVBQ2J6RyxZQUFBc0UsRUFBd0JXLEVBQVlDLE9BQ3BDL0UsS0FBQStDLEtBQUFvQixFQUNBbkUsS0FBQWtHLEtBQUEsSUFBQWxHLEtBQUErQyxLQUFBc0QsTUFFQXhHLEtBQUE4RSxHQUNBM0UsS0FBQWtHLEtBQUFsQixLQUFBTCxVQ0xhNEIsRUFDYjFHLFlBQUEyRyxHQUNBeEcsS0FBQXdELFFBQUFnRCxFQUNBeEcsS0FBQXlELEdBQWtCakQsRUFBUUMsTUFBQVQsS0FBQXdELFNBQzFCeEQsS0FBQWQsU0FFQVcsVUFBQTRHLElBQ0F6RyxLQUFBOEMsS0FBQTJELEVBQUEzRCxPQUFBMkQsRUFBQTNELEtBQUE5QyxLQUFBOEMsTUFFQWpELFNBQ0FHLEtBQUE4QyxLQUFBLElBQXdCd0QsR0NSeEIsSUFBQUksRUFBQSxVQ0RBN0csWUFBQThHLEVBQUEsRUFBQUMsRUFBQSxHQUNBNUcsS0FBQTZHLE1BQUFGLEVBQ0EzRyxLQUFBOEcsT0FBQUYsRUFDQTVHLEtBQUFkLFNBRUFXLGVBQUE1QixHQUNBLE9BQUErQixLQUFBdUQsTUFBQTlFLElBQThCK0IsRUFBUUMsTUFBQXhDLElBRXRDNEIsZ0JBQ0EsSUFBQW1FLEVBQUFiLEtBQUFDLE1BQUFELEtBQUFFLFNBQUFyRCxLQUFBOEcsUUFDQS9DLEVBQUFaLEtBQUFDLE1BQUFELEtBQUFFLFNBQUFyRCxLQUFBNkcsT0FDQSxPQUFBN0csS0FBQXVELE1BQUE5RSxPQUFpQ3VGLEtBQU1ELEtBRXZDbEUsU0FDQUcsS0FBQXVELE1BQUEsSUFBQWxELElBQ0EsUUFBQXpDLEVBQUEsRUFBdUJBLEVBQUFvQyxLQUFBNkcsTUFBZ0JqSixJQUV2QyxRQUFBbUosRUFBQSxFQUEyQkEsRUFBQS9HLEtBQUE4RyxPQUFpQkMsSUFFNUMvRyxLQUFBdUQsTUFBQWhELE9BQWtDd0csS0FBS25KLElBQUUsSUFBTzJJLEdBQU16RixJQUFBaUcsRUFBQWhHLElBQUFuRCxPRGxCdEMsT0FDaEJvRixRQUFBQyxJQUFBeUQsR0FDQTFELFFBQUFDLElBQUF5RCxFQUFBTSxpQkFDQU4sRUFBQU0sZ0JBQUFsRSxLQUFBb0QsS0FBQSxJQUFrQ2IsRUFDbENxQixFQUFBTSxnQkFBQWxFLEtBQUFvRCxLQUFBLElBQWtDYixFQUNsQ3FCLEVBQUFNLGdCQUFBbEUsS0FBQW9ELEtBQUEsSUFBa0NiLEVBQ2xDcUIsRUFBQU0sZ0JBQUFsRSxLQUFBb0QsS0FBQSxJQUFrQ2IsRUE0Q2xDLElBQUE0QixHQTNDQXZILElBRUFBLEVBQUF3SCxRQUFBLFNBQ0F4SCxFQUFBeUgsTUFBQSxNQUNBekgsRUFBQTBILGFBQUEsV0FpQ0ExSCxFQUFBMkgsS0FBQSxNQUNBM0gsRUFBQTRILFdBQUEsS0E3QkEsRUFBQTVILEVBQUFaLEtBQ0FZLEVBQUEwRyxPQUNBMUcsRUFBQTZILFVBQUEsT0FDQXpJLEVBQUF5RSxNQUFBdkMsUUFBQTZCLElBQ0EsT0FBQUEsRUFBQUMsS0FBQW9ELEtBQUFuRCxNQUNBLEtBQXFCK0IsRUFBWUMsTUFBQWhDLEtBQ2pDckQsRUFBQThILEtBQUEsSUFDQSxNQUNBLEtBQXFCMUMsRUFBWVEsS0FBQXZDLEtBQ2pDckQsRUFBQThILEtBQUEsV0FDQSxNQUNBLEtBQXFCMUMsRUFBWUksSUFBQW5DLEtBQ2pDckQsRUFBQThILEtBQUEsV0FHQTlILEVBQUErSCxPQUFBLEdBQ0EvSCxFQUFBZ0ksUUF4QkEsR0F3QkE3RSxFQUFBVyxRQUFBekMsSUF4QkEsR0F3QkE4QixFQUFBVyxRQUFBMUMsSUF4QkEsU0EwQkFwQixFQUFBaUksT0FZQUMsQ0FBQWxJLEVBQUFnSCxHQVZBLE1BRUEsUUFBQTlJLEVBQUEsRUFBdUJBLEVBRHZCLElBQ2tDQSxJQUFBLENBQ2xDLElBQUErRyxFQUFxQm5FLEVBQVFxSCxvQkFBQW5CLElBQUFHLE1BQUFILEVBQUFJLFFBRTdCbkMsRUFBQXhFLE9BQUEyQyxLQUFBa0MsS0FBQUwsS0FNQW1EIiwiZmlsZSI6Im1mbS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG4vL0V2ZW50IHdpbmRvdyBhcyBkZXNjcmliYmVkIGhlcmU6IGh0dHA6Ly9yb2J1c3QuY3MudW5tLmVkdS9saWIvZXhlL2ZldGNoLnBocD93PTMwMCZ0b2s9NGM4ZjQ5Jm1lZGlhPWRldjpldmVudC13aW5kb3ctMTAucG5nXG4vL0NvbGxlY3Rpb24gb2Ygc2l0ZXMgd2hpY2ggY29udGFpbiBhdG9tcywgYnVpbHQgZnJvbSBhbiBvcmlnaW4gKGNlbnRlcikgc2l0ZVxuZXhwb3J0IGNsYXNzIEV2ZW50V2luZG93IHtcbiAgICBjb25zdHJ1Y3RvcihfdGlsZSwgX29yaWdpbikge1xuICAgICAgICB0aGlzLnRpbGUgPSBfdGlsZTtcbiAgICAgICAgdGhpcy5tYWtlV2luZG93KF90aWxlLCBfb3JpZ2luKTtcbiAgICB9XG4gICAgbWFrZVdpbmRvdyh0aWxlLCBvcmlnaW4pIHtcbiAgICAgICAgdGhpcy53aW5kb3cgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMub3JpZ2luID0gdGhpcy50aWxlLmdldFNpdGVCeUNvb3JkKG9yaWdpbik7XG4gICAgICAgIHRoaXMud2luZG93LnNldChNRk1VdGlscy5DdG9JRChvcmlnaW4pLCB0aGlzLm9yaWdpbik7XG4gICAgICAgIGxldCB3aW5kb3dBcnJheSA9IEV2ZW50V2luZG93LldJTkRPV19PUkRFUl9PRkZTRVRTLm1hcCgob2Zmc2V0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5PZmZzZXRGcm9tT3JpZ2luKG9yaWdpbiwgb2Zmc2V0LnJvdywgb2Zmc2V0LmNvbCk7XG4gICAgICAgIH0pO1xuICAgICAgICB3aW5kb3dBcnJheS5mb3JFYWNoKCh0aWxlQ29vcmQpID0+IHtcbiAgICAgICAgICAgIGlmICh0aWxlLmdldFNpdGVCeUNvb3JkKHRpbGVDb29yZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy5zZXQoTUZNVXRpbHMuQ3RvSUQodGlsZUNvb3JkKSwgdGlsZS5nZXRTaXRlQnlDb29yZCh0aWxlQ29vcmQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIE9mZnNldEZyb21PcmlnaW4ob3JpZ2luLCByb3dPZmZzZXQsIGNvbE9mZnNldCkge1xuICAgICAgICByZXR1cm4geyByb3c6IG9yaWdpbi5yb3cgKyByb3dPZmZzZXQsIGNvbDogb3JpZ2luLmNvbCArIGNvbE9mZnNldCB9O1xuICAgIH1cbiAgICBnZXRSYW5kb20oc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNpdGVGcm9tQ2FuZGlkYXRlcyhBcnJheS5mcm9tKHRoaXMud2luZG93LnZhbHVlcygpKSwgdHJ1ZSwgc3BlY2lmaWNUeXBlKTtcbiAgICB9XG4gICAgZ2V0TmVhcmVzdChzcGVjaWZpY1R5cGUgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2l0ZUZyb21DYW5kaWRhdGVzKEFycmF5LmZyb20odGhpcy53aW5kb3cudmFsdWVzKCkpLCBmYWxzZSwgc3BlY2lmaWNUeXBlKTtcbiAgICB9XG4gICAgZ2V0RWFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX0VBU1QpO1xuICAgIH1cbiAgICBnZXRXZXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfV0VTVCk7XG4gICAgfVxuICAgIGdldE5vcnRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfTk9SVEgpO1xuICAgIH1cbiAgICBnZXRTb3V0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1NPVVRIKTtcbiAgICB9XG4gICAgZ2V0Tm9ydGhXZXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfTk9SVEhXRVNUKTtcbiAgICB9XG4gICAgZ2V0U291dGhXZXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfU09VVEhXRVNUKTtcbiAgICB9XG4gICAgZ2V0Tm9ydGhFYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfTk9SVEhFQVNUKTtcbiAgICB9XG4gICAgZ2V0U291dGhFYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXREaXJlY3Rpb24oRXZlbnRXaW5kb3cuRVdfU09VVEhFQVNUKTtcbiAgICB9XG4gICAgZ2V0QWRqYWNlbnQ0V2F5KHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCwgcmFuZG9taXplID0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTaXRlRnJvbUNhbmRpZGF0ZXMoW3RoaXMuZ2V0V2VzdCgpLCB0aGlzLmdldE5vcnRoKCksIHRoaXMuZ2V0U291dGgoKSwgdGhpcy5nZXRFYXN0KCldLCByYW5kb21pemUsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIGdldEFkamFjZW50OFdheShyYW5kb21pemUgPSB0cnVlLCBzcGVjaWZpY1R5cGUgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2l0ZUZyb21DYW5kaWRhdGVzKFtcbiAgICAgICAgICAgIHRoaXMuZ2V0V2VzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXROb3J0aCgpLFxuICAgICAgICAgICAgdGhpcy5nZXRTb3V0aCgpLFxuICAgICAgICAgICAgdGhpcy5nZXRFYXN0KCksXG4gICAgICAgICAgICB0aGlzLmdldE5vcnRoV2VzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXRTb3V0aFdlc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0Tm9ydGhFYXN0KCksXG4gICAgICAgICAgICB0aGlzLmdldFNvdXRoRWFzdCgpXG4gICAgICAgIF0sIHJhbmRvbWl6ZSwgc3BlY2lmaWNUeXBlKTtcbiAgICB9XG4gICAgLy9HaXZlbiBhbiBhcnJheSBvZiBjYW5kaWRhdGUgc2l0ZXMgKHN5bW1ldHJpZXMgaW4gdGhlIGZ1dHVyZSBJIGhvcGUpLCBnaXZlIG1lIGJhY2sgb25lLCByYW5kb20gYnkgZGVmYXVsdCwgbm90IGZpbHRlcmVkIGJ5IHR5cGUgYnkgZGVmYXVsdFxuICAgIGdldFNpdGVGcm9tQ2FuZGlkYXRlcyhjYW5kaWRhdGVTaXRlcywgcmFuZG9taXplID0gdHJ1ZSwgc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNhbmRpZGF0ZVNpdGVzID0gY2FuZGlkYXRlU2l0ZXMuZmlsdGVyKHNpdGUgPT4ge1xuICAgICAgICAgICAgaWYgKCFzaXRlKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc3BlY2lmaWNUeXBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNpdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzcGVjaWZpY1R5cGUgJiYgc2l0ZS5hdG9tLnR5cGUgPT09IHNwZWNpZmljVHlwZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzaXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgLy9ubyBzaXRlcyEgeWlrZXMhIHBvc3NpYmxlIT8hIHByb2JhYmx5IG9ubHkgd2hlbiB1c2luZyBzcGVjaWZpY1R5cGUgYW5kIGxvb2tpbmcgZm9yIGEgcmFyZSBlbGVtZW50XG4gICAgICAgIGNvbnNvbGUubG9nKFwieWlrZXNcIiwgY2FuZGlkYXRlU2l0ZXMpO1xuICAgICAgICBpZiAoY2FuZGlkYXRlU2l0ZXMubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ5aWtlc1wiLCBjYW5kaWRhdGVTaXRlcyk7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIC8vcmV0dXJuIHJhbmRvbVxuICAgICAgICBpZiAocmFuZG9taXplKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FuZGlkYXRlU2l0ZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2FuZGlkYXRlU2l0ZXMubGVuZ3RoKV07XG4gICAgICAgIH1cbiAgICAgICAgLy9yZXR1cm4gZmlyc3QgbWF0Y2hpbmdcbiAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZVNpdGVzWzBdO1xuICAgIH1cbiAgICBnZXREaXJlY3Rpb24oZGlyZWN0aW9uKSB7XG4gICAgICAgIGxldCBzaXRlID0gdGhpcy50aWxlLnNpdGVzLmdldChNRk1VdGlscy5DdG9JRCh0aGlzLk9mZnNldEZyb21PcmlnaW4odGhpcy5vcmlnaW4udGlsZVBvcywgZGlyZWN0aW9uLnJvdywgZGlyZWN0aW9uLmNvbCkpKTtcbiAgICAgICAgaWYgKHNpdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBzaXRlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxufVxuRXZlbnRXaW5kb3cuV0lORE9XX09SREVSX09GRlNFVFMgPSBbXG4gICAgeyBjb2w6IDAsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMCwgcm93OiAxIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAtMSwgcm93OiAxIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMSwgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0yLCByb3c6IDAgfSxcbiAgICB7IGNvbDogMCwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAwLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMiwgcm93OiAwIH0sXG4gICAgeyBjb2w6IC0yLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IC0yLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogLTIgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMiB9LFxuICAgIHsgY29sOiAxLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMiB9LFxuICAgIHsgY29sOiAyLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtMywgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTMgfSxcbiAgICB7IGNvbDogMCwgcm93OiAzIH0sXG4gICAgeyBjb2w6IDMsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAtMiB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAyIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogLTIgfSxcbiAgICB7IGNvbDogMiwgcm93OiAyIH0sXG4gICAgeyBjb2w6IC0zLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IC0zLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogLTMgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMyB9LFxuICAgIHsgY29sOiAxLCByb3c6IC0zIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMyB9LFxuICAgIHsgY29sOiAzLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDMsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtNCwgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTQgfSxcbiAgICB7IGNvbDogMCwgcm93OiA0IH0sXG4gICAgeyBjb2w6IDQsIHJvdzogMCB9XG5dO1xuLy9iZWNhdXNlLCBsYXp5XG5FdmVudFdpbmRvdy5FV19XRVNUID0geyBjb2w6IC0xLCByb3c6IDAgfTtcbkV2ZW50V2luZG93LkVXX0VBU1QgPSB7IGNvbDogMSwgcm93OiAwIH07XG5FdmVudFdpbmRvdy5FV19OT1JUSCA9IHsgY29sOiAwLCByb3c6IC0xIH07XG5FdmVudFdpbmRvdy5FV19TT1VUSCA9IHsgY29sOiAwLCByb3c6IDEgfTtcbkV2ZW50V2luZG93LkVXX05PUlRIV0VTVCA9IHsgY29sOiAtMSwgcm93OiAtMSB9O1xuRXZlbnRXaW5kb3cuRVdfU09VVEhXRVNUID0geyBjb2w6IC0xLCByb3c6IDEgfTtcbkV2ZW50V2luZG93LkVXX05PUlRIRUFTVCA9IHsgY29sOiAxLCByb3c6IC0xIH07XG5FdmVudFdpbmRvdy5FV19TT1VUSEVBU1QgPSB7IGNvbDogMSwgcm93OiAxIH07XG4iLCJpbXBvcnQgeyBFdmVudFdpbmRvdyB9IGZyb20gXCIuLi9jbGFzc2VzL0V2ZW50d2luZG93XCI7XG5leHBvcnQgY2xhc3MgTUZNVXRpbHMge1xuICAgIHN0YXRpYyBDdG9JRChjKSB7XG4gICAgICAgIHJldHVybiBgJHtjLnJvd306JHtjLmNvbH1gO1xuICAgIH1cbiAgICBzdGF0aWMgSUR0b0MoaWQpIHtcbiAgICAgICAgbGV0IHJjYSA9IGlkLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgcmV0dXJuIHsgcm93OiBwYXJzZUludChyY2FbMF0pLCBjb2w6IHBhcnNlSW50KHJjYVsxXSkgfTtcbiAgICB9XG4gICAgc3RhdGljIEdlbmVyYXRlRXZlbnRXaW5kb3codGlsZSwgdywgaCkge1xuICAgICAgICBsZXQgcmMgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB3KTtcbiAgICAgICAgbGV0IHJyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaCk7XG4gICAgICAgIHJldHVybiBuZXcgRXZlbnRXaW5kb3codGlsZSwgeyByb3c6IHJyLCBjb2w6IHJjIH0pO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBFbGVtIHtcbiAgICBjb25zdHJ1Y3RvcihfbmFtZSwgX3R5cGUsIF9tb3ZlYWJsZSA9IHRydWUsIF9raWxsYWJsZSA9IHRydWUsIF9kYXRhID0gMCkge1xuICAgICAgICB0aGlzLm5hbWUgPSBfbmFtZTtcbiAgICAgICAgdGhpcy50eXBlID0gX3R5cGU7XG4gICAgICAgIHRoaXMuZGF0YSA9IF9kYXRhO1xuICAgICAgICB0aGlzLm1vdmVhYmxlID0gX21vdmVhYmxlO1xuICAgICAgICB0aGlzLmtpbGxhYmxlID0gX2tpbGxhYmxlO1xuICAgIH1cbiAgICBzZXQgZGF0YShkKSB7XG4gICAgICAgIHRoaXMuX2RhdGEgPSBkO1xuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7XG4gICAgfVxuICAgIHNldCBuYW1lKG4pIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IG47XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgICB9XG4gICAgc2V0IHR5cGUodCkge1xuICAgICAgICB0aGlzLl90eXBlID0gdDtcbiAgICB9XG4gICAgZ2V0IHR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgIH1cbiAgICBzZXQgbW92ZWFibGUobSkge1xuICAgICAgICB0aGlzLl9tb3ZlYWJsZSA9IG07XG4gICAgfVxuICAgIGdldCBtb3ZlYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21vdmVhYmxlO1xuICAgIH1cbiAgICBzZXQga2lsbGFibGUoaykge1xuICAgICAgICB0aGlzLl9raWxsYWJsZSA9IGs7XG4gICAgfVxuICAgIGdldCBraWxsYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tpbGxhYmxlO1xuICAgIH1cbiAgICBleGVjKGV3KSB7IH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIEVtcHR5RWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuRU1QVFkubmFtZSwgRWxlbWVudFR5cGVzLkVNUFRZLnR5cGUpO1xuICAgIH1cbiAgICBleGVjKGV3KSB7XG4gICAgICAgIHN1cGVyLmV4ZWMoZXcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEVsZW0gfSBmcm9tIFwiLi4vRWxlbVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4uL0VsZW1lbnRUeXBlc1wiO1xuZXhwb3J0IGNsYXNzIFJlc0VsZW1lbnQgZXh0ZW5kcyBFbGVtIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoRWxlbWVudFR5cGVzLlJFUy5uYW1lLCBFbGVtZW50VHlwZXMuUkVTLnR5cGUpO1xuICAgIH1cbiAgICBleGVjKGV3KSB7XG4gICAgICAgIGV3Lm9yaWdpbi5zd2FwQXRvbXMoZXcuZ2V0UmFuZG9tKEVsZW1lbnRUeXBlcy5FTVBUWSkpO1xuICAgICAgICBzdXBlci5leGVjKGV3KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFbGVtIH0gZnJvbSBcIi4uL0VsZW1cIjtcbmltcG9ydCB7IEVsZW1lbnRUeXBlcyB9IGZyb20gXCIuLi9FbGVtZW50VHlwZXNcIjtcbmltcG9ydCB7IEVtcHR5RWxlbWVudCB9IGZyb20gXCIuL0VtcHR5RWxlbWVudFwiO1xuaW1wb3J0IHsgUmVzRWxlbWVudCB9IGZyb20gXCIuL1Jlc0VsZW1lbnRcIjtcbmV4cG9ydCBjbGFzcyBEUmVnRWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuRFJFRy5uYW1lLCBFbGVtZW50VHlwZXMuRFJFRy50eXBlKTtcbiAgICAgICAgdGhpcy5wVE9UQUxfQ0hBTkNFID0gMTAwO1xuICAgICAgICB0aGlzLnBEUkVHX0NSRUFURSA9IDAuMTtcbiAgICAgICAgdGhpcy5wUkVTX0NSRUFURSA9IDAuNTtcbiAgICAgICAgdGhpcy5wRFJFR19ERVNUUk9ZID0gMTA7XG4gICAgICAgIHRoaXMucEFOWV9ERVNUUk9ZID0gMTtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICBjb25zdCBjcmVhdGVEUmVnID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucERSRUdfQ1JFQVRFO1xuICAgICAgICBjb25zdCBjcmVhdGVSZXMgPSBNYXRoLnJhbmRvbSgpICogdGhpcy5wVE9UQUxfQ0hBTkNFIDwgdGhpcy5wUkVTX0NSRUFURTtcbiAgICAgICAgY29uc3QgZGVzdHJveURSZWcgPSBNYXRoLnJhbmRvbSgpICogdGhpcy5wVE9UQUxfQ0hBTkNFIDwgdGhpcy5wRFJFR19ERVNUUk9ZO1xuICAgICAgICBjb25zdCBkZXN0cm95QW55ID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucEFOWV9ERVNUUk9ZO1xuICAgICAgICBjb25zdCBhdmFpbGFibGVTaXRlID0gZXcuZ2V0QWRqYWNlbnQ0V2F5KCk7XG4gICAgICAgIGlmIChjcmVhdGVEUmVnKSB7XG4gICAgICAgICAgICBhdmFpbGFibGVTaXRlLmF0b20uZWxlbSA9IG5ldyBEUmVnRWxlbWVudCgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJEUkVHIENSRUFURURcIiwgYXZhaWxhYmxlU2l0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY3JlYXRlUmVzKSB7XG4gICAgICAgICAgICAvL21ha2UgcmVzXG4gICAgICAgICAgICBpZiAoYXZhaWxhYmxlU2l0ZS5hdG9tLnR5cGUgPT09IEVsZW1lbnRUeXBlcy5FTVBUWSkge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbS5lbGVtID0gbmV3IFJlc0VsZW1lbnQoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJFUyBDUkVBVEVEXCIsIGF2YWlsYWJsZVNpdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRlc3Ryb3lEUmVnKSB7XG4gICAgICAgICAgICBpZiAoYXZhaWxhYmxlU2l0ZS5hdG9tLnR5cGUgPT09IEVsZW1lbnRUeXBlcy5EUkVHKSB7XG4gICAgICAgICAgICAgICAgYXZhaWxhYmxlU2l0ZS5hdG9tLmVsZW0gPSBuZXcgRW1wdHlFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEUkVHIERFU1RST1lFRFwiLCBhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZXN0cm95QW55KSB7XG4gICAgICAgICAgICBhdmFpbGFibGVTaXRlLmF0b20uZWxlbSA9IG5ldyBFbXB0eUVsZW1lbnQoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQU5ZIERFU1RST1lFRFwiLCBhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgfVxuICAgICAgICAvL21vdmUgdG8gcmFuZG9tIGVtcHR5XG4gICAgICAgIGV3Lm9yaWdpbi5zd2FwQXRvbXMoZXcuZ2V0UmFuZG9tKEVsZW1lbnRUeXBlcy5FTVBUWSkpO1xuICAgICAgICBzdXBlci5leGVjKGV3KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFbXB0eUVsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9FbXB0eUVsZW1lbnRcIjtcbmltcG9ydCB7IERSZWdFbGVtZW50IH0gZnJvbSBcIi4vZWxlbWVudHMvRFJlZ0VsZW1lbnRcIjtcbmltcG9ydCB7IFJlc0VsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9SZXNFbGVtZW50XCI7XG5leHBvcnQgY2xhc3MgRWxlbWVudFR5cGVzIHtcbiAgICBzdGF0aWMgcmVnaXN0ZXJUeXBlKG5hbWUsIHR5cGUsIGMpIHtcbiAgICAgICAgdGhpcy5UWVBFU19BUlJBWS5wdXNoKHsgbmFtZSwgdHlwZSwgY2xhc3M6IGMgfSk7XG4gICAgfVxufVxuRWxlbWVudFR5cGVzLkVNUFRZID0geyBuYW1lOiBcIkVNUFRZXCIsIHR5cGU6IFwiRVwiLCBjbGFzczogRW1wdHlFbGVtZW50IH07XG5FbGVtZW50VHlwZXMuRFJFRyA9IHsgbmFtZTogXCJEUkVHXCIsIHR5cGU6IFwiRFwiLCBjbGFzczogRFJlZ0VsZW1lbnQgfTtcbkVsZW1lbnRUeXBlcy5SRVMgPSB7IG5hbWU6IFwiUkVTXCIsIHR5cGU6IFwiUlwiLCBjbGFzczogUmVzRWxlbWVudCB9O1xuRWxlbWVudFR5cGVzLlRZUEVTX0FSUkFZID0gW0VsZW1lbnRUeXBlcy5FTVBUWSwgRWxlbWVudFR5cGVzLkRSRUcsIEVsZW1lbnRUeXBlcy5SRVNdO1xuIiwiaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgQXRvbSB7XG4gICAgY29uc3RydWN0b3IoX3R5cGUgPSBFbGVtZW50VHlwZXMuRU1QVFkpIHtcbiAgICAgICAgdGhpcy50eXBlID0gX3R5cGU7XG4gICAgICAgIHRoaXMuZWxlbSA9IG5ldyB0aGlzLnR5cGUuY2xhc3MoKTtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICB0aGlzLmVsZW0uZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTUZNVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IEF0b20gfSBmcm9tIFwiLi9BdG9tXCI7XG5leHBvcnQgY2xhc3MgU2l0ZSB7XG4gICAgY29uc3RydWN0b3IoX3Bvcykge1xuICAgICAgICB0aGlzLnRpbGVQb3MgPSBfcG9zO1xuICAgICAgICB0aGlzLmlkID0gTUZNVXRpbHMuQ3RvSUQodGhpcy50aWxlUG9zKTtcbiAgICAgICAgdGhpcy5jcmVhdGUoKTtcbiAgICB9XG4gICAgc3dhcEF0b21zKHRhcmdldFNpdGUpIHtcbiAgICAgICAgW3RoaXMuYXRvbSwgdGFyZ2V0U2l0ZS5hdG9tXSA9IFt0YXJnZXRTaXRlLmF0b20sIHRoaXMuYXRvbV07XG4gICAgfVxuICAgIGNyZWF0ZSgpIHtcbiAgICAgICAgdGhpcy5hdG9tID0gbmV3IEF0b20oKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBUaWxlIH0gZnJvbSBcIi4vbWZtL2NsYXNzZXMvVGlsZVwiO1xuaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4vbWZtL2NsYXNzZXMvRWxlbWVudFR5cGVzXCI7XG5pbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuL21mbS91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgRFJlZ0VsZW1lbnQgfSBmcm9tIFwiLi9tZm0vY2xhc3Nlcy9lbGVtZW50cy9EUmVnRWxlbWVudFwiO1xubGV0IGcgPSBuZXcgVGlsZSgzMCwgMzApO1xuY29uc29sZS5sb2coZyk7XG5jb25zb2xlLmxvZyhnLmdldFJhbmRvbVNpdGUoKSk7XG5nLmdldFJhbmRvbVNpdGUoKS5hdG9tLmVsZW0gPSBuZXcgRFJlZ0VsZW1lbnQoKTtcbmcuZ2V0UmFuZG9tU2l0ZSgpLmF0b20uZWxlbSA9IG5ldyBEUmVnRWxlbWVudCgpO1xuZy5nZXRSYW5kb21TaXRlKCkuYXRvbS5lbGVtID0gbmV3IERSZWdFbGVtZW50KCk7XG5nLmdldFJhbmRvbVNpdGUoKS5hdG9tLmVsZW0gPSBuZXcgRFJlZ0VsZW1lbnQoKTtcbnZhciBza2V0Y2ggPSAocCkgPT4ge1xuICAgIGxldCBzaXRlU2l6ZSA9IDEyO1xuICAgIHAucHJlbG9hZCA9ICgpID0+IHsgfTtcbiAgICBwLnNldHVwID0gKCkgPT4ge1xuICAgICAgICBwLmNyZWF0ZUNhbnZhcyg4MDAsIDgwMCk7XG4gICAgfTtcbiAgICAvLyAgIHAud2luZG93UmVzaXplZCA9ICgpID0+IHtcbiAgICAvLyAgICAgcC5yZXNpemVDYW52YXMocC53aW5kb3dXaWR0aCAtIDUwLCBwLndpbmRvd0hlaWdodCAtIDUwKTtcbiAgICAvLyAgIH07XG4gICAgbGV0IGRyYXdHcmlkID0gKHAsIHQpID0+IHtcbiAgICAgICAgcC5wdXNoKCk7XG4gICAgICAgIHAudHJhbnNsYXRlKDUwLCA1MCk7XG4gICAgICAgIHQuc2l0ZXMuZm9yRWFjaCgoc2l0ZSkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChzaXRlLmF0b20uZWxlbS50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBFbGVtZW50VHlwZXMuRU1QVFkudHlwZTpcbiAgICAgICAgICAgICAgICAgICAgcC5maWxsKDMyKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBFbGVtZW50VHlwZXMuRFJFRy50eXBlOlxuICAgICAgICAgICAgICAgICAgICBwLmZpbGwoMjU1LCAzMiwgMzIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIEVsZW1lbnRUeXBlcy5SRVMudHlwZTpcbiAgICAgICAgICAgICAgICAgICAgcC5maWxsKDMyLCAyNTUsIDY0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwLnN0cm9rZSgwKTtcbiAgICAgICAgICAgIHAuZWxsaXBzZShzaXRlLnRpbGVQb3MuY29sICogc2l0ZVNpemUsIHNpdGUudGlsZVBvcy5yb3cgKiBzaXRlU2l6ZSwgc2l0ZVNpemUsIHNpdGVTaXplKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHAucG9wKCk7XG4gICAgfTtcbiAgICBsZXQgcnVuID0gKCkgPT4ge1xuICAgICAgICBsZXQgc3BlZWQgPSAxMDAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwZWVkOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBldyA9IE1GTVV0aWxzLkdlbmVyYXRlRXZlbnRXaW5kb3coZywgZy53aWR0aCwgZy5oZWlnaHQpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhldyk7XG4gICAgICAgICAgICBldy5vcmlnaW4uYXRvbS5leGVjKGV3KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcC5kcmF3ID0gKCkgPT4ge1xuICAgICAgICBwLmJhY2tncm91bmQoMTAwKTtcbiAgICAgICAgZHJhd0dyaWQocCwgZyk7XG4gICAgICAgIHJ1bigpO1xuICAgIH07XG59O1xubGV0IHNrZXRjaFAgPSBuZXcgcDUoc2tldGNoKTtcbiIsImltcG9ydCB7IFNpdGUgfSBmcm9tIFwiLi9TaXRlXCI7XG5pbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuZXhwb3J0IGNsYXNzIFRpbGUge1xuICAgIGNvbnN0cnVjdG9yKF93aWR0aCA9IDEsIF9oZWlnaHQgPSAxKSB7XG4gICAgICAgIHRoaXMud2lkdGggPSBfd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gX2hlaWdodDtcbiAgICAgICAgdGhpcy5jcmVhdGUoKTtcbiAgICB9XG4gICAgZ2V0U2l0ZUJ5Q29vcmQoYykge1xuICAgICAgICByZXR1cm4gdGhpcy5zaXRlcy5nZXQoTUZNVXRpbHMuQ3RvSUQoYykpO1xuICAgIH1cbiAgICBnZXRSYW5kb21TaXRlKCkge1xuICAgICAgICBsZXQgcnIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLmhlaWdodCk7XG4gICAgICAgIGxldCByYyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMud2lkdGgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zaXRlcy5nZXQoYCR7cnJ9OiR7cmN9YCk7XG4gICAgfVxuICAgIGNyZWF0ZSgpIHtcbiAgICAgICAgdGhpcy5zaXRlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLndpZHRoOyBpKyspIHtcbiAgICAgICAgICAgIC8vYWNyb3NzIGNvbHVtbnNcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5oZWlnaHQ7IGorKykge1xuICAgICAgICAgICAgICAgIC8vZG93biByb3dzXG4gICAgICAgICAgICAgICAgdGhpcy5zaXRlcy5zZXQoYCR7an06JHtpfWAsIG5ldyBTaXRlKHsgcm93OiBqLCBjb2w6IGkgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==