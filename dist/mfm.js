!function(t){var e={};function o(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(r,s,function(e){return t[e]}.bind(null,s));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);class r{constructor(t,e){this.tile=t,this.makeWindow(t,e)}makeWindow(t,e){this.window=new Map,this.origin=this.tile.getSiteByCoord(e),this.window.set(this.origin.id,this.origin),r.WINDOW_ORDER_OFFSETS.map(t=>this.OffsetFromOrigin(e,t.row,t.col)).forEach(e=>{let o=t.getSiteByCoord(e);o&&this.window.set(o.id,o)})}OffsetFromOrigin(t,e,o){return{row:t.row+e,col:t.col+o}}getRandom(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!0,t)}getNearest(t){return this.getSiteFromCandidates(Array.from(this.window.values()),!1,t)}getEast(){return this.getDirection(r.EW_EAST)}getWest(){return this.getDirection(r.EW_WEST)}getNorth(){return this.getDirection(r.EW_NORTH)}getSouth(){return this.getDirection(r.EW_SOUTH)}getNorthWest(){return this.getDirection(r.EW_NORTHWEST)}getSouthWest(){return this.getDirection(r.EW_SOUTHWEST)}getNorthEast(){return this.getDirection(r.EW_NORTHEAST)}getSouthEast(){return this.getDirection(r.EW_SOUTHEAST)}getAdjacent4Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast()],t,e)}getAdjacent8Way(t=!0,e){return this.getSiteFromCandidates([this.getWest(),this.getNorth(),this.getSouth(),this.getEast(),this.getNorthWest(),this.getSouthWest(),this.getNorthEast(),this.getSouthEast()],t,e)}getSiteFromCandidates(t,e=!0,o){if(!((t=t.filter(t=>!!t&&(o?!(!o||t.atom.type!==o)&&t:t))).length<1))return e?t[Math.floor(Math.random()*t.length)]:t[0]}getDirection(t){let e=this.tile.sites.get(s.CtoID(this.OffsetFromOrigin(this.origin.tilePos,t.row,t.col)));if(e)return e}}r.WINDOW_ORDER_OFFSETS=[{col:0,row:0},{col:-1,row:0},{col:0,row:-1},{col:0,row:1},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1},{col:-2,row:0},{col:0,row:-1},{col:0,row:2},{col:2,row:0},{col:-2,row:-1},{col:-2,row:1},{col:-1,row:-2},{col:-1,row:2},{col:1,row:-2},{col:1,row:2},{col:2,row:-1},{col:2,row:1},{col:-3,row:0},{col:0,row:-3},{col:0,row:3},{col:3,row:0},{col:-2,row:-2},{col:-2,row:2},{col:2,row:-2},{col:2,row:2},{col:-3,row:-1},{col:-3,row:1},{col:-1,row:-3},{col:-1,row:3},{col:1,row:-3},{col:1,row:3},{col:3,row:-1},{col:3,row:1},{col:-4,row:0},{col:0,row:-4},{col:0,row:4},{col:4,row:0}],r.EW_WEST={col:-1,row:0},r.EW_EAST={col:1,row:0},r.EW_NORTH={col:0,row:-1},r.EW_SOUTH={col:0,row:1},r.EW_NORTHWEST={col:-1,row:-1},r.EW_SOUTHWEST={col:-1,row:1},r.EW_NORTHEAST={col:1,row:-1},r.EW_SOUTHEAST={col:1,row:1};class s{static CtoID(t){return`${t.row}:${t.col}`}static IDtoC(t){let e=t.split(":");return{row:parseInt(e[0]),col:parseInt(e[1])}}static GenerateEventWindow(t,e,o){let s=Math.floor(Math.random()*e),i=Math.floor(Math.random()*o);return new r(t,{row:i,col:s})}}class i{constructor(t,e,o=!0,r=!0,s=0){this.name=t,this.type=e,this.data=s,this.moveable=o,this.killable=r}set data(t){this._data=t}get data(){return this._data}set name(t){this._name=t}get name(){return this._name}set type(t){this._type=t}get type(){return this._type}set moveable(t){this._moveable=t}get moveable(){return this._moveable}set killable(t){this._killable=t}get killable(){return this._killable}exec(t){}}class n{static registerType(t,e,o){this.TYPES_ARRAY.push({name:t,type:e,class:o})}}n.EMPTY={name:"EMPTY",type:"E",class:class extends i{constructor(){super(n.EMPTY.name,n.EMPTY.type)}exec(t){super.exec(t)}}},n.DREG={name:"DREG",type:"D",class:class extends i{constructor(){super(n.DREG.name,n.DREG.type),this.pTOTAL_CHANCE=100,this.pDREG_CREATE=.1,this.pRES_CREATE=.5,this.pDREG_DESTROY=10,this.pANY_DESTROY=1}exec(t){const e=t.getAdjacent4Way();if(e.atom.type===n.EMPTY){const o=Math.random()*this.pTOTAL_CHANCE<this.pDREG_CREATE,r=Math.random()*this.pTOTAL_CHANCE<this.pRES_CREATE;o?(e.atom=new a(n.DREG),console.log("DREG CREATED")):r&&(e.atom=new a(n.RES),console.log("RES CREATED")),t.origin.swapAtoms(e)}else e.atom.type===n.DREG?Math.random()*this.pTOTAL_CHANCE<this.pDREG_DESTROY&&(e.atom=new a(n.EMPTY),console.log("DREG DESTROYED"),t.origin.swapAtoms(e)):Math.random()*this.pTOTAL_CHANCE<this.pANY_DESTROY&&(console.log(e.atom.type.name+" DESTROYED"),e.atom=new a(n.EMPTY),t.origin.swapAtoms(e));super.exec(t)}}},n.RES={name:"RES",type:"R",class:class extends i{constructor(){super(n.RES.name,n.RES.type)}exec(t){t.origin.swapAtoms(t.getRandom(n.EMPTY)),super.exec(t)}}},n.TYPES_ARRAY=[n.EMPTY,n.DREG,n.RES];class a{constructor(t=n.EMPTY){this.type=t,this.elem=new this.type.class}exec(t){this.elem.exec(t)}}class l{constructor(t){this.tilePos=t,this.id=s.CtoID(this.tilePos),this.create()}swapAtoms(t){t&&([this.atom,t.atom]=[t.atom,this.atom])}create(){this.atom=new a}}let c=new class{constructor(t=1,e=1){this.width=t,this.height=e,this.create()}getSiteByCoord(t){return this.sites.get(s.CtoID(t))}getRandomSite(){let t=Math.floor(Math.random()*this.height),e=Math.floor(Math.random()*this.width);return this.sites.get(`${t}:${e}`)}create(){this.sites=new Map;for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)this.sites.set(`${e}:${t}`,new l({row:e,col:t}))}}(32,32);new p5(t=>{t.preload=(()=>{}),t.setup=(()=>{t.createCanvas(700,700)});t.draw=(()=>{t.background(100),((t,e)=>{t.push(),t.translate(25,25),e.sites.forEach(e=>{switch(e.atom.elem.type){case n.EMPTY.type:t.stroke(0,0,0,0),t.fill(32,32,32,127);break;case n.DREG.type:t.stroke(0,0,0,127),t.fill(255,32,32);break;case n.RES.type:t.stroke(0,0,0,127),t.fill(32,255,64)}t.ellipse(14*e.tilePos.col,14*e.tilePos.row,14,14)}),t.pop()})(t,c),(()=>{for(var t=0;t<2500;t++){let t=s.GenerateEventWindow(c,c.width,c.height);t.origin.atom.exec(t)}})()}),t.mouseClicked=(()=>{let e=((t,e)=>(t=t-25+7,e=e-25+7,t=Math.floor(t/14),e=Math.floor(e/14),c.getSiteByCoord({row:e,col:t})))(t.mouseX,t.mouseY);e&&(e.atom=new a(n.DREG))})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0V2ZW50d2luZG93LnRzIiwid2VicGFjazovLy8uL3NyYy9tZm0vdXRpbHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW0udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL0VsZW1lbnRUeXBlcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvRW1wdHlFbGVtZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9tZm0vY2xhc3Nlcy9lbGVtZW50cy9EUmVnRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvZWxlbWVudHMvUmVzRWxlbWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvQXRvbS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWZtL2NsYXNzZXMvU2l0ZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21mbS9jbGFzc2VzL1RpbGUudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJFdmVudHdpbmRvd19FdmVudFdpbmRvdyIsIltvYmplY3QgT2JqZWN0XSIsIl90aWxlIiwiX29yaWdpbiIsInRoaXMiLCJ0aWxlIiwibWFrZVdpbmRvdyIsIm9yaWdpbiIsIndpbmRvdyIsIk1hcCIsImdldFNpdGVCeUNvb3JkIiwic2V0IiwiaWQiLCJXSU5ET1dfT1JERVJfT0ZGU0VUUyIsIm1hcCIsIm9mZnNldCIsIk9mZnNldEZyb21PcmlnaW4iLCJyb3ciLCJjb2wiLCJmb3JFYWNoIiwidGlsZUNvb3JkIiwic2l0ZSIsInJvd09mZnNldCIsImNvbE9mZnNldCIsInNwZWNpZmljVHlwZSIsImdldFNpdGVGcm9tQ2FuZGlkYXRlcyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImdldERpcmVjdGlvbiIsIkVXX0VBU1QiLCJFV19XRVNUIiwiRVdfTk9SVEgiLCJFV19TT1VUSCIsIkVXX05PUlRIV0VTVCIsIkVXX1NPVVRIV0VTVCIsIkVXX05PUlRIRUFTVCIsIkVXX1NPVVRIRUFTVCIsInJhbmRvbWl6ZSIsImdldFdlc3QiLCJnZXROb3J0aCIsImdldFNvdXRoIiwiZ2V0RWFzdCIsImdldE5vcnRoV2VzdCIsImdldFNvdXRoV2VzdCIsImdldE5vcnRoRWFzdCIsImdldFNvdXRoRWFzdCIsImNhbmRpZGF0ZVNpdGVzIiwiZmlsdGVyIiwiYXRvbSIsInR5cGUiLCJsZW5ndGgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJkaXJlY3Rpb24iLCJzaXRlcyIsInV0aWxzX01GTVV0aWxzIiwiQ3RvSUQiLCJ0aWxlUG9zIiwicmNhIiwic3BsaXQiLCJwYXJzZUludCIsInciLCJoIiwicmMiLCJyciIsIkVsZW0iLCJfbmFtZSIsIl90eXBlIiwiX21vdmVhYmxlIiwiX2tpbGxhYmxlIiwiX2RhdGEiLCJkYXRhIiwibW92ZWFibGUiLCJraWxsYWJsZSIsImsiLCJldyIsIkVsZW1lbnRUeXBlcyIsIlRZUEVTX0FSUkFZIiwicHVzaCIsImNsYXNzIiwiRU1QVFkiLCJzdXBlciIsImV4ZWMiLCJEUkVHIiwicFRPVEFMX0NIQU5DRSIsInBEUkVHX0NSRUFURSIsInBSRVNfQ1JFQVRFIiwicERSRUdfREVTVFJPWSIsInBBTllfREVTVFJPWSIsImF2YWlsYWJsZVNpdGUiLCJnZXRBZGphY2VudDRXYXkiLCJjcmVhdGVEUmVnIiwiY3JlYXRlUmVzIiwiQXRvbV9BdG9tIiwiY29uc29sZSIsImxvZyIsIlJFUyIsInN3YXBBdG9tcyIsImdldFJhbmRvbSIsImVsZW0iLCJTaXRlX1NpdGUiLCJfcG9zIiwidGFyZ2V0U2l0ZSIsImciLCJfd2lkdGgiLCJfaGVpZ2h0Iiwid2lkdGgiLCJoZWlnaHQiLCJqIiwicDUiLCJwcmVsb2FkIiwic2V0dXAiLCJjcmVhdGVDYW52YXMiLCJkcmF3IiwiYmFja2dyb3VuZCIsInRyYW5zbGF0ZSIsInN0cm9rZSIsImZpbGwiLCJlbGxpcHNlIiwicG9wIiwiZHJhd0dyaWQiLCJHZW5lcmF0ZUV2ZW50V2luZG93IiwicnVuIiwibW91c2VDbGlja2VkIiwieCIsInkiLCJzaXRlU2l6ZSIsImdldFNpdGVGcm9tQ2FudmFzWFkiLCJtb3VzZVgiLCJtb3VzZVkiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsYUFBd0RDLE1BQUEsV0FF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RUFBQS9GLGdCQUFpQ08sSUFBQThHLEVBQUE3RyxJQUFBNEcsS0FRakNHLENBQUFuSSxFQUFBb0ksT0FBQXBJLEVBQUFxSSxRQUNBOUcsSUFDQUEsRUFBQTRCLEtBQUEsSUFBNEI4QyxFQUFLakIsRUFBWU8iLCJmaWxlIjoibWZtLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IHsgTUZNVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHNcIjtcbi8vRXZlbnQgd2luZG93IGFzIGRlc2NyaWJiZWQgaGVyZTogaHR0cDovL3JvYnVzdC5jcy51bm0uZWR1L2xpYi9leGUvZmV0Y2gucGhwP3c9MzAwJnRvaz00YzhmNDkmbWVkaWE9ZGV2OmV2ZW50LXdpbmRvdy0xMC5wbmdcbi8vQ29sbGVjdGlvbiBvZiBzaXRlcyB3aGljaCBjb250YWluIGF0b21zLCBidWlsdCBmcm9tIGFuIG9yaWdpbiAoY2VudGVyKSBzaXRlXG5leHBvcnQgY2xhc3MgRXZlbnRXaW5kb3cge1xuICAgIGNvbnN0cnVjdG9yKF90aWxlLCBfb3JpZ2luKSB7XG4gICAgICAgIHRoaXMudGlsZSA9IF90aWxlO1xuICAgICAgICB0aGlzLm1ha2VXaW5kb3coX3RpbGUsIF9vcmlnaW4pO1xuICAgIH1cbiAgICBtYWtlV2luZG93KHRpbGUsIG9yaWdpbikge1xuICAgICAgICB0aGlzLndpbmRvdyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5vcmlnaW4gPSB0aGlzLnRpbGUuZ2V0U2l0ZUJ5Q29vcmQob3JpZ2luKTtcbiAgICAgICAgdGhpcy53aW5kb3cuc2V0KHRoaXMub3JpZ2luLmlkLCB0aGlzLm9yaWdpbik7XG4gICAgICAgIGxldCB3aW5kb3dBcnJheSA9IEV2ZW50V2luZG93LldJTkRPV19PUkRFUl9PRkZTRVRTLm1hcCgob2Zmc2V0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5PZmZzZXRGcm9tT3JpZ2luKG9yaWdpbiwgb2Zmc2V0LnJvdywgb2Zmc2V0LmNvbCk7XG4gICAgICAgIH0pO1xuICAgICAgICB3aW5kb3dBcnJheS5mb3JFYWNoKCh0aWxlQ29vcmQpID0+IHtcbiAgICAgICAgICAgIGxldCBzaXRlID0gdGlsZS5nZXRTaXRlQnlDb29yZCh0aWxlQ29vcmQpO1xuICAgICAgICAgICAgaWYgKHNpdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy5zZXQoc2l0ZS5pZCwgc2l0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBPZmZzZXRGcm9tT3JpZ2luKG9yaWdpbiwgcm93T2Zmc2V0LCBjb2xPZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIHsgcm93OiBvcmlnaW4ucm93ICsgcm93T2Zmc2V0LCBjb2w6IG9yaWdpbi5jb2wgKyBjb2xPZmZzZXQgfTtcbiAgICB9XG4gICAgZ2V0UmFuZG9tKHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTaXRlRnJvbUNhbmRpZGF0ZXMoQXJyYXkuZnJvbSh0aGlzLndpbmRvdy52YWx1ZXMoKSksIHRydWUsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIGdldE5lYXJlc3Qoc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNpdGVGcm9tQ2FuZGlkYXRlcyhBcnJheS5mcm9tKHRoaXMud2luZG93LnZhbHVlcygpKSwgZmFsc2UsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIGdldEVhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19FQVNUKTtcbiAgICB9XG4gICAgZ2V0V2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1dFU1QpO1xuICAgIH1cbiAgICBnZXROb3J0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIKTtcbiAgICB9XG4gICAgZ2V0U291dGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERpcmVjdGlvbihFdmVudFdpbmRvdy5FV19TT1VUSCk7XG4gICAgfVxuICAgIGdldE5vcnRoV2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIV0VTVCk7XG4gICAgfVxuICAgIGdldFNvdXRoV2VzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1NPVVRIV0VTVCk7XG4gICAgfVxuICAgIGdldE5vcnRoRWFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX05PUlRIRUFTVCk7XG4gICAgfVxuICAgIGdldFNvdXRoRWFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uKEV2ZW50V2luZG93LkVXX1NPVVRIRUFTVCk7XG4gICAgfVxuICAgIGdldEFkamFjZW50NFdheShyYW5kb21pemUgPSB0cnVlLCBzcGVjaWZpY1R5cGUgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2l0ZUZyb21DYW5kaWRhdGVzKFt0aGlzLmdldFdlc3QoKSwgdGhpcy5nZXROb3J0aCgpLCB0aGlzLmdldFNvdXRoKCksIHRoaXMuZ2V0RWFzdCgpXSwgcmFuZG9taXplLCBzcGVjaWZpY1R5cGUpO1xuICAgIH1cbiAgICBnZXRBZGphY2VudDhXYXkocmFuZG9taXplID0gdHJ1ZSwgc3BlY2lmaWNUeXBlID0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNpdGVGcm9tQ2FuZGlkYXRlcyhbXG4gICAgICAgICAgICB0aGlzLmdldFdlc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0Tm9ydGgoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0U291dGgoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0RWFzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXROb3J0aFdlc3QoKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0U291dGhXZXN0KCksXG4gICAgICAgICAgICB0aGlzLmdldE5vcnRoRWFzdCgpLFxuICAgICAgICAgICAgdGhpcy5nZXRTb3V0aEVhc3QoKVxuICAgICAgICBdLCByYW5kb21pemUsIHNwZWNpZmljVHlwZSk7XG4gICAgfVxuICAgIC8vR2l2ZW4gYW4gYXJyYXkgb2YgY2FuZGlkYXRlIHNpdGVzIChzeW1tZXRyaWVzIGluIHRoZSBmdXR1cmUgSSBob3BlKSwgZ2l2ZSBtZSBiYWNrIG9uZSwgcmFuZG9tIGJ5IGRlZmF1bHQsIG5vdCBmaWx0ZXJlZCBieSB0eXBlIGJ5IGRlZmF1bHRcbiAgICBnZXRTaXRlRnJvbUNhbmRpZGF0ZXMoY2FuZGlkYXRlU2l0ZXMsIHJhbmRvbWl6ZSA9IHRydWUsIHNwZWNpZmljVHlwZSA9IHVuZGVmaW5lZCkge1xuICAgICAgICBjYW5kaWRhdGVTaXRlcyA9IGNhbmRpZGF0ZVNpdGVzLmZpbHRlcihzaXRlID0+IHtcbiAgICAgICAgICAgIGlmICghc2l0ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNwZWNpZmljVHlwZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzaXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3BlY2lmaWNUeXBlICYmIHNpdGUuYXRvbS50eXBlID09PSBzcGVjaWZpY1R5cGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2l0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vbm8gc2l0ZXMhIHlpa2VzISBwb3NzaWJsZSE/ISBwcm9iYWJseSBvbmx5IHdoZW4gdXNpbmcgc3BlY2lmaWNUeXBlIGFuZCBsb29raW5nIGZvciBhIHJhcmUgZWxlbWVudFxuICAgICAgICBpZiAoY2FuZGlkYXRlU2l0ZXMubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICAvL3JldHVybiByYW5kb21cbiAgICAgICAgaWYgKHJhbmRvbWl6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZVNpdGVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNhbmRpZGF0ZVNpdGVzLmxlbmd0aCldO1xuICAgICAgICB9XG4gICAgICAgIC8vcmV0dXJuIGZpcnN0IG1hdGNoaW5nXG4gICAgICAgIHJldHVybiBjYW5kaWRhdGVTaXRlc1swXTtcbiAgICB9XG4gICAgZ2V0RGlyZWN0aW9uKGRpcmVjdGlvbikge1xuICAgICAgICBsZXQgc2l0ZSA9IHRoaXMudGlsZS5zaXRlcy5nZXQoTUZNVXRpbHMuQ3RvSUQodGhpcy5PZmZzZXRGcm9tT3JpZ2luKHRoaXMub3JpZ2luLnRpbGVQb3MsIGRpcmVjdGlvbi5yb3csIGRpcmVjdGlvbi5jb2wpKSk7XG4gICAgICAgIGlmIChzaXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gc2l0ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbn1cbkV2ZW50V2luZG93LldJTkRPV19PUkRFUl9PRkZTRVRTID0gW1xuICAgIHsgY29sOiAwLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogMSB9LFxuICAgIHsgY29sOiAxLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogLTEsIHJvdzogMSB9LFxuICAgIHsgY29sOiAxLCByb3c6IC0xIH0sXG4gICAgeyBjb2w6IDEsIHJvdzogMSB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAwIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICB7IGNvbDogMCwgcm93OiAyIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogMCB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAtMiwgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMSwgcm93OiAtMiB9LFxuICAgIHsgY29sOiAxLCByb3c6IDIgfSxcbiAgICB7IGNvbDogMiwgcm93OiAtMSB9LFxuICAgIHsgY29sOiAyLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTMsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC0zIH0sXG4gICAgeyBjb2w6IDAsIHJvdzogMyB9LFxuICAgIHsgY29sOiAzLCByb3c6IDAgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogLTIgfSxcbiAgICB7IGNvbDogLTIsIHJvdzogMiB9LFxuICAgIHsgY29sOiAyLCByb3c6IC0yIH0sXG4gICAgeyBjb2w6IDIsIHJvdzogMiB9LFxuICAgIHsgY29sOiAtMywgcm93OiAtMSB9LFxuICAgIHsgY29sOiAtMywgcm93OiAxIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IC0zIH0sXG4gICAgeyBjb2w6IC0xLCByb3c6IDMgfSxcbiAgICB7IGNvbDogMSwgcm93OiAtMyB9LFxuICAgIHsgY29sOiAxLCByb3c6IDMgfSxcbiAgICB7IGNvbDogMywgcm93OiAtMSB9LFxuICAgIHsgY29sOiAzLCByb3c6IDEgfSxcbiAgICB7IGNvbDogLTQsIHJvdzogMCB9LFxuICAgIHsgY29sOiAwLCByb3c6IC00IH0sXG4gICAgeyBjb2w6IDAsIHJvdzogNCB9LFxuICAgIHsgY29sOiA0LCByb3c6IDAgfVxuXTtcbi8vYmVjYXVzZSwgbGF6eVxuRXZlbnRXaW5kb3cuRVdfV0VTVCA9IHsgY29sOiAtMSwgcm93OiAwIH07XG5FdmVudFdpbmRvdy5FV19FQVNUID0geyBjb2w6IDEsIHJvdzogMCB9O1xuRXZlbnRXaW5kb3cuRVdfTk9SVEggPSB7IGNvbDogMCwgcm93OiAtMSB9O1xuRXZlbnRXaW5kb3cuRVdfU09VVEggPSB7IGNvbDogMCwgcm93OiAxIH07XG5FdmVudFdpbmRvdy5FV19OT1JUSFdFU1QgPSB7IGNvbDogLTEsIHJvdzogLTEgfTtcbkV2ZW50V2luZG93LkVXX1NPVVRIV0VTVCA9IHsgY29sOiAtMSwgcm93OiAxIH07XG5FdmVudFdpbmRvdy5FV19OT1JUSEVBU1QgPSB7IGNvbDogMSwgcm93OiAtMSB9O1xuRXZlbnRXaW5kb3cuRVdfU09VVEhFQVNUID0geyBjb2w6IDEsIHJvdzogMSB9O1xuIiwiaW1wb3J0IHsgRXZlbnRXaW5kb3cgfSBmcm9tIFwiLi4vY2xhc3Nlcy9FdmVudHdpbmRvd1wiO1xuZXhwb3J0IGNsYXNzIE1GTVV0aWxzIHtcbiAgICBzdGF0aWMgQ3RvSUQoYykge1xuICAgICAgICByZXR1cm4gYCR7Yy5yb3d9OiR7Yy5jb2x9YDtcbiAgICB9XG4gICAgc3RhdGljIElEdG9DKGlkKSB7XG4gICAgICAgIGxldCByY2EgPSBpZC5zcGxpdChcIjpcIik7XG4gICAgICAgIHJldHVybiB7IHJvdzogcGFyc2VJbnQocmNhWzBdKSwgY29sOiBwYXJzZUludChyY2FbMV0pIH07XG4gICAgfVxuICAgIHN0YXRpYyBHZW5lcmF0ZUV2ZW50V2luZG93KHRpbGUsIHcsIGgpIHtcbiAgICAgICAgbGV0IHJjID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdyk7XG4gICAgICAgIGxldCByciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGgpO1xuICAgICAgICByZXR1cm4gbmV3IEV2ZW50V2luZG93KHRpbGUsIHsgcm93OiByciwgY29sOiByYyB9KTtcbiAgICB9XG59XG4iLCJleHBvcnQgY2xhc3MgRWxlbSB7XG4gICAgY29uc3RydWN0b3IoX25hbWUsIF90eXBlLCBfbW92ZWFibGUgPSB0cnVlLCBfa2lsbGFibGUgPSB0cnVlLCBfZGF0YSA9IDApIHtcbiAgICAgICAgdGhpcy5uYW1lID0gX25hbWU7XG4gICAgICAgIHRoaXMudHlwZSA9IF90eXBlO1xuICAgICAgICB0aGlzLmRhdGEgPSBfZGF0YTtcbiAgICAgICAgdGhpcy5tb3ZlYWJsZSA9IF9tb3ZlYWJsZTtcbiAgICAgICAgdGhpcy5raWxsYWJsZSA9IF9raWxsYWJsZTtcbiAgICB9XG4gICAgc2V0IGRhdGEoZCkge1xuICAgICAgICB0aGlzLl9kYXRhID0gZDtcbiAgICB9XG4gICAgZ2V0IGRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICAgIH1cbiAgICBzZXQgbmFtZShuKSB7XG4gICAgICAgIHRoaXMuX25hbWUgPSBuO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgfVxuICAgIHNldCB0eXBlKHQpIHtcbiAgICAgICAgdGhpcy5fdHlwZSA9IHQ7XG4gICAgfVxuICAgIGdldCB0eXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICB9XG4gICAgc2V0IG1vdmVhYmxlKG0pIHtcbiAgICAgICAgdGhpcy5fbW92ZWFibGUgPSBtO1xuICAgIH1cbiAgICBnZXQgbW92ZWFibGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tb3ZlYWJsZTtcbiAgICB9XG4gICAgc2V0IGtpbGxhYmxlKGspIHtcbiAgICAgICAgdGhpcy5fa2lsbGFibGUgPSBrO1xuICAgIH1cbiAgICBnZXQga2lsbGFibGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9raWxsYWJsZTtcbiAgICB9XG4gICAgZXhlYyhldykgeyB9XG59XG4iLCJpbXBvcnQgeyBFbXB0eUVsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9FbXB0eUVsZW1lbnRcIjtcbmltcG9ydCB7IERSZWdFbGVtZW50IH0gZnJvbSBcIi4vZWxlbWVudHMvRFJlZ0VsZW1lbnRcIjtcbmltcG9ydCB7IFJlc0VsZW1lbnQgfSBmcm9tIFwiLi9lbGVtZW50cy9SZXNFbGVtZW50XCI7XG5leHBvcnQgY2xhc3MgRWxlbWVudFR5cGVzIHtcbiAgICBzdGF0aWMgcmVnaXN0ZXJUeXBlKG5hbWUsIHR5cGUsIGMpIHtcbiAgICAgICAgdGhpcy5UWVBFU19BUlJBWS5wdXNoKHsgbmFtZSwgdHlwZSwgY2xhc3M6IGMgfSk7XG4gICAgfVxufVxuRWxlbWVudFR5cGVzLkVNUFRZID0geyBuYW1lOiBcIkVNUFRZXCIsIHR5cGU6IFwiRVwiLCBjbGFzczogRW1wdHlFbGVtZW50IH07XG5FbGVtZW50VHlwZXMuRFJFRyA9IHsgbmFtZTogXCJEUkVHXCIsIHR5cGU6IFwiRFwiLCBjbGFzczogRFJlZ0VsZW1lbnQgfTtcbkVsZW1lbnRUeXBlcy5SRVMgPSB7IG5hbWU6IFwiUkVTXCIsIHR5cGU6IFwiUlwiLCBjbGFzczogUmVzRWxlbWVudCB9O1xuRWxlbWVudFR5cGVzLlRZUEVTX0FSUkFZID0gW0VsZW1lbnRUeXBlcy5FTVBUWSwgRWxlbWVudFR5cGVzLkRSRUcsIEVsZW1lbnRUeXBlcy5SRVNdO1xuIiwiaW1wb3J0IHsgRWxlbSB9IGZyb20gXCIuLi9FbGVtXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgRW1wdHlFbGVtZW50IGV4dGVuZHMgRWxlbSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKEVsZW1lbnRUeXBlcy5FTVBUWS5uYW1lLCBFbGVtZW50VHlwZXMuRU1QVFkudHlwZSk7XG4gICAgfVxuICAgIGV4ZWMoZXcpIHtcbiAgICAgICAgc3VwZXIuZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRWxlbSB9IGZyb20gXCIuLi9FbGVtXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi4vRWxlbWVudFR5cGVzXCI7XG5pbXBvcnQgeyBBdG9tIH0gZnJvbSBcIi4uL0F0b21cIjtcbmV4cG9ydCBjbGFzcyBEUmVnRWxlbWVudCBleHRlbmRzIEVsZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihFbGVtZW50VHlwZXMuRFJFRy5uYW1lLCBFbGVtZW50VHlwZXMuRFJFRy50eXBlKTtcbiAgICAgICAgdGhpcy5wVE9UQUxfQ0hBTkNFID0gMTAwO1xuICAgICAgICB0aGlzLnBEUkVHX0NSRUFURSA9IDAuMTtcbiAgICAgICAgdGhpcy5wUkVTX0NSRUFURSA9IDAuNTtcbiAgICAgICAgdGhpcy5wRFJFR19ERVNUUk9ZID0gMTA7XG4gICAgICAgIHRoaXMucEFOWV9ERVNUUk9ZID0gMTtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICAvL2dldCBhIHJhbmRvbSBORVNXIHNpdGVcbiAgICAgICAgY29uc3QgYXZhaWxhYmxlU2l0ZSA9IGV3LmdldEFkamFjZW50NFdheSgpO1xuICAgICAgICAvL0NSRUFUSU9OXG4gICAgICAgIGlmIChhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLkVNUFRZKSB7XG4gICAgICAgICAgICBjb25zdCBjcmVhdGVEUmVnID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucERSRUdfQ1JFQVRFO1xuICAgICAgICAgICAgY29uc3QgY3JlYXRlUmVzID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucFJFU19DUkVBVEU7XG4gICAgICAgICAgICBpZiAoY3JlYXRlRFJlZykge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbSA9IG5ldyBBdG9tKEVsZW1lbnRUeXBlcy5EUkVHKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRSRUcgQ1JFQVRFRFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNyZWF0ZVJlcykge1xuICAgICAgICAgICAgICAgIC8vbWFrZSByZXNcbiAgICAgICAgICAgICAgICBhdmFpbGFibGVTaXRlLmF0b20gPSBuZXcgQXRvbShFbGVtZW50VHlwZXMuUkVTKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJFUyBDUkVBVEVEXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhdmFpbGFibGVTaXRlLmF0b20udHlwZSA9PT0gRWxlbWVudFR5cGVzLkRSRUcpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc3Ryb3lEUmVnID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucERSRUdfREVTVFJPWTtcbiAgICAgICAgICAgIGlmIChkZXN0cm95RFJlZykge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbSA9IG5ldyBBdG9tKEVsZW1lbnRUeXBlcy5FTVBUWSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJEUkVHIERFU1RST1lFRFwiKTtcbiAgICAgICAgICAgICAgICBldy5vcmlnaW4uc3dhcEF0b21zKGF2YWlsYWJsZVNpdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9pdCdzIHNvbWV0aGluZyBlbHNlXG4gICAgICAgICAgICBjb25zdCBkZXN0cm95QW55ID0gTWF0aC5yYW5kb20oKSAqIHRoaXMucFRPVEFMX0NIQU5DRSA8IHRoaXMucEFOWV9ERVNUUk9ZO1xuICAgICAgICAgICAgaWYgKGRlc3Ryb3lBbnkpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhdmFpbGFibGVTaXRlLmF0b20udHlwZS5uYW1lICsgXCIgREVTVFJPWUVEXCIpO1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNpdGUuYXRvbSA9IG5ldyBBdG9tKEVsZW1lbnRUeXBlcy5FTVBUWSk7XG4gICAgICAgICAgICAgICAgZXcub3JpZ2luLnN3YXBBdG9tcyhhdmFpbGFibGVTaXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdXBlci5leGVjKGV3KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFbGVtIH0gZnJvbSBcIi4uL0VsZW1cIjtcbmltcG9ydCB7IEVsZW1lbnRUeXBlcyB9IGZyb20gXCIuLi9FbGVtZW50VHlwZXNcIjtcbmV4cG9ydCBjbGFzcyBSZXNFbGVtZW50IGV4dGVuZHMgRWxlbSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKEVsZW1lbnRUeXBlcy5SRVMubmFtZSwgRWxlbWVudFR5cGVzLlJFUy50eXBlKTtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICBldy5vcmlnaW4uc3dhcEF0b21zKGV3LmdldFJhbmRvbShFbGVtZW50VHlwZXMuRU1QVFkpKTtcbiAgICAgICAgc3VwZXIuZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRWxlbWVudFR5cGVzIH0gZnJvbSBcIi4vRWxlbWVudFR5cGVzXCI7XG5leHBvcnQgY2xhc3MgQXRvbSB7XG4gICAgY29uc3RydWN0b3IoX3R5cGUgPSBFbGVtZW50VHlwZXMuRU1QVFkpIHtcbiAgICAgICAgdGhpcy50eXBlID0gX3R5cGU7XG4gICAgICAgIHRoaXMuZWxlbSA9IG5ldyB0aGlzLnR5cGUuY2xhc3MoKTtcbiAgICB9XG4gICAgZXhlYyhldykge1xuICAgICAgICB0aGlzLmVsZW0uZXhlYyhldyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTUZNVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IEF0b20gfSBmcm9tIFwiLi9BdG9tXCI7XG5leHBvcnQgY2xhc3MgU2l0ZSB7XG4gICAgY29uc3RydWN0b3IoX3Bvcykge1xuICAgICAgICB0aGlzLnRpbGVQb3MgPSBfcG9zO1xuICAgICAgICB0aGlzLmlkID0gTUZNVXRpbHMuQ3RvSUQodGhpcy50aWxlUG9zKTtcbiAgICAgICAgdGhpcy5jcmVhdGUoKTtcbiAgICB9XG4gICAgc3dhcEF0b21zKHRhcmdldFNpdGUpIHtcbiAgICAgICAgaWYgKHRhcmdldFNpdGUpXG4gICAgICAgICAgICBbdGhpcy5hdG9tLCB0YXJnZXRTaXRlLmF0b21dID0gW3RhcmdldFNpdGUuYXRvbSwgdGhpcy5hdG9tXTtcbiAgICB9XG4gICAgY3JlYXRlKCkge1xuICAgICAgICB0aGlzLmF0b20gPSBuZXcgQXRvbSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFRpbGUgfSBmcm9tIFwiLi9tZm0vY2xhc3Nlcy9UaWxlXCI7XG5pbXBvcnQgeyBFbGVtZW50VHlwZXMgfSBmcm9tIFwiLi9tZm0vY2xhc3Nlcy9FbGVtZW50VHlwZXNcIjtcbmltcG9ydCB7IE1GTVV0aWxzIH0gZnJvbSBcIi4vbWZtL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgeyBBdG9tIH0gZnJvbSBcIi4vbWZtL2NsYXNzZXMvQXRvbVwiO1xubGV0IGcgPSBuZXcgVGlsZSgzMiwgMzIpO1xudmFyIHNrZXRjaCA9IChwKSA9PiB7XG4gICAgbGV0IHNpdGVTaXplID0gMTQ7XG4gICAgbGV0IGdyaWRPZmZzZXQgPSAyNTtcbiAgICBwLnByZWxvYWQgPSAoKSA9PiB7IH07XG4gICAgcC5zZXR1cCA9ICgpID0+IHtcbiAgICAgICAgcC5jcmVhdGVDYW52YXMoNzAwLCA3MDApO1xuICAgIH07XG4gICAgLy8gICBwLndpbmRvd1Jlc2l6ZWQgPSAoKSA9PiB7XG4gICAgLy8gICAgIHAucmVzaXplQ2FudmFzKHAud2luZG93V2lkdGggLSA1MCwgcC53aW5kb3dIZWlnaHQgLSA1MCk7XG4gICAgLy8gICB9O1xuICAgIGxldCBkcmF3R3JpZCA9IChwLCB0KSA9PiB7XG4gICAgICAgIHAucHVzaCgpO1xuICAgICAgICBwLnRyYW5zbGF0ZShncmlkT2Zmc2V0LCBncmlkT2Zmc2V0KTtcbiAgICAgICAgdC5zaXRlcy5mb3JFYWNoKChzaXRlKSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKHNpdGUuYXRvbS5lbGVtLnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIEVsZW1lbnRUeXBlcy5FTVBUWS50eXBlOlxuICAgICAgICAgICAgICAgICAgICBwLnN0cm9rZSgwLCAwLCAwLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgcC5maWxsKDMyLCAzMiwgMzIsIDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgRWxlbWVudFR5cGVzLkRSRUcudHlwZTpcbiAgICAgICAgICAgICAgICAgICAgcC5zdHJva2UoMCwgMCwgMCwgMTI3KTtcbiAgICAgICAgICAgICAgICAgICAgcC5maWxsKDI1NSwgMzIsIDMyKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBFbGVtZW50VHlwZXMuUkVTLnR5cGU6XG4gICAgICAgICAgICAgICAgICAgIHAuc3Ryb2tlKDAsIDAsIDAsIDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIHAuZmlsbCgzMiwgMjU1LCA2NCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcC5lbGxpcHNlKHNpdGUudGlsZVBvcy5jb2wgKiBzaXRlU2l6ZSwgc2l0ZS50aWxlUG9zLnJvdyAqIHNpdGVTaXplLCBzaXRlU2l6ZSwgc2l0ZVNpemUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcC5wb3AoKTtcbiAgICB9O1xuICAgIGxldCBydW4gPSAoKSA9PiB7XG4gICAgICAgIGxldCBzcGVlZCA9IDI1MDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BlZWQ7IGkrKykge1xuICAgICAgICAgICAgbGV0IGV3ID0gTUZNVXRpbHMuR2VuZXJhdGVFdmVudFdpbmRvdyhnLCBnLndpZHRoLCBnLmhlaWdodCk7XG4gICAgICAgICAgICBldy5vcmlnaW4uYXRvbS5leGVjKGV3KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgbGV0IGdldFNpdGVGcm9tQ2FudmFzWFkgPSAoeCwgeSkgPT4ge1xuICAgICAgICB4ID0geCAtIGdyaWRPZmZzZXQgKyBzaXRlU2l6ZSAqIDAuNTtcbiAgICAgICAgeSA9IHkgLSBncmlkT2Zmc2V0ICsgc2l0ZVNpemUgKiAwLjU7XG4gICAgICAgIHggPSBNYXRoLmZsb29yKHggLyBzaXRlU2l6ZSk7XG4gICAgICAgIHkgPSBNYXRoLmZsb29yKHkgLyBzaXRlU2l6ZSk7XG4gICAgICAgIHJldHVybiBnLmdldFNpdGVCeUNvb3JkKHsgcm93OiB5LCBjb2w6IHggfSk7XG4gICAgfTtcbiAgICBwLmRyYXcgPSAoKSA9PiB7XG4gICAgICAgIHAuYmFja2dyb3VuZCgxMDApO1xuICAgICAgICBkcmF3R3JpZChwLCBnKTtcbiAgICAgICAgcnVuKCk7XG4gICAgfTtcbiAgICBwLm1vdXNlQ2xpY2tlZCA9ICgpID0+IHtcbiAgICAgICAgbGV0IHNpdGUgPSBnZXRTaXRlRnJvbUNhbnZhc1hZKHAubW91c2VYLCBwLm1vdXNlWSk7XG4gICAgICAgIGlmIChzaXRlKVxuICAgICAgICAgICAgc2l0ZS5hdG9tID0gbmV3IEF0b20oRWxlbWVudFR5cGVzLkRSRUcpO1xuICAgIH07XG59O1xubGV0IHNrZXRjaFAgPSBuZXcgcDUoc2tldGNoKTtcbiIsImltcG9ydCB7IFNpdGUgfSBmcm9tIFwiLi9TaXRlXCI7XG5pbXBvcnQgeyBNRk1VdGlscyB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuZXhwb3J0IGNsYXNzIFRpbGUge1xuICAgIGNvbnN0cnVjdG9yKF93aWR0aCA9IDEsIF9oZWlnaHQgPSAxKSB7XG4gICAgICAgIHRoaXMud2lkdGggPSBfd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gX2hlaWdodDtcbiAgICAgICAgdGhpcy5jcmVhdGUoKTtcbiAgICB9XG4gICAgZ2V0U2l0ZUJ5Q29vcmQoYykge1xuICAgICAgICByZXR1cm4gdGhpcy5zaXRlcy5nZXQoTUZNVXRpbHMuQ3RvSUQoYykpO1xuICAgIH1cbiAgICBnZXRSYW5kb21TaXRlKCkge1xuICAgICAgICBsZXQgcnIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLmhlaWdodCk7XG4gICAgICAgIGxldCByYyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMud2lkdGgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zaXRlcy5nZXQoYCR7cnJ9OiR7cmN9YCk7XG4gICAgfVxuICAgIGNyZWF0ZSgpIHtcbiAgICAgICAgdGhpcy5zaXRlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLndpZHRoOyBpKyspIHtcbiAgICAgICAgICAgIC8vYWNyb3NzIGNvbHVtbnNcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5oZWlnaHQ7IGorKykge1xuICAgICAgICAgICAgICAgIC8vZG93biByb3dzXG4gICAgICAgICAgICAgICAgdGhpcy5zaXRlcy5zZXQoYCR7an06JHtpfWAsIG5ldyBTaXRlKHsgcm93OiBqLCBjb2w6IGkgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==